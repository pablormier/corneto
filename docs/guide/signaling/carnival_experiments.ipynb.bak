{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "f2d7b3c9",
   "metadata": {},
   "source": [
    "# CARNIVAL\n",
    "\n",
    "CARNIVAL (CAusal Reasoning for Network identification using Integer VALue programming) is a method for the identification of upstream reguatory signalling pathways from downstream gene expression (GEX). Applications of CARNIVAL include the identification of drug’s modes of action and of deregulated processes in diseases (even if the molecular targets remain unknown) by deciphering the alterations of main signalling pathways as well as alternative pathways and off-target effects.\n",
    "\n",
    "<center style=\"margin:25px\">\n",
    "    <img src=\"/_static/carnival-abstract.png\" alt=\"CARNIVAL abstract\" style=\"width: 100%; max-width:800px; margin-bottom:10px;\" onerror=\"this.onerror=null; this.src='https://github.com/saezlab/PerMedCoE_tools_virtual_course_2023/raw/main/assets/carnival_graphical_abstract.png';\">\n",
    "    <br>\n",
    "    <font size=\"-1\">\n",
    "        <b>Figure 1:</b> Liu A., Trairatphisan P., Gjerga E. et al. From expression footprints to causal pathways: contextualizing large signaling networks with CARNIVAL npj Systems Biology and Applications volume 5, Article number: 40 (2019) (equal contributions).\n",
    "    </font>\n",
    "</center>\n",
    "\n",
    "The aim of the CARNIVAL pipeline is to identify a subset of interactions from a prior knowledge network that represent potential regulated pathways linking known or potential targets of perturbation towards active transcription factors derived from GEX data. The pipeline includes a number improved functionalities comparing to the original version and consists of the following processes:\n",
    "\n",
    "- Transcription factors’ (TFs) activities and pathway scores from gene expressions can be inferred with our in-house tools (Dorothea, CollecTRI).\n",
    "- TFs’ activities and signed directed protein-protein interaction networks with or without the provided target of perturbations and pathway scores are then used to construct an optimization problem with CORNETO.\n",
    "- CORNETO is used to solve the optimization problem with any of the supported solvers (CPLEX, GUROBI, SCIPY, etc), which identifies the sub-network topology with minimised fitting error and model size.\n",
    "\n",
    "\n",
    "\n",
    "The original version of CARNIVAL was implemented in R and CPLEX. The new re-implementationo of CARNIVAL in CORNETO support a wide variety of solvers thanks to the support of both CVXPY and PICOS. It also has more flexibility since the problem is symbolically defined, and can be modified through the CORNETO API after creating the CARNIVAL problem. This gives user extra flexibility to modify the problem or to use CORNETO as a building block for other optimization problems. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "a1684e94",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [],
      "text/plain": []
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "\n",
       "        <table style='background-color:rgba(0, 0, 0, 0);'>\n",
       "        <tr>\n",
       "            <td style=\"min-width:85px\">\n",
       "                <img src=\"data:image/jpeg;base64,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\" style=\"width: 100%; max-width:100px;\" />\n",
       "            </td>\n",
       "            <td>\n",
       "            <table>\n",
       "                <tr><td>Installed version:</td><td style='text-align:left'>v1.0.0.dev0 (up to date)</td></tr><tr><td>Available backends:</td><td style='text-align:left'>CVXPY v1.5.3, PICOS v2.4.17</td></tr><tr><td>Default backend (corneto.opt):</td><td style='text-align:left'>CVXPY</td></tr><tr><td>Installed solvers:</td><td style='text-align:left'>CLARABEL, CVXOPT, ECOS, ECOS_BB, GLPK, GLPK_MI, GUROBI, OSQP, SCIP, SCIPY, SCS</td></tr><tr><td>Graphviz version:</td><td style='text-align:left'>v0.20.3</td></tr><tr><td>Installed path:</td><td style='text-align:left'>C:\\Users\\pablo\\Documents\\work\\projects\\corneto\\corneto</td></tr><tr><td>Repository:</td><td style='text-align:left'><a href=https://github.com/saezlab/corneto>https://github.com/saezlab/corneto</a></td></tr>\n",
       "            </table>\n",
       "            </td>\n",
       "        </tr>\n",
       "        </table>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import corneto as cn\n",
    "\n",
    "cn.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "86e3ce04",
   "metadata": {},
   "source": [
    "## A toy example"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2a193cb0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"98pt\" height=\"188pt\"\n",
       " viewBox=\"0.00 0.00 98.00 188.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 184)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-184 94,-184 94,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- N1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>N1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N1</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;N1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;N1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-143.7C18,-136.41 18,-127.73 18,-119.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-119.62 18,-109.62 14.5,-119.62 21.5,-119.62\"/>\n",
       "</g>\n",
       "<!-- M1 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>M1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M1</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-71.7C18,-64.41 18,-55.73 18,-47.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-47.62 18,-37.62 14.5,-47.62 21.5,-47.62\"/>\n",
       "</g>\n",
       "<!-- M2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>M2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M2</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M28.67,-75.17C35.99,-65.68 45.88,-52.86 54.36,-41.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"57.09,-44.06 60.43,-34 51.55,-39.78 57.09,-44.06\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- N2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>N2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;N2 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>I2&#45;&gt;N2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-143.7C72,-134.37 72,-122.77 72,-112.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67,-109.1 77,-109.1 77,-111.1 67,-111.1 67,-109.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"72,-108.1 72,-113.1\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M61.33,-75.17C52.83,-64.14 40.86,-48.63 31.65,-36.7\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"25.3,-36.65 33.22,-30.54 34.44,-32.12 26.52,-38.23 25.3,-36.65\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"28.65,-32.8 31.7,-36.76\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M2 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-71.7C72,-62.37 72,-50.77 72,-40.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67,-37.1 77,-37.1 77,-39.1 67,-39.1 67,-37.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"72,-36.1 72,-41.1\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9c639e50>"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G = cn.Graph.from_sif_tuples(\n",
    "    [\n",
    "        (\"I1\", 1, \"N1\"),  # I1 activates N1\n",
    "        (\"N1\", 1, \"M1\"),  # N1 activates M1\n",
    "        (\"N1\", 1, \"M2\"),  # N1 activaes M2\n",
    "        (\"I2\", -1, \"N2\"),  # I2 inhibits N2\n",
    "        (\"N2\", -1, \"M2\"),  # N2 inhibits M2\n",
    "        (\"N2\", -1, \"M1\"),  # N2 inhibits M1\n",
    "    ]\n",
    ")\n",
    "G.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "176d8ced",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : 2/2 inputs mapped to the graph\n",
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : 2/2 outputs mapped to the graph\n",
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : Pruning the graph with size: V x E = (6, 6)...\n",
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : Finished. Final size: V x E = (6, 6).\n",
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : 2/2 inputs after pruning.\n",
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : 2/2 outputs after pruning.\n",
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : Converting into a flow graph...\n",
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : Creating a network flow problem...\n",
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : Preprocess completed.\n",
      "===============================================================================\n",
      "                                     CVXPY                                     \n",
      "                                     v1.5.3                                    \n",
      "===============================================================================\n",
      "(CVXPY) Aug 26 09:49:48 PM: Your problem has 86 variables, 197 constraints, and 0 parameters.\n",
      "(CVXPY) Aug 26 09:49:48 PM: It is compliant with the following grammars: DCP, DQCP\n",
      "(CVXPY) Aug 26 09:49:48 PM: (If you need to solve this problem multiple times, but with different data, consider using parameters.)\n",
      "(CVXPY) Aug 26 09:49:48 PM: CVXPY will first compile your problem; then, it will invoke a numerical solver to obtain a solution.\n",
      "(CVXPY) Aug 26 09:49:48 PM: Your problem is compiled with the CPP canonicalization backend.\n",
      "-------------------------------------------------------------------------------\n",
      "                                  Compilation                                  \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:49:48 PM: Compiling problem (target solver=GUROBI).\n",
      "(CVXPY) Aug 26 09:49:48 PM: Reduction chain: CvxAttr2Constr -> Qp2SymbolicQp -> QpMatrixStuffing -> GUROBI\n",
      "(CVXPY) Aug 26 09:49:48 PM: Applying reduction CvxAttr2Constr\n",
      "(CVXPY) Aug 26 09:49:48 PM: Applying reduction Qp2SymbolicQp\n",
      "(CVXPY) Aug 26 09:49:48 PM: Applying reduction QpMatrixStuffing\n",
      "(CVXPY) Aug 26 09:49:48 PM: Applying reduction GUROBI\n",
      "(CVXPY) Aug 26 09:49:48 PM: Finished problem compilation (took 8.995e-02 seconds).\n",
      "-------------------------------------------------------------------------------\n",
      "                                Numerical solver                               \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:49:48 PM: Invoking solver GUROBI  to obtain a solution.\n",
      "Set parameter Username\n",
      "Academic license - for non-commercial use only - expires 2024-12-23\n",
      "Set parameter QCPDual to value 1\n",
      "Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (win64 - Windows 11.0 (22631.2))\n",
      "\n",
      "CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "\n",
      "Optimize a model with 197 rows, 86 columns and 397 nonzeros\n",
      "Model fingerprint: 0xd189dd48\n",
      "Variable types: 24 continuous, 62 integer (62 binary)\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e-03, 1e+01]\n",
      "  Objective range  [1e-01, 1e+00]\n",
      "  Bounds range     [1e+00, 1e+00]\n",
      "  RHS range        [1e-03, 1e+01]\n",
      "Found heuristic solution: objective 0.1000000\n",
      "Presolve removed 160 rows and 62 columns\n",
      "Presolve time: 0.00s\n",
      "Presolved: 37 rows, 24 columns, 87 nonzeros\n",
      "Variable types: 5 continuous, 19 integer (19 binary)\n",
      "Found heuristic solution: objective -1.6000000\n",
      "\n",
      "Root relaxation: objective -3.300000e+00, 17 iterations, 0.00 seconds (0.00 work units)\n",
      "\n",
      "    Nodes    |    Current Node    |     Objective Bounds      |     Work\n",
      " Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time\n",
      "\n",
      "     0     0   -3.30000    0    9   -1.60000   -3.30000   106%     -    0s\n",
      "H    0     0                      -3.3000000   -3.30000  0.00%     -    0s\n",
      "     0     0   -3.30000    0    9   -3.30000   -3.30000  0.00%     -    0s\n",
      "\n",
      "Explored 1 nodes (17 simplex iterations) in 0.03 seconds (0.00 work units)\n",
      "Thread count was 8 (of 8 available processors)\n",
      "\n",
      "Solution count 3: -3.3 -1.6 0.1 \n",
      "No other solutions better than -3.3\n",
      "\n",
      "Optimal solution found (tolerance 1.00e-04)\n",
      "Best objective -3.300000000000e+00, best bound -3.300000000000e+00, gap 0.0000%\n",
      "-------------------------------------------------------------------------------\n",
      "                                    Summary                                    \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:49:48 PM: Problem status: optimal\n",
      "(CVXPY) Aug 26 09:49:48 PM: Optimal value: 7.000e-01\n",
      "(CVXPY) Aug 26 09:49:48 PM: Compilation took 8.995e-02 seconds\n",
      "(CVXPY) Aug 26 09:49:48 PM: Solver (including time spent in interface) took 5.875e-02 seconds\n",
      "(CORNETO) Aug 26 09:49:48 PM - INFO    : Finished in 0.21 s.\n"
     ]
    }
   ],
   "source": [
    "from corneto.methods import runVanillaCarnival\n",
    "\n",
    "# These are the measurements (e.g. TF activity from Decoupler).\n",
    "# Positive values correspond to up-regulation and negative values\n",
    "# with down-regulation. The bigger the absolute value is,\n",
    "# the bigger the importance is\n",
    "measurements = {\"M1\": 1, \"M2\": 1}\n",
    "\n",
    "# Perturbations are the upstream nodes were the signal originates on,\n",
    "# for example, ligands or receptors.\n",
    "perturbations = {\"I1\": 1, \"I2\": 1}\n",
    "\n",
    "# We run the `standard` carnival problem. This interface is similar\n",
    "# to the old R function https://saezlab.github.io/CARNIVAL/reference/runVanillaCarnival.html\n",
    "P, Gf = runVanillaCarnival(perturbations, measurements, G, betaWeight=0.1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "79894ada",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.])"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "P.objectives[0].value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "8b03e08d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "7.0"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "P.objectives[1].value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "c8be26ab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"98pt\" height=\"188pt\"\n",
       " viewBox=\"0.00 0.00 98.00 188.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 184)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-184 94,-184 94,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- N1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>N1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N1</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;N1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;N1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-143.34C18,-135.82 18,-126.87 18,-118.52\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-118.79 18,-108.79 14.5,-118.79 21.5,-118.79\"/>\n",
       "</g>\n",
       "<!-- M1 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>M1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M1</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-71.7C18,-64.18 18,-55.19 18,-46.78\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-46.97 18,-36.97 14.5,-46.97 21.5,-46.97\"/>\n",
       "</g>\n",
       "<!-- M2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>M2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M2</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M28.67,-75.17C36.11,-65.52 46.21,-52.43 54.79,-41.31\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"57.41,-43.64 60.75,-33.58 51.87,-39.36 57.41,-43.64\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- N2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>N2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"72\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;N2 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>I2&#45;&gt;N2</title>\n",
       "<path fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" d=\"M72,-143.34C72,-134.94 72,-124.77 72,-115.64\"/>\n",
       "<polygon fill=\"#104e8b\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"67,-111.4 77,-111.4 77,-113.4 67,-113.4 67,-111.4\"/>\n",
       "<polyline fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"72,-110.4 72,-115.4\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M61.07,-74.83C53.02,-64.4 41.97,-50.07 33.08,-38.55\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"26.48,-38.18 34.4,-32.07 35.62,-33.65 27.7,-39.76 26.48,-38.18\"/>\n",
       "<polyline fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"29.83,-34.33 32.88,-38.29\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M2 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M72,-71.34C72,-62.94 72,-52.77 72,-43.64\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"67,-39.4 77,-39.4 77,-41.4 67,-41.4 67,-39.4\"/>\n",
       "<polyline fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"72,-38.4 72,-43.4\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9c781a90>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# The method for plotting will be simplified in next versions\n",
    "G.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P, edge_var=\"edge_values_c0\"),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(P, Gf, vertex_var=\"vertex_values_c0\"),\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a7b0d803",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>V</th>\n",
       "      <th>value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>N1</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>M2</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>N2</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>M1</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>I1</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>I2</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>_s</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>_pert_c0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>_meas_c0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>_t</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          V  value\n",
       "0        N1    0.0\n",
       "1        M2    1.0\n",
       "2        N2   -1.0\n",
       "3        M1    1.0\n",
       "4        I1    1.0\n",
       "5        I2    1.0\n",
       "6        _s    1.0\n",
       "7  _pert_c0    1.0\n",
       "8  _meas_c0    0.0\n",
       "9        _t    0.0"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "from corneto.methods.carnival import get_result, get_selected_edges\n",
    "\n",
    "V, E = get_result(P, Gf)\n",
    "pd.DataFrame(V)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "7ff44c27",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>E</th>\n",
       "      <th>value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>((I1), (N1))</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>((N1), (M1))</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>((N1), (M2))</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>((I2), (N2))</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>((N2), (M2))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>((N2), (M1))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>((_s), (_pert_c0))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>((_pert_c0), (I1))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>((_pert_c0), (I2))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>((M1), (_meas_c0))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>((M2), (_meas_c0))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>((_meas_c0), (_t))</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>((), (_s))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>((_t), ())</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     E  value\n",
       "0         ((I1), (N1))    0.0\n",
       "1         ((N1), (M1))    0.0\n",
       "2         ((N1), (M2))    0.0\n",
       "3         ((I2), (N2))   -1.0\n",
       "4         ((N2), (M2))    1.0\n",
       "5         ((N2), (M1))    1.0\n",
       "6   ((_s), (_pert_c0))    1.0\n",
       "7   ((_pert_c0), (I1))    1.0\n",
       "8   ((_pert_c0), (I2))    1.0\n",
       "9   ((M1), (_meas_c0))    1.0\n",
       "10  ((M2), (_meas_c0))    1.0\n",
       "11  ((_meas_c0), (_t))    0.0\n",
       "12          ((), (_s))    1.0\n",
       "13          ((_t), ())    0.0"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.DataFrame(E)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "360dbc38",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[{'__edge_type': 'directed',\n",
       "  'interaction': 1,\n",
       "  '__source_attr': {'I1': {'__value': {}}},\n",
       "  '__target_attr': {'N1': {'__value': {}}}},\n",
       " {'__edge_type': 'directed',\n",
       "  'interaction': 1,\n",
       "  '__source_attr': {'N1': {'__value': {}}},\n",
       "  '__target_attr': {'M1': {'__value': {}}}},\n",
       " {'__edge_type': 'directed',\n",
       "  'interaction': 1,\n",
       "  '__source_attr': {'N1': {'__value': {}}},\n",
       "  '__target_attr': {'M2': {'__value': {}}}},\n",
       " {'__edge_type': 'directed',\n",
       "  'interaction': -1,\n",
       "  '__source_attr': {'I2': {'__value': {}}},\n",
       "  '__target_attr': {'N2': {'__value': {}}}},\n",
       " {'__edge_type': 'directed',\n",
       "  'interaction': -1,\n",
       "  '__source_attr': {'N2': {'__value': {}}},\n",
       "  '__target_attr': {'M2': {'__value': {}}}},\n",
       " {'__edge_type': 'directed',\n",
       "  'interaction': -1,\n",
       "  '__source_attr': {'N2': {'__value': {}}},\n",
       "  '__target_attr': {'M1': {'__value': {}}}}]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G.get_attr_edges()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "548f868d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"98pt\" height=\"188pt\"\n",
       " viewBox=\"0.00 0.00 98.00 188.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 184)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-184 94,-184 94,4 -4,4\"/>\n",
       "<!-- I2 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"45\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"45\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- N2 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>N2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"45\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"45\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;N2 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I2&#45;&gt;N2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M45,-143.7C45,-134.37 45,-122.77 45,-112.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"40,-109.1 50,-109.1 50,-111.1 40,-111.1 40,-109.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"45,-108.1 45,-113.1\"/>\n",
       "</g>\n",
       "<!-- M2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>M2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M2</text>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M2 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M38.74,-72.76C34.92,-62.87 30.01,-50.13 25.92,-39.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"19.92,-37.88 29.25,-34.28 29.97,-36.15 20.64,-39.75 19.92,-37.88\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"24.23,-35.15 26.03,-39.81\"/>\n",
       "</g>\n",
       "<!-- M1 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>M1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M1</text>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M1 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M51.26,-72.76C55.08,-62.87 59.99,-50.13 64.08,-39.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"60.75,-34.28 70.08,-37.88 69.36,-39.75 60.03,-36.15 60.75,-34.28\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"65.77,-35.15 63.97,-39.81\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9d9beaf0>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_sol = Gf.edge_subgraph(get_selected_edges(P, Gf))\n",
    "G_sol.plot()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cc217629",
   "metadata": {},
   "source": [
    "## CarnivalR port"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "7abf9fb1",
   "metadata": {},
   "outputs": [],
   "source": [
    "# G = cn.Graph.from_sif('PKN-LiverDREAM.sif.txt')\n",
    "# G.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "ccecb687",
   "metadata": {},
   "outputs": [],
   "source": [
    "# list(G.in_edges(\"raf1\"))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "4f1f04bc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"161pt\" height=\"260pt\"\n",
       " viewBox=\"0.00 0.00 161.00 260.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 256)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-256 157,-256 157,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- P1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>P1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"85\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"85\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">P1</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;P1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;P1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M29.98,-148.49C39.79,-138.23 53.88,-123.52 65.34,-111.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67.69,-114.14 72.08,-104.5 62.64,-109.3 67.69,-114.14\"/>\n",
       "</g>\n",
       "<!-- P2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>P2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"135\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"135\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">P2</text>\n",
       "</g>\n",
       "<!-- P1&#45;&gt;P2 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>P1&#45;&gt;P2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M90.8,-72.76C96.81,-62.77 105.9,-49.87 114.38,-39.22\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"116.91,-41.65 120.61,-31.72 111.52,-37.17 116.91,-41.65\"/>\n",
       "</g>\n",
       "<!-- T -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>T</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"81\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"81\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">T</text>\n",
       "</g>\n",
       "<!-- P1&#45;&gt;T -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>P1&#45;&gt;T</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M84.01,-71.7C83.59,-64.41 83.1,-55.73 82.63,-47.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"86.13,-47.4 82.06,-37.62 79.14,-47.8 86.13,-47.4\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"64\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"64\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;I1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>I2&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M54.47,-218.5C48.49,-209.39 40.63,-197.43 33.74,-186.95\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"36.77,-185.19 28.35,-178.75 30.92,-189.03 36.77,-185.19\"/>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;P1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;P1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M66.53,-215.87C70.06,-191.99 76.51,-148.38 80.78,-119.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"84.24,-120.09 82.24,-109.69 77.31,-119.07 84.24,-120.09\"/>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;P2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>I2&#45;&gt;P2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M80.67,-226.4C98.33,-218.39 125.26,-203.02 137,-180 160.11,-134.66 149.34,-72.39 141.19,-40.19\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"135.42,-37.9 145.1,-35.37 145.61,-37.31 135.93,-39.83 135.42,-37.9\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"140.01,-35.67 141.27,-40.51\"/>\n",
       "</g>\n",
       "<!-- P2&#45;&gt;P1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>P2&#45;&gt;P1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M129.17,-35.29C123.15,-45.28 114.08,-58.16 105.61,-68.8\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"103.1,-66.35 99.39,-76.28 108.48,-70.83 103.1,-66.35\"/>\n",
       "</g>\n",
       "<!-- I3 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>I3</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"110\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"110\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I3</text>\n",
       "</g>\n",
       "<!-- I3&#45;&gt;P1 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>I3&#45;&gt;P1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M104.2,-144.76C100.7,-134.96 96.2,-122.36 92.44,-111.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"86.39,-109.77 95.81,-106.41 96.48,-108.29 87.07,-111.65 86.39,-109.77\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"90.77,-107.15 92.45,-111.86\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9d9f01f0>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G = cn.Graph()\n",
    "G.add_edge(\"I1\", \"P1\", interaction=1)\n",
    "G.add_edge(\"I2\", \"P1\", interaction=1)\n",
    "G.add_edge(\"I2\", \"P2\", interaction=-1)\n",
    "G.add_edge(\"P1\", \"T\", interaction=1)\n",
    "\n",
    "G.add_edge(\"I3\", \"P1\", interaction=-1)\n",
    "# G.add_edge(\"I3\", \"I1\", interaction=-1)\n",
    "G.add_edge(\"I2\", \"I1\", interaction=1)\n",
    "G.add_edge(\"P2\", \"P1\", interaction=1)\n",
    "G.add_edge(\"P1\", \"P2\", interaction=1)\n",
    "G.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "38e1bc31",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "===============================================================================\n",
      "                                     CVXPY                                     \n",
      "                                     v1.5.3                                    \n",
      "===============================================================================\n",
      "(CVXPY) Aug 26 09:49:51 PM: Your problem has 34 variables, 68 constraints, and 0 parameters.\n",
      "(CVXPY) Aug 26 09:49:51 PM: It is compliant with the following grammars: DCP, DQCP\n",
      "(CVXPY) Aug 26 09:49:51 PM: (If you need to solve this problem multiple times, but with different data, consider using parameters.)\n",
      "(CVXPY) Aug 26 09:49:51 PM: CVXPY will first compile your problem; then, it will invoke a numerical solver to obtain a solution.\n",
      "(CVXPY) Aug 26 09:49:51 PM: Your problem is compiled with the CPP canonicalization backend.\n",
      "-------------------------------------------------------------------------------\n",
      "                                  Compilation                                  \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:49:51 PM: Compiling problem (target solver=GUROBI).\n",
      "(CVXPY) Aug 26 09:49:51 PM: Reduction chain: CvxAttr2Constr -> Qp2SymbolicQp -> QpMatrixStuffing -> GUROBI\n",
      "(CVXPY) Aug 26 09:49:51 PM: Applying reduction CvxAttr2Constr\n",
      "(CVXPY) Aug 26 09:49:51 PM: Applying reduction Qp2SymbolicQp\n",
      "(CVXPY) Aug 26 09:49:51 PM: Applying reduction QpMatrixStuffing\n",
      "(CVXPY) Aug 26 09:49:52 PM: Applying reduction GUROBI\n",
      "(CVXPY) Aug 26 09:49:52 PM: Finished problem compilation (took 4.203e-01 seconds).\n",
      "-------------------------------------------------------------------------------\n",
      "                                Numerical solver                               \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:49:52 PM: Invoking solver GUROBI  to obtain a solution.\n",
      "Set parameter QCPDual to value 1\n",
      "Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (win64 - Windows 11.0 (22631.2))\n",
      "\n",
      "CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "\n",
      "Optimize a model with 68 rows, 34 columns and 150 nonzeros\n",
      "Model fingerprint: 0xfd9698c0\n",
      "Variable types: 6 continuous, 28 integer (28 binary)\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e+00, 6e+00]\n",
      "  Objective range  [1e-02, 1e+00]\n",
      "  Bounds range     [1e+00, 1e+00]\n",
      "  RHS range        [1e+00, 6e+00]\n",
      "Found heuristic solution: objective 0.0000000\n",
      "Presolve removed 59 rows and 26 columns\n",
      "Presolve time: 0.00s\n",
      "Presolved: 9 rows, 8 columns, 22 nonzeros\n",
      "Variable types: 2 continuous, 6 integer (6 binary)\n",
      "\n",
      "Root relaxation: objective -9.800000e-01, 2 iterations, 0.00 seconds (0.00 work units)\n",
      "\n",
      "    Nodes    |    Current Node    |     Objective Bounds      |     Work\n",
      " Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time\n",
      "\n",
      "*    0     0               0      -0.9800000   -0.98000  0.00%     -    0s\n",
      "\n",
      "Explored 1 nodes (2 simplex iterations) in 0.09 seconds (0.00 work units)\n",
      "Thread count was 8 (of 8 available processors)\n",
      "\n",
      "Solution count 2: -0.98 0 \n",
      "\n",
      "Optimal solution found (tolerance 1.00e-04)\n",
      "Best objective -9.800000000000e-01, best bound -9.800000000000e-01, gap 0.0000%\n",
      "-------------------------------------------------------------------------------\n",
      "                                    Summary                                    \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:49:52 PM: Problem status: optimal\n",
      "(CVXPY) Aug 26 09:49:52 PM: Optimal value: 2.000e-02\n",
      "(CVXPY) Aug 26 09:49:52 PM: Compilation took 4.203e-01 seconds\n",
      "(CVXPY) Aug 26 09:49:52 PM: Solver (including time spent in interface) took 1.171e-01 seconds\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Problem(Minimize(Expression(AFFINE, UNKNOWN, ())), [Inequality(Constant(CONSTANT, ZERO, (6,))), Inequality(Variable((6,), vertex_position)), Inequality(Expression(AFFINE, NONNEGATIVE, (6,))), Inequality(Expression(AFFINE, NONNEGATIVE, (8,))), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, UNKNOWN, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, UNKNOWN, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, UNKNOWN, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, UNKNOWN, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, UNKNOWN, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, UNKNOWN, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, UNKNOWN, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, UNKNOWN, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Equality(Expression(AFFINE, NONNEGATIVE, ()), Constant(CONSTANT, ZERO, ())), Equality(Expression(AFFINE, NONNEGATIVE, ()), Constant(CONSTANT, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ())), Inequality(Expression(AFFINE, NONNEGATIVE, ()))])"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from corneto.methods.carnival import milp_carnival\n",
    "\n",
    "P = milp_carnival(G, {\"I2\": -1, \"I1\": 0}, {\"T\": 1}, beta_weight=0.01)\n",
    "P.solve(solver=\"GUROBI\", verbosity=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "2b03d890",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(0.0, 2.0)"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "P.objectives[0].value, P.objectives[1].value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "1df680b3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'vertex_inhibited': Variable((6,), vertex_inhibited, boolean=True),\n",
       " 'vertex_activated': Variable((6,), vertex_activated, boolean=True),\n",
       " 'edge_activating': Variable((8,), edge_activating, boolean=True),\n",
       " 'edge_inhibiting': Variable((8,), edge_inhibiting, boolean=True),\n",
       " 'vertex_position': Variable((6,), vertex_position),\n",
       " 'vertex_values': Expression(AFFINE, UNKNOWN, (6,)),\n",
       " 'edge_values': Expression(AFFINE, UNKNOWN, (8,))}"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "P.expr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "fe508cc8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>V</th>\n",
       "      <th>value</th>\n",
       "      <th>pos</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>I1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>P1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>I2</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>P2</td>\n",
       "      <td>-0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>T</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>I3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    V  value  pos\n",
       "0  I1    1.0  0.0\n",
       "1  P1    1.0  1.0\n",
       "2  I2   -1.0  0.0\n",
       "3  P2   -0.0  0.0\n",
       "4   T    1.0  6.0\n",
       "5  I3    0.0  0.0"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.DataFrame(\n",
    "    {\"V\": G.V, \"value\": P.expr.vertex_values.value, \"pos\": P.expr.vertex_position.value}\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "5c275ae7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>E</th>\n",
       "      <th>value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>((I1), (P1))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>((I2), (P1))</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>((I2), (P2))</td>\n",
       "      <td>-0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>((P1), (T))</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>((I3), (P1))</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>((I2), (I1))</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>((P2), (P1))</td>\n",
       "      <td>-0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>((P1), (P2))</td>\n",
       "      <td>-0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              E  value\n",
       "0  ((I1), (P1))    1.0\n",
       "1  ((I2), (P1))    0.0\n",
       "2  ((I2), (P2))   -0.0\n",
       "3   ((P1), (T))    1.0\n",
       "4  ((I3), (P1))    0.0\n",
       "5  ((I2), (I1))    0.0\n",
       "6  ((P2), (P1))   -0.0\n",
       "7  ((P1), (P2))   -0.0"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.DataFrame({\"E\": G.E, \"value\": P.expr.edge_values.value})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "39921703",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning: node 'map3k7', graph '%3' size too small for label\n",
      "Warning: node 'map3k1', graph '%3' size too small for label\n",
      "Warning: node 'mek12', graph '%3' size too small for label\n",
      "Warning: node 'map3k7', graph '%3' size too small for label\n",
      "Warning: node 'map3k1', graph '%3' size too small for label\n",
      "Warning: node 'mek12', graph '%3' size too small for label\n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"472pt\" height=\"1124pt\"\n",
       " viewBox=\"0.00 0.00 472.00 1124.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 1120)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-1120 468,-1120 468,4 -4,4\"/>\n",
       "<!-- prak -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>prak</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">prak</text>\n",
       "</g>\n",
       "<!-- hsp27 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>hsp27</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">hsp27</text>\n",
       "</g>\n",
       "<!-- prak&#45;&gt;hsp27 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>prak&#45;&gt;hsp27</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-71.7C72,-64.07 72,-54.92 72,-46.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.5,-46.48 72,-36.48 68.5,-46.48 75.5,-46.48\"/>\n",
       "</g>\n",
       "<!-- map3k7 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>map3k7</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"166\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"166\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">map3k7</text>\n",
       "</g>\n",
       "<!-- mkk7 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>mkk7</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"234\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">mkk7</text>\n",
       "</g>\n",
       "<!-- map3k7&#45;&gt;mkk7 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>map3k7&#45;&gt;mkk7</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M178.16,-436.49C188.31,-426.03 202.97,-410.94 214.72,-398.84\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"217.23,-401.29 221.68,-391.68 212.21,-396.41 217.23,-401.29\"/>\n",
       "</g>\n",
       "<!-- nik -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>nik</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"126\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"126\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">nik</text>\n",
       "</g>\n",
       "<!-- map3k7&#45;&gt;nik -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>map3k7&#45;&gt;nik</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M157.32,-433.81C152.18,-424.82 145.56,-413.23 139.73,-403.03\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"142.85,-401.43 134.85,-394.49 136.77,-404.91 142.85,-401.43\"/>\n",
       "</g>\n",
       "<!-- mkk3 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>mkk3</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">mkk3</text>\n",
       "</g>\n",
       "<!-- map3k7&#45;&gt;mkk3 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>map3k7&#45;&gt;mkk3</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M149.19,-442.56C125.48,-433.27 81.07,-415.12 45,-396 43.87,-395.4 42.73,-394.77 41.58,-394.12\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"43.61,-391.26 33.23,-389.13 40.01,-397.27 43.61,-391.26\"/>\n",
       "</g>\n",
       "<!-- mkk6 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>mkk6</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">mkk6</text>\n",
       "</g>\n",
       "<!-- map3k7&#45;&gt;mkk6 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>map3k7&#45;&gt;mkk6</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M151.72,-438.37C136.45,-427 112.03,-408.81 94.24,-395.56\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"96.52,-392.89 86.41,-389.73 92.34,-398.51 96.52,-392.89\"/>\n",
       "</g>\n",
       "<!-- mkk4 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>mkk4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"180\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">mkk4</text>\n",
       "</g>\n",
       "<!-- map3k7&#45;&gt;mkk4 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>map3k7&#45;&gt;mkk4</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M169.39,-432.05C170.97,-424.14 172.89,-414.54 174.66,-405.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"178.04,-406.65 176.57,-396.16 171.17,-405.28 178.04,-406.65\"/>\n",
       "</g>\n",
       "<!-- jnk12 -->\n",
       "<g id=\"node23\" class=\"node\">\n",
       "<title>jnk12</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"203\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"203\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">jnk12</text>\n",
       "</g>\n",
       "<!-- mkk7&#45;&gt;jnk12 -->\n",
       "<g id=\"edge22\" class=\"edge\">\n",
       "<title>mkk7&#45;&gt;jnk12</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M226.97,-361.12C223.16,-352.52 218.37,-341.72 214.08,-332.02\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"217.41,-330.89 210.16,-323.17 211.01,-333.73 217.41,-330.89\"/>\n",
       "</g>\n",
       "<!-- ikk -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>ikk</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"280\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"280\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ikk</text>\n",
       "</g>\n",
       "<!-- nik&#45;&gt;ikk -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>nik&#45;&gt;ikk</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M140.88,-367.01C144.75,-364.59 148.97,-362.09 153,-360 186.51,-342.61 227.04,-326.5 253.16,-316.71\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"254.23,-320.04 262.39,-313.29 251.8,-313.48 254.23,-320.04\"/>\n",
       "</g>\n",
       "<!-- mkk3&#45;&gt;prak -->\n",
       "<g id=\"edge53\" class=\"edge\">\n",
       "<title>mkk3&#45;&gt;prak</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M21.22,-359.97C30.26,-312.08 55.95,-175.98 66.93,-117.85\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"70.31,-118.79 68.73,-108.32 63.44,-117.49 70.31,-118.79\"/>\n",
       "</g>\n",
       "<!-- p38 -->\n",
       "<g id=\"node22\" class=\"node\">\n",
       "<title>p38</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">p38</text>\n",
       "</g>\n",
       "<!-- mkk3&#45;&gt;p38 -->\n",
       "<g id=\"edge52\" class=\"edge\">\n",
       "<title>mkk3&#45;&gt;p38</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M28.67,-363.17C36.21,-353.39 46.48,-340.08 55.13,-328.87\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"57.79,-331.16 61.12,-321.1 52.24,-326.88 57.79,-331.16\"/>\n",
       "</g>\n",
       "<!-- mkk6&#45;&gt;p38 -->\n",
       "<g id=\"edge35\" class=\"edge\">\n",
       "<title>mkk6&#45;&gt;p38</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-359.7C72,-352.07 72,-342.92 72,-334.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.5,-334.48 72,-324.48 68.5,-334.48 75.5,-334.48\"/>\n",
       "</g>\n",
       "<!-- mkk4&#45;&gt;p38 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>mkk4&#45;&gt;p38</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M164.98,-367.27C147.01,-355.62 116.7,-335.97 95.59,-322.29\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"97.5,-319.36 87.21,-316.86 93.69,-325.23 97.5,-319.36\"/>\n",
       "</g>\n",
       "<!-- mkk4&#45;&gt;jnk12 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>mkk4&#45;&gt;jnk12</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M185.45,-360.41C188.11,-352.3 191.38,-342.35 194.38,-333.25\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"197.67,-334.42 197.47,-323.83 191.02,-332.24 197.67,-334.42\"/>\n",
       "</g>\n",
       "<!-- pip3 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>pip3</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"378\" cy=\"-594\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"378\" y=\"-588.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">pip3</text>\n",
       "</g>\n",
       "<!-- pdk1 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>pdk1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"380\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"380\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">pdk1</text>\n",
       "</g>\n",
       "<!-- pip3&#45;&gt;pdk1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>pip3&#45;&gt;pdk1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M378.5,-575.34C378.66,-569.74 378.85,-563.36 379.03,-557.02\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"383.4,-557.26 379.31,-547.14 374.65,-557.01 383.4,-557.26\"/>\n",
       "</g>\n",
       "<!-- akt -->\n",
       "<g id=\"node29\" class=\"node\">\n",
       "<title>akt</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"380\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"380\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">akt</text>\n",
       "</g>\n",
       "<!-- pdk1&#45;&gt;akt -->\n",
       "<g id=\"edge55\" class=\"edge\">\n",
       "<title>pdk1&#45;&gt;akt</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M380,-503.34C380,-497.74 380,-491.36 380,-485.02\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"384.38,-485.14 380,-475.14 375.63,-485.14 384.38,-485.14\"/>\n",
       "</g>\n",
       "<!-- pak -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>pak</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"326\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"326\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">pak</text>\n",
       "</g>\n",
       "<!-- raf1 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>raf1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"403\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"403\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">raf1</text>\n",
       "</g>\n",
       "<!-- pak&#45;&gt;raf1 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>pak&#45;&gt;raf1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M339.06,-365.13C350.9,-354.37 368.54,-338.33 382.3,-325.82\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"384.55,-328.5 389.59,-319.19 379.84,-323.32 384.55,-328.5\"/>\n",
       "</g>\n",
       "<!-- mek12 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>mek12</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"357\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"357\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">mek12</text>\n",
       "</g>\n",
       "<!-- raf1&#45;&gt;mek12 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>raf1&#45;&gt;mek12</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M393.47,-290.5C387.3,-281.11 379.14,-268.69 372.1,-257.98\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"375.14,-256.24 366.73,-249.8 369.29,-260.08 375.14,-256.24\"/>\n",
       "</g>\n",
       "<!-- rac -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>rac</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"326\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"326\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">rac</text>\n",
       "</g>\n",
       "<!-- rac&#45;&gt;pak -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>rac&#45;&gt;pak</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M326,-503.59C326,-479.29 326,-434.97 326,-406.27\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"329.5,-406.49 326,-396.49 322.5,-406.49 329.5,-406.49\"/>\n",
       "</g>\n",
       "<!-- map3k1 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>map3k1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"276\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"276\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">map3k1</text>\n",
       "</g>\n",
       "<!-- rac&#45;&gt;map3k1 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>rac&#45;&gt;map3k1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M315.88,-506.83C309.13,-497.38 300.09,-484.73 292.33,-473.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"295.33,-472.04 286.67,-465.93 289.63,-476.11 295.33,-472.04\"/>\n",
       "</g>\n",
       "<!-- map3k1&#45;&gt;mkk7 -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>map3k1&#45;&gt;mkk7</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M266.68,-433.46C261.28,-424.46 254.36,-412.93 248.28,-402.81\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"251.35,-401.11 243.2,-394.34 245.35,-404.71 251.35,-401.11\"/>\n",
       "</g>\n",
       "<!-- map3k1&#45;&gt;mkk4 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>map3k1&#45;&gt;mkk4</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M261.42,-438.37C245.82,-427 220.88,-408.81 202.71,-395.56\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"204.85,-392.79 194.71,-389.73 200.73,-398.44 204.85,-392.79\"/>\n",
       "</g>\n",
       "<!-- map3k1&#45;&gt;ikk -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>map3k1&#45;&gt;ikk</title>\n",
       "<path fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" d=\"M276.51,-431.02C277.14,-408.4 278.25,-369.1 279.05,-340.79\"/>\n",
       "<polygon fill=\"#104e8b\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"283.41,-341.19 279.32,-331.07 274.67,-340.95 283.41,-341.19\"/>\n",
       "</g>\n",
       "<!-- erk12 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>erk12</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"237\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"237\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">erk12</text>\n",
       "</g>\n",
       "<!-- mek12&#45;&gt;erk12 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>mek12&#45;&gt;erk12</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M341.8,-224.13C321.54,-212.31 285.43,-191.25 261.34,-177.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"263.18,-174.22 252.78,-172.21 259.65,-180.27 263.18,-174.22\"/>\n",
       "</g>\n",
       "<!-- erk12&#45;&gt;prak -->\n",
       "<g id=\"edge54\" class=\"edge\">\n",
       "<title>erk12&#45;&gt;prak</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M220.58,-154.03C191.79,-141.82 132.03,-116.47 97.72,-101.91\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"99.28,-98.77 88.71,-98.09 96.54,-105.21 99.28,-98.77\"/>\n",
       "</g>\n",
       "<!-- irs1 -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>irs1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"265\" cy=\"-882\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"265\" y=\"-876.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">irs1</text>\n",
       "</g>\n",
       "<!-- pi3k -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>pi3k</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"376\" cy=\"-666\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"376\" y=\"-660.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">pi3k</text>\n",
       "</g>\n",
       "<!-- irs1&#45;&gt;pi3k -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>irs1&#45;&gt;pi3k</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M272.28,-864.77C280.43,-846.82 294.17,-817.1 307,-792 323.91,-758.92 344.68,-721.72 358.98,-696.57\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"362.7,-698.88 363.87,-688.03 355.11,-694.54 362.7,-698.88\"/>\n",
       "</g>\n",
       "<!-- pi3k&#45;&gt;pip3 -->\n",
       "<g id=\"edge41\" class=\"edge\">\n",
       "<title>pi3k&#45;&gt;pip3</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M376.5,-647.34C376.66,-641.74 376.85,-635.36 377.03,-629.02\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"381.4,-629.26 377.31,-619.14 372.65,-629.01 381.4,-629.26\"/>\n",
       "</g>\n",
       "<!-- pi3k&#45;&gt;rac -->\n",
       "<g id=\"edge40\" class=\"edge\">\n",
       "<title>pi3k&#45;&gt;rac</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M367.63,-649.06C362.39,-638.69 355.77,-624.77 351,-612 343.39,-591.61 336.82,-567.84 332.34,-550\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"335.75,-549.24 329.97,-540.37 328.95,-550.91 335.75,-549.24\"/>\n",
       "</g>\n",
       "<!-- ikb -->\n",
       "<g id=\"node28\" class=\"node\">\n",
       "<title>ikb</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"280\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"280\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ikb</text>\n",
       "</g>\n",
       "<!-- ikk&#45;&gt;ikb -->\n",
       "<g id=\"edge26\" class=\"edge\">\n",
       "<title>ikk&#45;&gt;ikb</title>\n",
       "<path fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" d=\"M280,-287.34C280,-281.74 280,-275.36 280,-269.02\"/>\n",
       "<polygon fill=\"#104e8b\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"284.38,-269.14 280,-259.14 275.63,-269.14 284.38,-269.14\"/>\n",
       "</g>\n",
       "<!-- grb2 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>grb2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"334\" cy=\"-882\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"334\" y=\"-876.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">grb2</text>\n",
       "</g>\n",
       "<!-- sos -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>sos</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"334\" cy=\"-810\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"334\" y=\"-804.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">sos</text>\n",
       "</g>\n",
       "<!-- grb2&#45;&gt;sos -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>grb2&#45;&gt;sos</title>\n",
       "<path fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" d=\"M334,-863.34C334,-857.74 334,-851.36 334,-845.02\"/>\n",
       "<polygon fill=\"#104e8b\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"338.38,-845.14 334,-835.14 329.63,-845.14 338.38,-845.14\"/>\n",
       "</g>\n",
       "<!-- ras -->\n",
       "<g id=\"node27\" class=\"node\">\n",
       "<title>ras</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"426\" cy=\"-738\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"426\" y=\"-732.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ras</text>\n",
       "</g>\n",
       "<!-- sos&#45;&gt;ras -->\n",
       "<g id=\"edge25\" class=\"edge\">\n",
       "<title>sos&#45;&gt;ras</title>\n",
       "<path fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" d=\"M348.38,-798.06C361.8,-787.85 382.19,-772.34 398.7,-759.77\"/>\n",
       "<polygon fill=\"#104e8b\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"401.15,-763.41 406.46,-753.87 395.85,-756.44 401.15,-763.41\"/>\n",
       "</g>\n",
       "<!-- p38&#45;&gt;prak -->\n",
       "<g id=\"edge33\" class=\"edge\">\n",
       "<title>p38&#45;&gt;prak</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-287.85C72,-250.83 72,-163.18 72,-118.39\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.5,-118.61 72,-108.61 68.5,-118.61 75.5,-118.61\"/>\n",
       "</g>\n",
       "<!-- igf1 -->\n",
       "<g id=\"node24\" class=\"node\">\n",
       "<title>igf1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"269\" cy=\"-1098\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"269\" y=\"-1092.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">igf1</text>\n",
       "</g>\n",
       "<!-- igfr -->\n",
       "<g id=\"node25\" class=\"node\">\n",
       "<title>igfr</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"269\" cy=\"-1026\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"269\" y=\"-1020.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">igfr</text>\n",
       "</g>\n",
       "<!-- igf1&#45;&gt;igfr -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>igf1&#45;&gt;igfr</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M269,-1079.34C269,-1073.74 269,-1067.36 269,-1061.02\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"273.38,-1061.14 269,-1051.14 264.63,-1061.14 273.38,-1061.14\"/>\n",
       "</g>\n",
       "<!-- igfr&#45;&gt;irs1 -->\n",
       "<g id=\"edge23\" class=\"edge\">\n",
       "<title>igfr&#45;&gt;irs1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M268.49,-1007.02C267.86,-984.4 266.75,-945.1 265.95,-916.79\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"270.33,-916.95 265.68,-907.07 261.59,-917.19 270.33,-916.95\"/>\n",
       "</g>\n",
       "<!-- shc -->\n",
       "<g id=\"node26\" class=\"node\">\n",
       "<title>shc</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"296\" cy=\"-954\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"296\" y=\"-948.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">shc</text>\n",
       "</g>\n",
       "<!-- igfr&#45;&gt;shc -->\n",
       "<g id=\"edge24\" class=\"edge\">\n",
       "<title>igfr&#45;&gt;shc</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M275.4,-1008.41C278.61,-1000.1 282.56,-989.85 286.14,-980.56\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"289.36,-981.93 289.7,-971.34 282.83,-979.41 289.36,-981.93\"/>\n",
       "</g>\n",
       "<!-- shc&#45;&gt;grb2 -->\n",
       "<g id=\"edge34\" class=\"edge\">\n",
       "<title>shc&#45;&gt;grb2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M304.25,-937.81C309.01,-929.04 315.12,-917.78 320.56,-907.76\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"323.63,-909.43 325.33,-898.98 317.48,-906.1 323.63,-909.43\"/>\n",
       "</g>\n",
       "<!-- ras&#45;&gt;raf1 -->\n",
       "<g id=\"edge43\" class=\"edge\">\n",
       "<title>ras&#45;&gt;raf1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M434.51,-721.2C439.73,-710.88 446.12,-696.97 450,-684 461.47,-645.64 464,-635.04 464,-595 464,-595 464,-595 464,-449 464,-403.68 437.45,-356.35 419.38,-329.39\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"422.4,-327.61 413.84,-321.37 416.64,-331.59 422.4,-327.61\"/>\n",
       "</g>\n",
       "<!-- ras&#45;&gt;map3k1 -->\n",
       "<g id=\"edge44\" class=\"edge\">\n",
       "<title>ras&#45;&gt;map3k1</title>\n",
       "<path fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" d=\"M430.17,-719.71C439.15,-678 455.8,-570.38 407,-504 395.01,-487.69 344.06,-470.39 309.35,-460.15\"/>\n",
       "<polygon fill=\"#104e8b\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"310.67,-455.98 299.85,-457.44 308.26,-464.39 310.67,-455.98\"/>\n",
       "</g>\n",
       "<!-- ras&#45;&gt;pi3k -->\n",
       "<g id=\"edge42\" class=\"edge\">\n",
       "<title>ras&#45;&gt;pi3k</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M415.64,-722.5C408.87,-713.02 399.89,-700.44 392.18,-689.66\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"395.23,-687.9 386.57,-681.79 389.53,-691.97 395.23,-687.9\"/>\n",
       "</g>\n",
       "<!-- akt&#45;&gt;pak -->\n",
       "<g id=\"edge29\" class=\"edge\">\n",
       "<title>akt&#45;&gt;pak</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M369.07,-434.83C360.54,-423.78 348.65,-408.36 339.52,-396.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"333.2,-396.51 341.11,-390.41 342.34,-391.99 334.42,-398.1 333.2,-396.51\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" points=\"336.54,-392.67 339.6,-396.63\"/>\n",
       "</g>\n",
       "<!-- akt&#45;&gt;raf1 -->\n",
       "<g id=\"edge27\" class=\"edge\">\n",
       "<title>akt&#45;&gt;raf1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M390.08,-433.98C396.31,-423.76 403.72,-409.66 407,-396 412.38,-373.59 410.14,-347.12 407.33,-328.91\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"401.76,-325.79 411.63,-324.18 411.95,-326.15 402.08,-327.76 401.76,-325.79\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" points=\"406.53,-324 407.34,-328.93\"/>\n",
       "</g>\n",
       "<!-- cot -->\n",
       "<g id=\"node30\" class=\"node\">\n",
       "<title>cot</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"380\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"380\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">cot</text>\n",
       "</g>\n",
       "<!-- akt&#45;&gt;cot -->\n",
       "<g id=\"edge28\" class=\"edge\">\n",
       "<title>akt&#45;&gt;cot</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M380,-431.34C380,-423.82 380,-414.87 380,-406.52\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"383.5,-406.79 380,-396.79 376.5,-406.79 383.5,-406.79\"/>\n",
       "</g>\n",
       "<!-- cot&#45;&gt;ikk -->\n",
       "<g id=\"edge51\" class=\"edge\">\n",
       "<title>cot&#45;&gt;ikk</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M365.67,-366.97C349.37,-355.56 322.53,-336.77 303.23,-323.26\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"305.46,-320.55 295.26,-317.68 301.45,-326.29 305.46,-320.55\"/>\n",
       "</g>\n",
       "<!-- traf6 -->\n",
       "<g id=\"node31\" class=\"node\">\n",
       "<title>traf6</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"168\" cy=\"-594\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"168\" y=\"-588.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">traf6</text>\n",
       "</g>\n",
       "<!-- traf6&#45;&gt;map3k7 -->\n",
       "<g id=\"edge31\" class=\"edge\">\n",
       "<title>traf6&#45;&gt;map3k7</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M167.75,-575.59C167.41,-551.29 166.79,-506.97 166.38,-478.27\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"169.89,-478.44 166.25,-468.49 162.89,-478.54 169.89,-478.44\"/>\n",
       "</g>\n",
       "<!-- sitpec -->\n",
       "<g id=\"node32\" class=\"node\">\n",
       "<title>sitpec</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"272\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"272\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">sitpec</text>\n",
       "</g>\n",
       "<!-- traf6&#45;&gt;sitpec -->\n",
       "<g id=\"edge30\" class=\"edge\">\n",
       "<title>traf6&#45;&gt;sitpec</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M182.46,-583.27C199.67,-571.68 228.63,-552.19 248.94,-538.52\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"250.67,-541.57 257.01,-533.09 246.76,-535.77 250.67,-541.57\"/>\n",
       "</g>\n",
       "<!-- sitpec&#45;&gt;map3k1 -->\n",
       "<g id=\"edge39\" class=\"edge\">\n",
       "<title>sitpec&#45;&gt;map3k1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M272.99,-503.7C273.42,-496.18 273.93,-487.19 274.41,-478.78\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"277.9,-479.15 274.97,-468.97 270.91,-478.75 277.9,-479.15\"/>\n",
       "</g>\n",
       "<!-- il1r -->\n",
       "<g id=\"node33\" class=\"node\">\n",
       "<title>il1r</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"168\" cy=\"-666\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"168\" y=\"-660.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">il1r</text>\n",
       "</g>\n",
       "<!-- il1r&#45;&gt;traf6 -->\n",
       "<g id=\"edge32\" class=\"edge\">\n",
       "<title>il1r&#45;&gt;traf6</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M168,-647.7C168,-640.07 168,-630.92 168,-622.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"171.5,-622.48 168,-612.48 164.5,-622.48 171.5,-622.48\"/>\n",
       "</g>\n",
       "<!-- tgfa -->\n",
       "<g id=\"node34\" class=\"node\">\n",
       "<title>tgfa</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"342\" cy=\"-1098\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"342\" y=\"-1092.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">tgfa</text>\n",
       "</g>\n",
       "<!-- egfr -->\n",
       "<g id=\"node35\" class=\"node\">\n",
       "<title>egfr</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"342\" cy=\"-1026\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"342\" y=\"-1020.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">egfr</text>\n",
       "</g>\n",
       "<!-- tgfa&#45;&gt;egfr -->\n",
       "<g id=\"edge36\" class=\"edge\">\n",
       "<title>tgfa&#45;&gt;egfr</title>\n",
       "<path fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" d=\"M342,-1079.34C342,-1073.74 342,-1067.36 342,-1061.02\"/>\n",
       "<polygon fill=\"#104e8b\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"346.38,-1061.14 342,-1051.14 337.63,-1061.14 346.38,-1061.14\"/>\n",
       "</g>\n",
       "<!-- egfr&#45;&gt;pi3k -->\n",
       "<g id=\"edge47\" class=\"edge\">\n",
       "<title>egfr&#45;&gt;pi3k</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M349.33,-1008.76C360.37,-982.77 380,-929.96 380,-883 380,-883 380,-883 380,-809 380,-769.42 378.43,-723.65 377.25,-695.02\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"380.76,-695.15 376.84,-685.31 373.77,-695.45 380.76,-695.15\"/>\n",
       "</g>\n",
       "<!-- egfr&#45;&gt;grb2 -->\n",
       "<g id=\"edge46\" class=\"edge\">\n",
       "<title>egfr&#45;&gt;grb2</title>\n",
       "<path fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" d=\"M341,-1007.3C339.73,-984.77 337.51,-945.35 335.91,-916.94\"/>\n",
       "<polygon fill=\"#104e8b\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"340.29,-916.89 335.36,-907.15 331.55,-917.38 340.29,-916.89\"/>\n",
       "</g>\n",
       "<!-- egfr&#45;&gt;shc -->\n",
       "<g id=\"edge45\" class=\"edge\">\n",
       "<title>egfr&#45;&gt;shc</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M332.24,-1010.15C326.06,-1000.75 317.95,-988.4 310.96,-977.77\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"314.05,-976.1 305.63,-969.66 308.2,-979.94 314.05,-976.1\"/>\n",
       "</g>\n",
       "<!-- traf2 -->\n",
       "<g id=\"node36\" class=\"node\">\n",
       "<title>traf2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"218\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"218\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">traf2</text>\n",
       "</g>\n",
       "<!-- traf2&#45;&gt;map3k7 -->\n",
       "<g id=\"edge38\" class=\"edge\">\n",
       "<title>traf2&#45;&gt;map3k7</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M207.48,-506.83C200.36,-497.25 190.81,-484.39 182.66,-473.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"185.51,-471.39 176.73,-465.45 179.89,-475.56 185.51,-471.39\"/>\n",
       "</g>\n",
       "<!-- ask1 -->\n",
       "<g id=\"node37\" class=\"node\">\n",
       "<title>ask1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"220\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"220\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ask1</text>\n",
       "</g>\n",
       "<!-- traf2&#45;&gt;ask1 -->\n",
       "<g id=\"edge37\" class=\"edge\">\n",
       "<title>traf2&#45;&gt;ask1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M218.49,-503.7C218.71,-496.07 218.97,-486.92 219.22,-478.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"222.71,-478.58 219.5,-468.48 215.72,-478.38 222.71,-478.58\"/>\n",
       "</g>\n",
       "<!-- ask1&#45;&gt;mkk7 -->\n",
       "<g id=\"edge58\" class=\"edge\">\n",
       "<title>ask1&#45;&gt;mkk7</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M223.39,-432.05C224.97,-424.14 226.89,-414.54 228.66,-405.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"232.04,-406.65 230.57,-396.16 225.17,-405.28 232.04,-406.65\"/>\n",
       "</g>\n",
       "<!-- ask1&#45;&gt;mkk4 -->\n",
       "<g id=\"edge57\" class=\"edge\">\n",
       "<title>ask1&#45;&gt;mkk4</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M211.32,-433.81C206.18,-424.82 199.56,-413.23 193.73,-403.03\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"196.85,-401.43 188.85,-394.49 190.77,-404.91 196.85,-401.43\"/>\n",
       "</g>\n",
       "<!-- tnfr -->\n",
       "<g id=\"node38\" class=\"node\">\n",
       "<title>tnfr</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"230\" cy=\"-738\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"230\" y=\"-732.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">tnfr</text>\n",
       "</g>\n",
       "<!-- tnfr&#45;&gt;pi3k -->\n",
       "<g id=\"edge49\" class=\"edge\">\n",
       "<title>tnfr&#45;&gt;pi3k</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M246.18,-729.24C271.37,-717.16 320.18,-693.76 350.25,-679.35\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"351.45,-682.65 358.96,-675.17 348.42,-676.34 351.45,-682.65\"/>\n",
       "</g>\n",
       "<!-- tnfr&#45;&gt;traf2 -->\n",
       "<g id=\"edge48\" class=\"edge\">\n",
       "<title>tnfr&#45;&gt;traf2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M229.04,-719.85C226.96,-682.83 222.05,-595.18 219.54,-550.39\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"223.04,-550.4 218.99,-540.61 216.05,-550.79 223.04,-550.4\"/>\n",
       "</g>\n",
       "<!-- il1a -->\n",
       "<g id=\"node39\" class=\"node\">\n",
       "<title>il1a</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"168\" cy=\"-738\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"168\" y=\"-732.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">il1a</text>\n",
       "</g>\n",
       "<!-- il1a&#45;&gt;il1r -->\n",
       "<g id=\"edge50\" class=\"edge\">\n",
       "<title>il1a&#45;&gt;il1r</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M168,-719.7C168,-712.07 168,-702.92 168,-694.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"171.5,-694.48 168,-684.48 164.5,-694.48 171.5,-694.48\"/>\n",
       "</g>\n",
       "<!-- tnfa -->\n",
       "<g id=\"node40\" class=\"node\">\n",
       "<title>tnfa</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"230\" cy=\"-810\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"230\" y=\"-804.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">tnfa</text>\n",
       "</g>\n",
       "<!-- tnfa&#45;&gt;tnfr -->\n",
       "<g id=\"edge56\" class=\"edge\">\n",
       "<title>tnfa&#45;&gt;tnfr</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M230,-791.7C230,-784.07 230,-774.92 230,-766.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"233.5,-766.48 230,-756.48 226.5,-766.48 233.5,-766.48\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9d9bed30>"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G = cn.Graph.from_sif(\"PKN-LiverDREAM.sif.txt\")\n",
    "P = milp_carnival(\n",
    "    G, {\"igf1\": 1, \"tgfa\": -1}, {\"akt\": 1, \"p38\": 1, \"ikb\": -2}, beta_weight=0.01\n",
    ")\n",
    "P.solve(solver=\"SCIP\", verbosity=0)\n",
    "\n",
    "G.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(P),\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "a168f342",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.0"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "P.objectives[0].value"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7e0ac4a2",
   "metadata": {},
   "source": [
    "## Comparison"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "27c21832",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(4931, 13157)"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from corneto.methods.carnival import read_dataset\n",
    "\n",
    "G, dict_data = read_dataset(\"carnival_example.zip\")\n",
    "G.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "90e9fd4e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'EGFR': ('P', -1),\n",
       " 'AEBP1': ('M', -1),\n",
       " 'CREB3': ('M', 1),\n",
       " 'EGR3': ('M', -1),\n",
       " 'ELK1': ('M', -1),\n",
       " 'FOSL2': ('M', -1),\n",
       " 'FOXA3': ('M', 1),\n",
       " 'FOXE1': ('M', 1),\n",
       " 'HIPK2': ('M', 1),\n",
       " 'HOXA2': ('M', 1),\n",
       " 'HOXB7': ('M', -1),\n",
       " 'HOXD3': ('M', 1),\n",
       " 'KDM5C': ('M', -1),\n",
       " 'KDM5D': ('M', 1),\n",
       " 'KLF2': ('M', -1),\n",
       " 'NEUROD1': ('M', -1),\n",
       " 'NFATC4': ('M', -1),\n",
       " 'NFYB': ('M', -1),\n",
       " 'NHLH2': ('M', 1),\n",
       " 'PLAGL2': ('M', -1),\n",
       " 'RUNX2': ('M', -1),\n",
       " 'SIRT1': ('M', 1),\n",
       " 'SUPT20H': ('M', 1),\n",
       " 'TBX20': ('M', -1),\n",
       " 'TET1': ('M', 1),\n",
       " 'ZBTB4': ('M', -1)}"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dict_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "6656d207",
   "metadata": {},
   "outputs": [],
   "source": [
    "c_inputs = {k: v[1] for k, v in dict_data.items() if v[0] == \"P\"}\n",
    "c_outputs = {k: v[1] for k, v in dict_data.items() if v[0] == \"M\"}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "00210f1e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "({'EGFR': -1},\n",
       " {'AEBP1': -1,\n",
       "  'CREB3': 1,\n",
       "  'EGR3': -1,\n",
       "  'ELK1': -1,\n",
       "  'FOSL2': -1,\n",
       "  'FOXA3': 1,\n",
       "  'FOXE1': 1,\n",
       "  'HIPK2': 1,\n",
       "  'HOXA2': 1,\n",
       "  'HOXB7': -1,\n",
       "  'HOXD3': 1,\n",
       "  'KDM5C': -1,\n",
       "  'KDM5D': 1,\n",
       "  'KLF2': -1,\n",
       "  'NEUROD1': -1,\n",
       "  'NFATC4': -1,\n",
       "  'NFYB': -1,\n",
       "  'NHLH2': 1,\n",
       "  'PLAGL2': -1,\n",
       "  'RUNX2': -1,\n",
       "  'SIRT1': 1,\n",
       "  'SUPT20H': 1,\n",
       "  'TBX20': -1,\n",
       "  'TET1': 1,\n",
       "  'ZBTB4': -1})"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "c_inputs, c_outputs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "b51b1950",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1/1 inputs mapped to the graph\n",
      "16/25 outputs mapped to the graph\n",
      "Pruning the graph with size: V x E = (4931, 13157)...\n",
      "Finished. Final size: V x E = (1182, 5789).\n",
      "NEUROD1 (L4), HOXB7 (L4), HIPK2 (L3), ZBTB4 (L4), RUNX2 (L3), NFYB (L3), ELK1 (L3), NFATC4 (L3), SIRT1 (L3), AEBP1 (L3)\n",
      "L1  :      1 iters, 0.00 s.\n",
      "L2  :     41 iters, 0.00 s.\n",
      " > -EGFR -> +CRK -> +MAPK8 -> +SIRT1\n",
      " > -EGFR -> +CRK -> +MAPK8 -> -NFATC4\n",
      " > -EGFR -> -PTPN1 -> +ABL1 -> +HIPK2\n",
      " > -EGFR -> -PRKDC -> -MAPK8 -> -ELK1\n",
      "   ! conflict: -EGFR/-MAPK8 != -EGFR/+MAPK8\n",
      " > -EGFR -> -MAP2K1 -> -MAPK1 -> -ELK1\n",
      " > -EGFR -> -MAP2K1 -> -MAPK1 -> -AEBP1\n",
      " > -EGFR -> -MAP2K1 -> -MAPK3 -> -RUNX2\n",
      "L3  :    316 iters, 0.05 s.\n",
      " > -EGFR -> -STAT1 -> +CREBBP -> ... -> -NFYB\n",
      " > -EGFR -> -PIK3R1 -> -RAC1 -> ... -> -NEUROD1\n",
      " > -EGFR -> -PTPN1 -> +ABL1 -> ... -> -ZBTB4\n",
      " > -EGFR -> -ERBB2 -> +CDK1 -> ... -> -HOXB7\n",
      "Finished (0.48 s)\n",
      " > Number of selected edges: 26\n",
      " > Total iterations: 2287\n",
      " > Detected loops: 255\n",
      " > Conflicts: 1\n",
      "Total error: 15\n",
      "Number of selected edges: 26\n"
     ]
    }
   ],
   "source": [
    "from corneto.methods.carnival import heuristic_carnival\n",
    "\n",
    "Gc, selected_edges, paths, stats, errors = heuristic_carnival(\n",
    "    G, c_inputs, c_outputs, restricted_search=False\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "f1296fc5",
   "metadata": {},
   "outputs": [],
   "source": [
    "node_values = {}\n",
    "for p in paths:\n",
    "    for k, v in p[1].items():\n",
    "        node_values[k] = v[1]\n",
    "\n",
    "G_sol = Gc.edge_subgraph(selected_edges)\n",
    "\n",
    "V = G_sol.V\n",
    "vertex_values = [node_values.get(v, 0) for v in V]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "2d2e4a6b",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'STAT1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK8', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'ERBB2', graph '%3' size too small for label\n",
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'CREBBP', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'PIK3R1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK3', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'PTPN1', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'STAT1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK8', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'ERBB2', graph '%3' size too small for label\n",
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'CREBBP', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'PIK3R1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK3', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'PTPN1', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"476pt\" height=\"332pt\"\n",
       " viewBox=\"0.00 0.00 476.00 332.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 328)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-328 472,-328 472,4 -4,4\"/>\n",
       "<!-- EGFR -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>EGFR</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"261\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"261\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EGFR</text>\n",
       "</g>\n",
       "<!-- STAT1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>STAT1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"66\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"66\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">STAT1</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;STAT1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;STAT1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M243.68,-298.82C216.04,-288.95 160.25,-269.01 113,-252 106.88,-249.8 100.31,-247.42 94.08,-245.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"95.42,-241.94 84.83,-241.83 93.04,-248.52 95.42,-241.94\"/>\n",
       "</g>\n",
       "<!-- ERBB2 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>ERBB2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"140\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"140\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ERBB2</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;ERBB2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;ERBB2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M245.18,-295.85C224.98,-284.16 189.77,-263.79 165.69,-249.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"167.54,-246.89 157.13,-244.91 164.04,-252.95 167.54,-246.89\"/>\n",
       "</g>\n",
       "<!-- MAP2K1 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>MAP2K1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"234\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP2K1</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;MAP2K1 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;MAP2K1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M254.6,-288.41C251.58,-280.57 247.88,-270.99 244.47,-262.13\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"247.76,-260.95 240.9,-252.88 241.23,-263.47 247.76,-260.95\"/>\n",
       "</g>\n",
       "<!-- PIK3R1 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>PIK3R1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"288\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">PIK3R1</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;PIK3R1 -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;PIK3R1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M267.4,-288.41C270.42,-280.57 274.12,-270.99 277.53,-262.13\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"280.77,-263.47 281.1,-252.88 274.24,-260.95 280.77,-263.47\"/>\n",
       "</g>\n",
       "<!-- CRK -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>CRK</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"342\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"342\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CRK</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;CRK -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;CRK</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M274.74,-293.13C288.47,-281.26 309.63,-262.97 324.54,-250.09\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"324.17,-243.8 330.7,-251.37 329.19,-252.68 322.65,-245.11 324.17,-243.8\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"328.19,-246.93 324.41,-250.2\"/>\n",
       "</g>\n",
       "<!-- PTPN1 -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>PTPN1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"409\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"409\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">PTPN1</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;PTPN1 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;PTPN1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M277.69,-297.11C303.14,-285.07 351.89,-262.01 382.3,-247.63\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"383.69,-250.84 391.23,-243.41 380.69,-244.52 383.69,-250.84\"/>\n",
       "</g>\n",
       "<!-- CREBBP -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>CREBBP</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"32\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"32\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CREBBP</text>\n",
       "</g>\n",
       "<!-- STAT1&#45;&gt;CREBBP -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>STAT1&#45;&gt;CREBBP</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M58.11,-216.76C53.31,-206.87 47.12,-194.13 41.98,-183.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"35.78,-182.23 44.78,-177.86 45.65,-179.66 36.66,-184.03 35.78,-182.23\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"39.84,-179.15 42.03,-183.64\"/>\n",
       "</g>\n",
       "<!-- MAPK8 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>MAPK8</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"342\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"342\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK8</text>\n",
       "</g>\n",
       "<!-- SIRT1 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>SIRT1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"342\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"342\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">SIRT1</text>\n",
       "</g>\n",
       "<!-- MAPK8&#45;&gt;SIRT1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>MAPK8&#45;&gt;SIRT1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M342,-143.34C342,-136.34 342,-128.12 342,-120.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"345.5,-120.42 342,-110.42 338.5,-120.42 345.5,-120.42\"/>\n",
       "</g>\n",
       "<!-- NFATC4 -->\n",
       "<g id=\"node26\" class=\"node\">\n",
       "<title>NFATC4</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"396\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"396\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFATC4</text>\n",
       "</g>\n",
       "<!-- MAPK8&#45;&gt;NFATC4 -->\n",
       "<g id=\"edge23\" class=\"edge\">\n",
       "<title>MAPK8&#45;&gt;NFATC4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M352.93,-146.83C361.34,-135.92 373.04,-120.76 382.12,-108.99\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"380.52,-102.88 388.44,-108.99 387.22,-110.57 379.3,-104.47 380.52,-102.88\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"385.09,-105.14 382.03,-109.1\"/>\n",
       "</g>\n",
       "<!-- CDK1 -->\n",
       "<g id=\"node24\" class=\"node\">\n",
       "<title>CDK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"99\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"99\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CDK1</text>\n",
       "</g>\n",
       "<!-- ERBB2&#45;&gt;CDK1 -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>ERBB2&#45;&gt;CDK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M130.9,-217.46C124.9,-207.22 117,-193.72 110.55,-182.73\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"104.26,-181.88 112.89,-176.83 113.9,-178.55 105.28,-183.61 104.26,-181.88\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"108.07,-178.49 110.6,-182.81\"/>\n",
       "</g>\n",
       "<!-- MAPK1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>MAPK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"180\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK1</text>\n",
       "</g>\n",
       "<!-- MAP2K1&#45;&gt;MAPK1 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>MAP2K1&#45;&gt;MAPK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M223.07,-218.83C215.83,-209.44 206.15,-196.9 197.81,-186.08\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"200.72,-184.12 191.84,-178.34 195.17,-188.4 200.72,-184.12\"/>\n",
       "</g>\n",
       "<!-- MAPK3 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>MAPK3</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"234\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK3</text>\n",
       "</g>\n",
       "<!-- MAP2K1&#45;&gt;MAPK3 -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>MAP2K1&#45;&gt;MAPK3</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M234,-215.34C234,-208.34 234,-200.12 234,-192.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"237.5,-192.42 234,-182.42 230.5,-192.42 237.5,-192.42\"/>\n",
       "</g>\n",
       "<!-- ELK1 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>ELK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"126\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"126\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ELK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;ELK1 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;ELK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M169.07,-146.83C161.83,-137.44 152.15,-124.9 143.81,-114.08\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"146.72,-112.12 137.84,-106.34 141.17,-116.4 146.72,-112.12\"/>\n",
       "</g>\n",
       "<!-- AEBP1 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>AEBP1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"180\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">AEBP1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;AEBP1 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;AEBP1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M180,-143.34C180,-136.34 180,-128.12 180,-120.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"183.5,-120.42 180,-110.42 176.5,-120.42 183.5,-120.42\"/>\n",
       "</g>\n",
       "<!-- TP53 -->\n",
       "<g id=\"node22\" class=\"node\">\n",
       "<title>TP53</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">TP53</text>\n",
       "</g>\n",
       "<!-- CREBBP&#45;&gt;TP53 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>CREBBP&#45;&gt;TP53</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M28.47,-143.34C27.03,-136.15 25.33,-127.66 23.73,-119.64\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"27.17,-119.02 21.78,-109.9 20.31,-120.39 27.17,-119.02\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>CSNK2A1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CSNK2A1</text>\n",
       "</g>\n",
       "<!-- HOXB7 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>HOXB7</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"72\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HOXB7</text>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;HOXB7 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;HOXB7</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-71.34C72,-62.37 72,-51.37 72,-41.77\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67,-37.9 77,-37.9 77,-39.9 67,-39.9 67,-37.9\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"72,-36.9 72,-41.9\"/>\n",
       "</g>\n",
       "<!-- ABL1 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>ABL1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"436\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"436\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ABL1</text>\n",
       "</g>\n",
       "<!-- HIPK2 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>HIPK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"450\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"450\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HIPK2</text>\n",
       "</g>\n",
       "<!-- ABL1&#45;&gt;HIPK2 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>ABL1&#45;&gt;HIPK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M439.53,-143.34C440.97,-136.15 442.67,-127.66 444.27,-119.64\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"447.69,-120.39 446.22,-109.9 440.83,-119.02 447.69,-120.39\"/>\n",
       "</g>\n",
       "<!-- ZBTB4 -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>ZBTB4</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"450\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"450\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ZBTB4</text>\n",
       "</g>\n",
       "<!-- HIPK2&#45;&gt;ZBTB4 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>HIPK2&#45;&gt;ZBTB4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M450,-71.34C450,-62.37 450,-51.37 450,-41.77\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"445,-37.9 455,-37.9 455,-39.9 445,-39.9 445,-37.9\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"450,-36.9 450,-41.9\"/>\n",
       "</g>\n",
       "<!-- RAC1 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>RAC1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"288\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RAC1</text>\n",
       "</g>\n",
       "<!-- PIK3R1&#45;&gt;RAC1 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>PIK3R1&#45;&gt;RAC1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M288,-215.34C288,-208.34 288,-200.12 288,-192.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"291.5,-192.42 288,-182.42 284.5,-192.42 291.5,-192.42\"/>\n",
       "</g>\n",
       "<!-- MAP3K10 -->\n",
       "<g id=\"node25\" class=\"node\">\n",
       "<title>MAP3K10</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"288\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP3K10</text>\n",
       "</g>\n",
       "<!-- RAC1&#45;&gt;MAP3K10 -->\n",
       "<g id=\"edge22\" class=\"edge\">\n",
       "<title>RAC1&#45;&gt;MAP3K10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M288,-143.34C288,-136.34 288,-128.12 288,-120.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"291.5,-120.42 288,-110.42 284.5,-120.42 291.5,-120.42\"/>\n",
       "</g>\n",
       "<!-- RUNX2 -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>RUNX2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"234\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RUNX2</text>\n",
       "</g>\n",
       "<!-- MAPK3&#45;&gt;RUNX2 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>MAPK3&#45;&gt;RUNX2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M234,-143.34C234,-136.34 234,-128.12 234,-120.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"237.5,-120.42 234,-110.42 230.5,-120.42 237.5,-120.42\"/>\n",
       "</g>\n",
       "<!-- CRK&#45;&gt;MAPK8 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>CRK&#45;&gt;MAPK8</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M342,-215.34C342,-208.34 342,-200.12 342,-192.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"345.5,-192.42 342,-182.42 338.5,-192.42 345.5,-192.42\"/>\n",
       "</g>\n",
       "<!-- PTPN1&#45;&gt;ABL1 -->\n",
       "<g id=\"edge25\" class=\"edge\">\n",
       "<title>PTPN1&#45;&gt;ABL1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M415.4,-216.41C419.13,-206.73 423.88,-194.43 427.87,-184.08\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"424.62,-178.6 433.95,-182.2 433.23,-184.07 423.9,-180.47 424.62,-178.6\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"429.65,-179.47 427.85,-184.13\"/>\n",
       "</g>\n",
       "<!-- NFYB -->\n",
       "<g id=\"node23\" class=\"node\">\n",
       "<title>NFYB</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"18\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFYB</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;NFYB -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;NFYB</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-71.34C18,-62.37 18,-51.37 18,-41.77\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"13,-37.9 23,-37.9 23,-39.9 13,-39.9 13,-37.9\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"18,-36.9 18,-41.9\"/>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;CSNK2A1 -->\n",
       "<g id=\"edge26\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;CSNK2A1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M92.6,-144.41C89.58,-136.57 85.88,-126.99 82.47,-118.13\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"85.76,-116.95 78.9,-108.88 79.23,-119.47 85.76,-116.95\"/>\n",
       "</g>\n",
       "<!-- NEUROD1 -->\n",
       "<g id=\"node27\" class=\"node\">\n",
       "<title>NEUROD1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"288\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NEUROD1</text>\n",
       "</g>\n",
       "<!-- MAP3K10&#45;&gt;NEUROD1 -->\n",
       "<g id=\"edge24\" class=\"edge\">\n",
       "<title>MAP3K10&#45;&gt;NEUROD1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M288,-71.34C288,-64.34 288,-56.12 288,-48.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"291.5,-48.42 288,-38.42 284.5,-48.42 291.5,-48.42\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9e4a2790>"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_sol.plot_values(vertex_values=vertex_values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "df3b786d",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "c:\\Users\\pablo\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\corneto-N5Qo8YGQ-py3.9\\lib\\site-packages\\cvxpy\\problems\\problem.py:158: UserWarning: Objective contains too many subexpressions. Consider vectorizing your CVXPY code to speed up compilation.\n",
      "  warnings.warn(\"Objective contains too many subexpressions. \"\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "===============================================================================\n",
      "                                     CVXPY                                     \n",
      "                                     v1.5.3                                    \n",
      "===============================================================================\n",
      "(CVXPY) Aug 26 09:50:09 PM: Your problem has 15124 variables, 30250 constraints, and 0 parameters.\n",
      "(CVXPY) Aug 26 09:50:12 PM: It is compliant with the following grammars: DCP, DQCP\n",
      "(CVXPY) Aug 26 09:50:12 PM: (If you need to solve this problem multiple times, but with different data, consider using parameters.)\n",
      "(CVXPY) Aug 26 09:50:12 PM: CVXPY will first compile your problem; then, it will invoke a numerical solver to obtain a solution.\n",
      "(CVXPY) Aug 26 09:50:12 PM: Your problem is compiled with the CPP canonicalization backend.\n",
      "-------------------------------------------------------------------------------\n",
      "                                  Compilation                                  \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:50:15 PM: Compiling problem (target solver=GUROBI).\n",
      "(CVXPY) Aug 26 09:50:15 PM: Reduction chain: CvxAttr2Constr -> Qp2SymbolicQp -> QpMatrixStuffing -> GUROBI\n",
      "(CVXPY) Aug 26 09:50:15 PM: Applying reduction CvxAttr2Constr\n",
      "(CVXPY) Aug 26 09:50:15 PM: Applying reduction Qp2SymbolicQp\n",
      "(CVXPY) Aug 26 09:50:20 PM: Applying reduction QpMatrixStuffing\n",
      "(CVXPY) Aug 26 09:50:52 PM: Applying reduction GUROBI\n",
      "(CVXPY) Aug 26 09:50:52 PM: Finished problem compilation (took 4.001e+01 seconds).\n",
      "-------------------------------------------------------------------------------\n",
      "                                Numerical solver                               \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:50:52 PM: Invoking solver GUROBI  to obtain a solution.\n",
      "Set parameter QCPDual to value 1\n",
      "Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (win64 - Windows 11.0 (22631.2))\n",
      "\n",
      "CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "\n",
      "Optimize a model with 30250 rows, 15124 columns and 88140 nonzeros\n",
      "Model fingerprint: 0xb6fcef78\n",
      "Variable types: 1182 continuous, 13942 integer (13942 binary)\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e+00, 1e+03]\n",
      "  Objective range  [1e-02, 1e+00]\n",
      "  Bounds range     [1e+00, 1e+00]\n",
      "  RHS range        [1e+00, 1e+03]\n",
      "Found heuristic solution: objective 0.0000000\n",
      "Presolve removed 10948 rows and 1782 columns\n",
      "Presolve time: 0.35s\n",
      "Presolved: 19302 rows, 13342 columns, 71530 nonzeros\n",
      "Variable types: 1173 continuous, 12169 integer (12169 binary)\n",
      "\n",
      "Root relaxation: objective -9.808000e+00, 655 iterations, 0.05 seconds (0.05 work units)\n",
      "\n",
      "    Nodes    |    Current Node    |     Objective Bounds      |     Work\n",
      " Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time\n",
      "\n",
      "     0     0   -9.80800    0   26    0.00000   -9.80800      -     -    0s\n",
      "H    0     0                      -9.8000000   -9.80800  0.08%     -    0s\n",
      "     0     0   -9.80800    0   26   -9.80000   -9.80800  0.08%     -    0s\n",
      "\n",
      "Explored 1 nodes (1070 simplex iterations) in 0.65 seconds (0.46 work units)\n",
      "Thread count was 8 (of 8 available processors)\n",
      "\n",
      "Solution count 2: -9.8 0 \n",
      "No other solutions better than -9.8\n",
      "\n",
      "Optimal solution found (tolerance 1.00e-04)\n",
      "Best objective -9.800000000000e+00, best bound -9.800000000000e+00, gap 0.0000%\n",
      "-------------------------------------------------------------------------------\n",
      "                                    Summary                                    \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:50:53 PM: Problem status: optimal\n",
      "(CVXPY) Aug 26 09:50:53 PM: Optimal value: 2.000e-01\n",
      "(CVXPY) Aug 26 09:50:53 PM: Compilation took 4.001e+01 seconds\n",
      "(CVXPY) Aug 26 09:50:53 PM: Solver (including time spent in interface) took 8.843e-01 seconds\n"
     ]
    }
   ],
   "source": [
    "from corneto.methods.carnival import preprocess_graph\n",
    "\n",
    "Gp, cp_inputs, cp_outputs = preprocess_graph(G, c_inputs, c_outputs)\n",
    "P = milp_carnival(Gp, cp_inputs, cp_outputs, beta_weight=0.01)\n",
    "P.solve(solver=\"GUROBI\", verbosity=1);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "f8057e26",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.0"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "P.objectives[0].value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "998e6590",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1182, 5789)"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Gp.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "715d4ca7",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'CEBPB', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n",
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'CEBPB', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"395pt\" height=\"476pt\"\n",
       " viewBox=\"0.00 0.00 395.00 476.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 472)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-472 391,-472 391,4 -4,4\"/>\n",
       "<!-- MAP2K1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>MAP2K1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"268\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"268\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP2K1</text>\n",
       "</g>\n",
       "<!-- MAPK1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>MAPK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"214\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"214\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK1</text>\n",
       "</g>\n",
       "<!-- MAP2K1&#45;&gt;MAPK1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>MAP2K1&#45;&gt;MAPK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M257.33,-363.17C250.01,-353.68 240.12,-340.86 231.64,-329.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"234.45,-327.78 225.57,-322 228.91,-332.06 234.45,-327.78\"/>\n",
       "</g>\n",
       "<!-- CDK1 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>CDK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"99\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"99\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CDK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;CDK1 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;CDK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M198.68,-295.9C181.08,-285.41 151.36,-267.62 126,-252 123.46,-250.44 120.8,-248.78 118.17,-247.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"112.29,-249.35 117.61,-240.88 119.3,-241.94 113.99,-250.41 112.29,-249.35\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"114.1,-244.58 118.34,-247.24\"/>\n",
       "</g>\n",
       "<!-- AEBP1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>AEBP1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"153\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"153\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">AEBP1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;AEBP1 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;AEBP1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M202.53,-291.83C193.92,-281.96 181.95,-268.22 171.93,-256.73\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"174.63,-254.49 165.42,-249.25 169.35,-259.09 174.63,-254.49\"/>\n",
       "</g>\n",
       "<!-- ELK1 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>ELK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"207\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"207\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ELK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;ELK1 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;ELK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M212.27,-287.7C211.54,-280.41 210.67,-271.73 209.85,-263.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"213.34,-263.21 208.86,-253.61 206.37,-263.91 213.34,-263.21\"/>\n",
       "</g>\n",
       "<!-- NFATC4 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>NFATC4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"261\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"261\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFATC4</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;NFATC4 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;NFATC4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M223.74,-290.5C229.85,-281.39 237.88,-269.43 244.92,-258.95\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"247.76,-261 250.43,-250.74 241.95,-257.09 247.76,-261\"/>\n",
       "</g>\n",
       "<!-- CEBPB -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>CEBPB</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"315\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"315\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CEBPB</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;CEBPB -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;CEBPB</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M228.47,-294.97C244.82,-283.64 271.68,-265.02 291.15,-251.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"293.09,-254.45 299.31,-245.87 289.1,-248.69 293.09,-254.45\"/>\n",
       "</g>\n",
       "<!-- TP53 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>TP53</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">TP53</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;TP53 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;TP53</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M85.62,-221.44C73.2,-210.7 54.46,-194.51 39.86,-181.89\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"42.4,-179.46 32.54,-175.57 37.82,-184.75 42.4,-179.46\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>CSNK2A1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CSNK2A1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;CSNK2A1 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;CSNK2A1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M92.74,-216.76C89.64,-208.72 85.81,-198.81 82.3,-189.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"85.64,-188.63 78.77,-180.56 79.11,-191.15 85.64,-188.63\"/>\n",
       "</g>\n",
       "<!-- ABL1 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>ABL1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"126\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"126\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ABL1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;ABL1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;ABL1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M105.26,-216.76C108.36,-208.72 112.19,-198.81 115.7,-189.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"118.89,-191.15 119.23,-180.56 112.36,-188.63 118.89,-191.15\"/>\n",
       "</g>\n",
       "<!-- SIRT1 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>SIRT1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"180\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">SIRT1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;SIRT1 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;SIRT1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M112.38,-221.44C124.8,-210.7 143.54,-194.51 158.14,-181.89\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"160.18,-184.75 165.46,-175.57 155.6,-179.46 160.18,-184.75\"/>\n",
       "</g>\n",
       "<!-- NFYB -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>NFYB</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFYB</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;NFYB -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;NFYB</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-143.7C18,-134.37 18,-122.77 18,-112.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"13,-109.1 23,-109.1 23,-111.1 13,-111.1 13,-109.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"18,-108.1 18,-113.1\"/>\n",
       "</g>\n",
       "<!-- EGFR -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>EGFR</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"295\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"295\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EGFR</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;MAP2K1 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;MAP2K1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M288.74,-432.76C285.64,-424.72 281.81,-414.81 278.3,-405.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"281.64,-404.63 274.77,-396.56 275.11,-407.15 281.64,-404.63\"/>\n",
       "</g>\n",
       "<!-- VAV2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>VAV2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"349\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"349\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">VAV2</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;VAV2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;VAV2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M305.67,-435.17C312.99,-425.68 322.88,-412.86 331.36,-401.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"334.09,-404.06 337.43,-394 328.55,-399.78 334.09,-404.06\"/>\n",
       "</g>\n",
       "<!-- RAC1 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>RAC1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"362\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"362\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RAC1</text>\n",
       "</g>\n",
       "<!-- VAV2&#45;&gt;RAC1 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>VAV2&#45;&gt;RAC1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M352.15,-360.05C353.55,-352.49 355.25,-343.37 356.83,-334.85\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360.22,-335.75 358.61,-325.28 353.34,-334.47 360.22,-335.75\"/>\n",
       "</g>\n",
       "<!-- HOXB7 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>HOXB7</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HOXB7</text>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;HOXB7 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;HOXB7</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-143.7C72,-134.37 72,-122.77 72,-112.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67,-109.1 77,-109.1 77,-111.1 67,-111.1 67,-109.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"72,-108.1 72,-113.1\"/>\n",
       "</g>\n",
       "<!-- HIPK2 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>HIPK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"126\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"126\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HIPK2</text>\n",
       "</g>\n",
       "<!-- ABL1&#45;&gt;HIPK2 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>ABL1&#45;&gt;HIPK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M126,-143.7C126,-136.41 126,-127.73 126,-119.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"129.5,-119.62 126,-109.62 122.5,-119.62 129.5,-119.62\"/>\n",
       "</g>\n",
       "<!-- ZBTB4 -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>ZBTB4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"126\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"126\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ZBTB4</text>\n",
       "</g>\n",
       "<!-- HIPK2&#45;&gt;ZBTB4 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>HIPK2&#45;&gt;ZBTB4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M126,-71.7C126,-62.37 126,-50.77 126,-40.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"121,-37.1 131,-37.1 131,-39.1 121,-39.1 121,-37.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"126,-36.1 126,-41.1\"/>\n",
       "</g>\n",
       "<!-- MAP3K10 -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>MAP3K10</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"369\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"369\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP3K10</text>\n",
       "</g>\n",
       "<!-- RAC1&#45;&gt;MAP3K10 -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>RAC1&#45;&gt;MAP3K10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M363.73,-287.7C364.46,-280.41 365.33,-271.73 366.15,-263.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"369.63,-263.91 367.14,-253.61 362.66,-263.21 369.63,-263.91\"/>\n",
       "</g>\n",
       "<!-- RUNX2 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>RUNX2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"315\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"315\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RUNX2</text>\n",
       "</g>\n",
       "<!-- CEBPB&#45;&gt;RUNX2 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>CEBPB&#45;&gt;RUNX2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M315,-215.7C315,-208.41 315,-199.73 315,-191.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"318.5,-191.62 315,-181.62 311.5,-191.62 318.5,-191.62\"/>\n",
       "</g>\n",
       "<!-- NEUROD1 -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>NEUROD1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"369\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"369\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NEUROD1</text>\n",
       "</g>\n",
       "<!-- MAP3K10&#45;&gt;NEUROD1 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>MAP3K10&#45;&gt;NEUROD1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M369,-215.7C369,-208.41 369,-199.73 369,-191.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"372.5,-191.62 369,-181.62 365.5,-191.62 372.5,-191.62\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25cc0d39a00>"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np\n",
    "\n",
    "Gsol = Gp.edge_subgraph(np.flatnonzero(np.abs(P.expr.edge_values.value) > 0))\n",
    "Gsol.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "7cb74746",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(CORNETO) Aug 26 09:50:54 PM - INFO    : 1/1 inputs mapped to the graph\n",
      "(CORNETO) Aug 26 09:50:54 PM - INFO    : 10/10 outputs mapped to the graph\n",
      "(CORNETO) Aug 26 09:50:54 PM - INFO    : Pruning the graph with size: V x E = (4931, 13157)...\n",
      "(CORNETO) Aug 26 09:50:55 PM - INFO    : Finished. Final size: V x E = (1182, 5789).\n",
      "(CORNETO) Aug 26 09:50:55 PM - INFO    : 1/1 inputs after pruning.\n",
      "(CORNETO) Aug 26 09:50:55 PM - INFO    : 10/10 outputs after pruning.\n",
      "(CORNETO) Aug 26 09:50:55 PM - INFO    : Converting into a flow graph...\n",
      "(CORNETO) Aug 26 09:50:55 PM - INFO    : Creating a network flow problem...\n",
      "(CORNETO) Aug 26 09:50:56 PM - INFO    : Preprocess completed.\n",
      "===============================================================================\n",
      "                                     CVXPY                                     \n",
      "                                     v1.5.3                                    \n",
      "===============================================================================\n",
      "(CVXPY) Aug 26 09:50:56 PM: Your problem has 26774 variables, 65161 constraints, and 0 parameters.\n",
      "(CVXPY) Aug 26 09:50:56 PM: It is compliant with the following grammars: DCP, DQCP\n",
      "(CVXPY) Aug 26 09:50:56 PM: (If you need to solve this problem multiple times, but with different data, consider using parameters.)\n",
      "(CVXPY) Aug 26 09:50:56 PM: CVXPY will first compile your problem; then, it will invoke a numerical solver to obtain a solution.\n",
      "(CVXPY) Aug 26 09:50:56 PM: Your problem is compiled with the CPP canonicalization backend.\n",
      "-------------------------------------------------------------------------------\n",
      "                                  Compilation                                  \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:50:56 PM: Compiling problem (target solver=GUROBI).\n",
      "(CVXPY) Aug 26 09:50:56 PM: Reduction chain: CvxAttr2Constr -> Qp2SymbolicQp -> QpMatrixStuffing -> GUROBI\n",
      "(CVXPY) Aug 26 09:50:56 PM: Applying reduction CvxAttr2Constr\n",
      "(CVXPY) Aug 26 09:50:56 PM: Applying reduction Qp2SymbolicQp\n",
      "(CVXPY) Aug 26 09:50:56 PM: Applying reduction QpMatrixStuffing\n",
      "(CVXPY) Aug 26 09:50:56 PM: Applying reduction GUROBI\n",
      "(CVXPY) Aug 26 09:50:56 PM: Finished problem compilation (took 1.425e-01 seconds).\n",
      "-------------------------------------------------------------------------------\n",
      "                                Numerical solver                               \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:50:56 PM: Invoking solver GUROBI  to obtain a solution.\n",
      "Set parameter QCPDual to value 1\n",
      "Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (win64 - Windows 11.0 (22631.2))\n",
      "\n",
      "CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "\n",
      "Optimize a model with 65161 rows, 26774 columns and 152235 nonzeros\n",
      "Model fingerprint: 0x443b7235\n",
      "Variable types: 6990 continuous, 19784 integer (19784 binary)\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e-03, 1e+03]\n",
      "  Objective range  [1e-02, 1e+00]\n",
      "  Bounds range     [1e+00, 1e+00]\n",
      "  RHS range        [1e-03, 1e+03]\n",
      "Presolve removed 28859 rows and 2262 columns\n",
      "Presolve time: 0.53s\n",
      "Presolved: 36302 rows, 24512 columns, 108510 nonzeros\n",
      "Variable types: 6593 continuous, 17919 integer (17919 binary)\n",
      "Deterministic concurrent LP optimizer: primal and dual simplex\n",
      "Showing primal log only...\n",
      "\n",
      "Concurrent spin time: 0.03s\n",
      "\n",
      "Solved with dual simplex\n",
      "Extra simplex iterations after uncrush: 4\n",
      "\n",
      "Root relaxation: objective -1.078800e+01, 952 iterations, 0.30 seconds (0.14 work units)\n",
      "\n",
      "    Nodes    |    Current Node    |     Objective Bounds      |     Work\n",
      " Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time\n",
      "\n",
      "     0     0  -10.78800    0   38          -  -10.78800      -     -    1s\n",
      "H    0     0                      -0.9700000  -10.78800  1012%     -    2s\n",
      "H    0     0                      -1.9300000  -10.78800   459%     -    2s\n",
      "H    0     0                      -9.8100000  -10.78800  10.0%     -    2s\n",
      "     0     0  -10.78000    0   39   -9.81000  -10.78000  9.89%     -    2s\n",
      "H    0     0                     -10.7600000  -10.78000  0.19%     -    3s\n",
      "     0     0  -10.78000    0   43  -10.76000  -10.78000  0.19%     -    3s\n",
      "     0     0  -10.78000    0   76  -10.76000  -10.78000  0.19%     -    4s\n",
      "     0     0  -10.78000    0   69  -10.76000  -10.78000  0.19%     -    4s\n",
      "H    0     0                     -10.7700000  -10.78000  0.09%     -    5s\n",
      "     0     0  -10.78000    0    2  -10.77000  -10.78000  0.09%     -    5s\n",
      "     0     0  -10.78000    0   18  -10.77000  -10.78000  0.09%     -    5s\n",
      "     0     0  -10.78000    0   19  -10.77000  -10.78000  0.09%     -    6s\n",
      "     0     0  -10.78000    0   20  -10.77000  -10.78000  0.09%     -    6s\n",
      "     0     0  -10.78000    0   14  -10.77000  -10.78000  0.09%     -    7s\n",
      "     0     0  -10.78000    0   16  -10.77000  -10.78000  0.09%     -    7s\n",
      "     0     0  -10.78000    0   11  -10.77000  -10.78000  0.09%     -    7s\n",
      "     0     0  -10.78000    0   17  -10.77000  -10.78000  0.09%     -    7s\n",
      "     0     0  -10.78000    0    2  -10.77000  -10.78000  0.09%     -    7s\n",
      "     0     0  -10.78000    0    4  -10.77000  -10.78000  0.09%     -    8s\n",
      "     0     0  -10.78000    0    4  -10.77000  -10.78000  0.09%     -    8s\n",
      "     0     0  -10.78000    0    4  -10.77000  -10.78000  0.09%     -    8s\n",
      "     0     0  -10.78000    0    4  -10.77000  -10.78000  0.09%     -    8s\n",
      "     0     0  -10.78000    0    4  -10.77000  -10.78000  0.09%     -    8s\n",
      "     0     2  -10.78000    0    4  -10.77000  -10.78000  0.09%     -    8s\n",
      "\n",
      "Cutting planes:\n",
      "  Gomory: 2\n",
      "  Cover: 1\n",
      "  Implied bound: 7\n",
      "  MIR: 1\n",
      "\n",
      "Explored 84 nodes (14713 simplex iterations) in 9.52 seconds (3.53 work units)\n",
      "Thread count was 8 (of 8 available processors)\n",
      "\n",
      "Solution count 5: -10.77 -10.76 -9.81 ... -0.97\n",
      "No other solutions better than -10.77\n",
      "\n",
      "Optimal solution found (tolerance 1.00e-04)\n",
      "Best objective -1.077000000000e+01, best bound -1.077000000000e+01, gap 0.0000%\n",
      "-------------------------------------------------------------------------------\n",
      "                                    Summary                                    \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:51:06 PM: Problem status: optimal\n",
      "(CVXPY) Aug 26 09:51:06 PM: Optimal value: 2.300e-01\n",
      "(CVXPY) Aug 26 09:51:06 PM: Compilation took 1.425e-01 seconds\n",
      "(CVXPY) Aug 26 09:51:06 PM: Solver (including time spent in interface) took 9.985e+00 seconds\n",
      "(CORNETO) Aug 26 09:51:06 PM - INFO    : Finished in 12.03 s.\n"
     ]
    }
   ],
   "source": [
    "P, Gf = runVanillaCarnival(cp_inputs, cp_outputs, G, betaWeight=0.01, solver=\"GUROBI\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "a862b9a4",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'SH3RF1', graph '%3' size too small for label\n",
      "Warning: node '_pert_c0', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node '_meas_c0', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK3', graph '%3' size too small for label\n",
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'SH3RF1', graph '%3' size too small for label\n",
      "Warning: node '_pert_c0', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node '_meas_c0', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK3', graph '%3' size too small for label\n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"440pt\" height=\"876pt\"\n",
       " viewBox=\"0.00 0.00 440.00 875.60\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 871.6)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-871.6 436,-871.6 436,4 -4,4\"/>\n",
       "<!-- MAP2K1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>MAP2K1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"351\" cy=\"-594\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"351\" y=\"-588.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP2K1</text>\n",
       "</g>\n",
       "<!-- MAPK1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>MAPK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"324\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"324\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK1</text>\n",
       "</g>\n",
       "<!-- MAP2K1&#45;&gt;MAPK1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>MAP2K1&#45;&gt;MAPK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M344.74,-576.76C341.64,-568.72 337.81,-558.81 334.3,-549.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"337.64,-548.63 330.77,-540.56 331.11,-551.15 337.64,-548.63\"/>\n",
       "</g>\n",
       "<!-- MAPK3 -->\n",
       "<g id=\"node25\" class=\"node\">\n",
       "<title>MAPK3</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"396\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"396\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK3</text>\n",
       "</g>\n",
       "<!-- MAP2K1&#45;&gt;MAPK3 -->\n",
       "<g id=\"edge28\" class=\"edge\">\n",
       "<title>MAP2K1&#45;&gt;MAPK3</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M360.54,-578.15C366.27,-569.25 373.7,-557.69 380.27,-547.46\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"383.19,-549.4 385.65,-539.1 377.3,-545.62 383.19,-549.4\"/>\n",
       "</g>\n",
       "<!-- CDK1 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>CDK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"139\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"139\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CDK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;CDK1 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;CDK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M307.26,-514.66C273.5,-501.89 197.32,-473.07 160.17,-459.01\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"155.01,-462.4 158.54,-453.05 160.41,-453.76 156.88,-463.11 155.01,-462.4\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"155.84,-457.37 160.52,-459.14\"/>\n",
       "</g>\n",
       "<!-- AEBP1 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>AEBP1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"294\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"294\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">AEBP1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;AEBP1 -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;AEBP1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M316.85,-505.19C305.84,-479.35 286,-426.21 286,-379 286,-379 286,-379 286,-233 286,-193.46 289.13,-147.83 291.47,-119.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"294.94,-119.8 292.29,-109.54 287.96,-119.21 294.94,-119.8\"/>\n",
       "</g>\n",
       "<!-- ELK1 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>ELK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"332\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"332\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ELK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;ELK1 -->\n",
       "<g id=\"edge24\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;ELK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M324,-503.51C324,-476.71 324,-423.87 324,-379 324,-379 324,-379 324,-305 324,-265.46 327.13,-219.83 329.47,-191.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"332.94,-191.8 330.29,-181.54 325.96,-191.21 332.94,-191.8\"/>\n",
       "</g>\n",
       "<!-- NFATC4 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>NFATC4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"370\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"370\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFATC4</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;NFATC4 -->\n",
       "<g id=\"edge26\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;NFATC4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M328.94,-504.41C331.89,-494.02 335.54,-480.32 338,-468 352.6,-394.99 362.64,-307.77 367.2,-263.63\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"370.67,-264.17 368.19,-253.87 363.7,-263.47 370.67,-264.17\"/>\n",
       "</g>\n",
       "<!-- AKT1 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>AKT1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"110\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"110\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">AKT1</text>\n",
       "</g>\n",
       "<!-- SH3RF1 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>SH3RF1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"110\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"110\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">SH3RF1</text>\n",
       "</g>\n",
       "<!-- AKT1&#45;&gt;SH3RF1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>AKT1&#45;&gt;SH3RF1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M110,-287.7C110,-278.37 110,-266.77 110,-256.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"105,-253.1 115,-253.1 115,-255.1 105,-255.1 105,-253.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"110,-252.1 110,-257.1\"/>\n",
       "</g>\n",
       "<!-- MAP3K10 -->\n",
       "<g id=\"node22\" class=\"node\">\n",
       "<title>MAP3K10</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"110\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"110\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP3K10</text>\n",
       "</g>\n",
       "<!-- SH3RF1&#45;&gt;MAP3K10 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>SH3RF1&#45;&gt;MAP3K10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M110,-215.7C110,-208.41 110,-199.73 110,-191.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"113.5,-191.62 110,-181.62 106.5,-191.62 113.5,-191.62\"/>\n",
       "</g>\n",
       "<!-- TP53 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>TP53</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"20\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"20\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">TP53</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;TP53 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;TP53</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M123.93,-440.13C104.1,-428.47 68.97,-407.81 45.1,-393.76\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"47.02,-390.84 36.63,-388.78 43.47,-396.87 47.02,-390.84\"/>\n",
       "</g>\n",
       "<!-- SIRT1 -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>SIRT1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"81\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"81\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">SIRT1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;SIRT1 -->\n",
       "<g id=\"edge31\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;SIRT1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M127.82,-435.5C119.79,-425.82 108.8,-412.55 99.48,-401.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"102.19,-399.09 93.11,-393.62 96.8,-403.55 102.19,-399.09\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1 -->\n",
       "<g id=\"node23\" class=\"node\">\n",
       "<title>CSNK2A1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"139\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"139\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CSNK2A1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;CSNK2A1 -->\n",
       "<g id=\"edge33\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;CSNK2A1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M139,-431.7C139,-424.41 139,-415.73 139,-407.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"142.5,-407.62 139,-397.62 135.5,-407.62 142.5,-407.62\"/>\n",
       "</g>\n",
       "<!-- ABL1 -->\n",
       "<g id=\"node24\" class=\"node\">\n",
       "<title>ABL1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"195\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"195\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ABL1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;ABL1 -->\n",
       "<g id=\"edge22\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;ABL1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M149.8,-435.5C157.54,-425.82 168.16,-412.55 177.16,-401.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"179.78,-403.63 183.29,-393.64 174.31,-399.26 179.78,-403.63\"/>\n",
       "</g>\n",
       "<!-- NFYB -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>NFYB</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFYB</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;NFYB -->\n",
       "<g id=\"edge29\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;NFYB</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M19.51,-359.7C19.24,-350.37 18.91,-338.77 18.62,-328.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"13.52,-325.25 23.52,-324.96 23.57,-326.96 13.58,-327.25 13.52,-325.25\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"18.49,-324.1 18.63,-329.1\"/>\n",
       "</g>\n",
       "<!-- _s -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>_s</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"351\" cy=\"-810\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"351\" y=\"-804.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">_s</text>\n",
       "</g>\n",
       "<!-- _pert_c0 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>_pert_c0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"351\" cy=\"-738\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"351\" y=\"-732.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">_pert_c0</text>\n",
       "</g>\n",
       "<!-- _s&#45;&gt;_pert_c0 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>_s&#45;&gt;_pert_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M351,-791.7C351,-784.41 351,-775.73 351,-767.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"354.5,-767.62 351,-757.62 347.5,-767.62 354.5,-767.62\"/>\n",
       "</g>\n",
       "<!-- EGFR -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>EGFR</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"351\" cy=\"-666\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"351\" y=\"-660.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EGFR</text>\n",
       "</g>\n",
       "<!-- _pert_c0&#45;&gt;EGFR -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>_pert_c0&#45;&gt;EGFR</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M351,-719.7C351,-710.37 351,-698.77 351,-688.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"346,-685.1 356,-685.1 356,-687.1 346,-687.1 346,-685.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"351,-684.1 351,-689.1\"/>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;MAP2K1 -->\n",
       "<g id=\"edge27\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;MAP2K1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M351,-647.7C351,-640.41 351,-631.73 351,-623.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"354.5,-623.62 351,-613.62 347.5,-623.62 354.5,-623.62\"/>\n",
       "</g>\n",
       "<!-- _meas_c0 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>_meas_c0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"217\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"217\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">_meas_c0</text>\n",
       "</g>\n",
       "<!-- AEBP1&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>AEBP1&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M280.94,-77.13C267.88,-65.26 247.77,-46.97 233.59,-34.09\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"227.5,-35.31 234.23,-27.91 235.71,-29.25 228.98,-36.65 227.5,-35.31\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"230.13,-30.93 233.83,-34.3\"/>\n",
       "</g>\n",
       "<!-- ELK1&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>ELK1&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M334.35,-143.93C336.06,-124.68 335.92,-93.29 321,-72 301.7,-44.46 263.73,-30.36 239.39,-23.84\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"234.44,-27.73 236.93,-18.04 238.87,-18.54 236.38,-28.22 234.44,-27.73\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"234.72,-22.63 239.56,-23.88\"/>\n",
       "</g>\n",
       "<!-- HIPK2 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>HIPK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"210\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"210\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HIPK2</text>\n",
       "</g>\n",
       "<!-- HIPK2&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>HIPK2&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M210.37,-143.6C210.81,-125.65 211.64,-96.85 213,-72 213.43,-64.05 214.03,-55.43 214.63,-47.5\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"218.11,-47.93 215.4,-37.68 211.13,-47.38 218.11,-47.93\"/>\n",
       "</g>\n",
       "<!-- ZBTB4 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>ZBTB4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"240\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"240\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ZBTB4</text>\n",
       "</g>\n",
       "<!-- HIPK2&#45;&gt;ZBTB4 -->\n",
       "<g id=\"edge30\" class=\"edge\">\n",
       "<title>HIPK2&#45;&gt;ZBTB4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M216.81,-145.12C221.1,-135.09 226.69,-122.05 231.31,-111.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"228.23,-105.77 237.42,-109.71 236.63,-111.55 227.44,-107.61 228.23,-105.77\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"233.22,-106.82 231.25,-111.42\"/>\n",
       "</g>\n",
       "<!-- HOXB7 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>HOXB7</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"164\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"164\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HOXB7</text>\n",
       "</g>\n",
       "<!-- HOXB7&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>HOXB7&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M165.18,-287.95C167.4,-258.42 172.93,-195.95 183,-144 190.18,-106.95 202.56,-64.76 210.23,-40.09\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"206.63,-34.86 216.18,-37.84 215.58,-39.75 206.03,-36.77 206.63,-34.86\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"211.7,-35.4 210.21,-40.17\"/>\n",
       "</g>\n",
       "<!-- NEUROD1 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>NEUROD1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"110\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"110\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NEUROD1</text>\n",
       "</g>\n",
       "<!-- NEUROD1&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>NEUROD1&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M124.88,-79.27C144.04,-66.73 177.37,-44.93 198.25,-31.27\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"198.67,-25.01 204.15,-33.38 202.48,-34.48 197,-26.11 198.67,-25.01\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"202.25,-28.65 198.06,-31.39\"/>\n",
       "</g>\n",
       "<!-- NFATC4&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>NFATC4&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M372.21,-215.65C375.31,-183.38 377.13,-113.63 342,-72 315.71,-40.83 267.87,-27.59 239.61,-22.27\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"235.01,-26.53 236.78,-16.68 238.75,-17.04 236.98,-26.88 235.01,-26.53\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"234.91,-21.43 239.83,-22.31\"/>\n",
       "</g>\n",
       "<!-- NFYB&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>NFYB&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M14.78,-287.95C7.88,-245.84 -3.66,-135.71 50,-72 86.29,-28.92 157.46,-20.43 194.06,-19.03\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"197.62,-13.92 197.94,-23.91 195.94,-23.98 195.62,-13.98 197.62,-13.92\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"198.78,-18.88 193.78,-19.04\"/>\n",
       "</g>\n",
       "<!-- RUNX2 -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>RUNX2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"414\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"414\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RUNX2</text>\n",
       "</g>\n",
       "<!-- RUNX2&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>RUNX2&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M414.4,-431.51C414.99,-404.71 416,-351.87 416,-307 416,-307 416,-307 416,-161 416,-115.41 399.95,-101.27 365,-72 327.86,-40.9 271.07,-27.44 239.74,-22.12\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"235.11,-26.43 236.73,-16.56 238.7,-16.88 237.08,-26.75 235.11,-26.43\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"234.93,-21.33 239.87,-22.14\"/>\n",
       "</g>\n",
       "<!-- SIRT1&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>SIRT1&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M77.64,-360.03C72.69,-333.48 64,-280.44 64,-235 64,-235 64,-235 64,-161 64,-120.55 56.87,-102.88 83,-72 109.53,-40.64 157.16,-27.7 187.9,-22.46\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"188.31,-25.94 197.67,-20.98 187.26,-19.02 188.31,-25.94\"/>\n",
       "</g>\n",
       "<!-- ZBTB4&#45;&gt;_meas_c0 -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>ZBTB4&#45;&gt;_meas_c0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M234.55,-72.41C231.37,-62.73 227.33,-50.43 223.92,-40.08\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"217.97,-37.98 227.47,-34.86 228.1,-36.76 218.6,-39.88 217.97,-37.98\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"222.41,-35.47 223.97,-40.22\"/>\n",
       "</g>\n",
       "<!-- e_16_source -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>e_16_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"351\" cy=\"-865.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_16_source&#45;&gt;_s -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>e_16_source&#45;&gt;_s</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M351,-863.87C351,-860.77 351,-850.44 351,-839.72\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"354.5,-839.77 351,-829.77 347.5,-839.77 354.5,-839.77\"/>\n",
       "</g>\n",
       "<!-- MAP3K10&#45;&gt;NEUROD1 -->\n",
       "<g id=\"edge32\" class=\"edge\">\n",
       "<title>MAP3K10&#45;&gt;NEUROD1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M110,-143.7C110,-136.41 110,-127.73 110,-119.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"113.5,-119.62 110,-109.62 106.5,-119.62 113.5,-119.62\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;AKT1 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;AKT1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M132.42,-361.12C129.01,-352.88 124.75,-342.61 120.87,-333.24\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"124.19,-332.12 117.13,-324.22 117.73,-334.8 124.19,-332.12\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;HOXB7 -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;HOXB7</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M144.8,-360.76C148.3,-350.96 152.8,-338.36 156.56,-327.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"153.19,-322.41 162.61,-325.77 161.93,-327.65 152.52,-324.29 153.19,-322.41\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"158.23,-323.15 156.55,-327.86\"/>\n",
       "</g>\n",
       "<!-- ABL1&#45;&gt;HIPK2 -->\n",
       "<g id=\"edge23\" class=\"edge\">\n",
       "<title>ABL1&#45;&gt;HIPK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M196.2,-359.85C198.77,-323.14 204.84,-236.66 208,-191.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"211.48,-191.96 208.69,-181.74 204.5,-191.47 211.48,-191.96\"/>\n",
       "</g>\n",
       "<!-- MAPK3&#45;&gt;RUNX2 -->\n",
       "<g id=\"edge25\" class=\"edge\">\n",
       "<title>MAPK3&#45;&gt;RUNX2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M400.36,-504.05C402.3,-496.49 404.65,-487.37 406.84,-478.85\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"410.21,-479.81 409.31,-469.25 403.43,-478.07 410.21,-479.81\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9e4ba6a0>"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Gf.edge_subgraph(np.flatnonzero(np.abs(P.expr.edge_values_c0.value) > 0)).plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "4c543e1b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.])"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "P.objectives[0].value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "9a2e7da5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "===============================================================================\n",
      "                                     CVXPY                                     \n",
      "                                     v1.5.3                                    \n",
      "===============================================================================\n",
      "(CVXPY) Aug 26 09:51:09 PM: Your problem has 33728 variables, 89468 constraints, and 0 parameters.\n",
      "(CVXPY) Aug 26 09:51:09 PM: It is compliant with the following grammars: DCP, DQCP\n",
      "(CVXPY) Aug 26 09:51:09 PM: (If you need to solve this problem multiple times, but with different data, consider using parameters.)\n",
      "(CVXPY) Aug 26 09:51:09 PM: CVXPY will first compile your problem; then, it will invoke a numerical solver to obtain a solution.\n",
      "(CVXPY) Aug 26 09:51:09 PM: Your problem is compiled with the CPP canonicalization backend.\n",
      "-------------------------------------------------------------------------------\n",
      "                                  Compilation                                  \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:51:09 PM: Compiling problem (target solver=GUROBI).\n",
      "(CVXPY) Aug 26 09:51:09 PM: Reduction chain: CvxAttr2Constr -> Qp2SymbolicQp -> QpMatrixStuffing -> GUROBI\n",
      "(CVXPY) Aug 26 09:51:09 PM: Applying reduction CvxAttr2Constr\n",
      "(CVXPY) Aug 26 09:51:09 PM: Applying reduction Qp2SymbolicQp\n",
      "(CVXPY) Aug 26 09:51:10 PM: Applying reduction QpMatrixStuffing\n",
      "(CVXPY) Aug 26 09:51:31 PM: Applying reduction GUROBI\n",
      "(CVXPY) Aug 26 09:51:31 PM: Finished problem compilation (took 2.138e+01 seconds).\n",
      "-------------------------------------------------------------------------------\n",
      "                                Numerical solver                               \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:51:31 PM: Invoking solver GUROBI  to obtain a solution.\n",
      "Set parameter QCPDual to value 1\n",
      "Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (win64 - Windows 11.0 (22631.2))\n",
      "\n",
      "CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "\n",
      "Optimize a model with 89468 rows, 33728 columns and 426597 nonzeros\n",
      "Model fingerprint: 0x526c36bd\n",
      "Variable types: 10528 continuous, 23200 integer (23200 binary)\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e+00, 1e+03]\n",
      "  Objective range  [1e-02, 1e+00]\n",
      "  Bounds range     [1e+00, 1e+00]\n",
      "  RHS range        [1e+00, 1e+03]\n",
      "Presolve removed 32415 rows and 3552 columns\n",
      "Presolve time: 1.34s\n",
      "Presolved: 57053 rows, 30176 columns, 326601 nonzeros\n",
      "Variable types: 7745 continuous, 22431 integer (22404 binary)\n",
      "Found heuristic solution: objective 21.2500000\n",
      "\n",
      "Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)\n",
      "Showing primal log only...\n",
      "\n",
      "Root relaxation presolved: 57013 rows, 30148 columns, 326394 nonzeros\n",
      "\n",
      "Concurrent spin time: 0.03s\n",
      "\n",
      "Solved with dual simplex\n",
      "\n",
      "Root relaxation: objective 4.040000e-01, 995 iterations, 0.77 seconds (0.27 work units)\n",
      "\n",
      "    Nodes    |    Current Node    |     Objective Bounds      |     Work\n",
      " Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time\n",
      "\n",
      "     0     0    0.40400    0   38   21.25000    0.40400  98.1%     -    3s\n",
      "H    0     0                       0.4300000    0.40400  6.05%     -    3s\n",
      "H    0     0                       0.4200000    0.40400  3.81%     -    4s\n",
      "     0     0     cutoff    0         0.42000    0.42000  0.00%     -    4s\n",
      "\n",
      "Cutting planes:\n",
      "  Gomory: 2\n",
      "  MIR: 3\n",
      "\n",
      "Explored 1 nodes (2458 simplex iterations) in 4.49 seconds (2.22 work units)\n",
      "Thread count was 8 (of 8 available processors)\n",
      "\n",
      "Solution count 3: 0.42 0.43 21.25 \n",
      "\n",
      "Optimal solution found (tolerance 1.00e-04)\n",
      "Best objective 4.200000000000e-01, best bound 4.200000000000e-01, gap 0.0000%\n",
      "-------------------------------------------------------------------------------\n",
      "                                    Summary                                    \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:51:37 PM: Problem status: optimal\n",
      "(CVXPY) Aug 26 09:51:37 PM: Optimal value: 4.200e-01\n",
      "(CVXPY) Aug 26 09:51:37 PM: Compilation took 2.138e+01 seconds\n",
      "(CVXPY) Aug 26 09:51:37 PM: Solver (including time spent in interface) took 5.305e+00 seconds\n"
     ]
    }
   ],
   "source": [
    "from corneto.methods import (\n",
    "    expand_graph_for_flows,\n",
    "    runCARNIVAL_AcyclicFlow,\n",
    "    runCARNIVAL_Flow_Acyclic,\n",
    "    runCARNIVAL_Flow_Acyclic_Signal,\n",
    ")\n",
    "\n",
    "Gp, cp_inputs, cp_outputs = preprocess_graph(G, c_inputs, c_outputs)\n",
    "exp_list = {\"c0\": {\"input\": cp_inputs, \"output\": cp_outputs}}\n",
    "exp_list[\"c1\"] = exp_list[\"c0\"]\n",
    "G2 = expand_graph_for_flows(Gp, exp_list)\n",
    "\n",
    "# Flow + Acyclic Signal\n",
    "P_cross = runCARNIVAL_Flow_Acyclic_Signal(\n",
    "    G2, exp_list, solver=\"GUROBI\", verbosity=True, betaWeight=0.01\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "ae591269",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning: node 'PIK3CA', graph '%3' size too small for label\n",
      "Warning: node 'DUSP5', graph '%3' size too small for label\n",
      "Warning: node 'MAPK3', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'CASP6', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n",
      "Warning: node 'PIK3CA', graph '%3' size too small for label\n",
      "Warning: node 'DUSP5', graph '%3' size too small for label\n",
      "Warning: node 'MAPK3', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'CASP6', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"445pt\" height=\"404pt\"\n",
       " viewBox=\"0.00 0.00 445.00 404.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 400)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-400 441,-400 441,4 -4,4\"/>\n",
       "<!-- PIK3CA -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>PIK3CA</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">PIK3CA</text>\n",
       "</g>\n",
       "<!-- RAC1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>RAC1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RAC1</text>\n",
       "</g>\n",
       "<!-- PIK3CA&#45;&gt;RAC1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>PIK3CA&#45;&gt;RAC1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M12.2,-360.76C11.33,-352.99 11.06,-343.46 11.39,-334.6\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"14.87,-334.88 12.1,-324.66 7.89,-334.38 14.87,-334.88\"/>\n",
       "</g>\n",
       "<!-- RAC1&#45;&gt;PIK3CA -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>RAC1&#45;&gt;PIK3CA</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M23.79,-323.15C24.67,-330.91 24.94,-340.43 24.62,-349.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.13,-349.03 23.91,-359.25 28.11,-349.53 21.13,-349.03\"/>\n",
       "</g>\n",
       "<!-- MAP3K10 -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>MAP3K10</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP3K10</text>\n",
       "</g>\n",
       "<!-- RAC1&#45;&gt;MAP3K10 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>RAC1&#45;&gt;MAP3K10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-287.7C18,-280.41 18,-271.73 18,-263.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-263.62 18,-253.62 14.5,-263.62 21.5,-263.62\"/>\n",
       "</g>\n",
       "<!-- TP53 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>TP53</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"288\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">TP53</text>\n",
       "</g>\n",
       "<!-- DUSP5 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>DUSP5</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"199\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"199\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">DUSP5</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;DUSP5 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;DUSP5</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M274.09,-366.06C260.12,-355.07 238.34,-337.94 221.82,-324.95\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"224.02,-322.23 214,-318.8 219.69,-327.73 224.02,-322.23\"/>\n",
       "</g>\n",
       "<!-- CASP6 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>CASP6</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"365\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"365\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CASP6</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;CASP6 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;CASP6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M301.06,-365.13C312.68,-354.57 329.88,-338.92 343.52,-326.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"345.71,-329.27 350.75,-319.95 341,-324.09 345.71,-329.27\"/>\n",
       "</g>\n",
       "<!-- NFYB -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>NFYB</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"311\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"311\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFYB</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;NFYB -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;NFYB</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M293.45,-360.41C296.63,-350.73 300.67,-338.43 304.08,-328.08\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"300.53,-322.86 310.03,-325.98 309.4,-327.88 299.9,-324.76 300.53,-322.86\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"305.59,-323.47 304.03,-328.22\"/>\n",
       "</g>\n",
       "<!-- MAPK3 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>MAPK3</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"99\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"99\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK3</text>\n",
       "</g>\n",
       "<!-- DUSP5&#45;&gt;MAPK3 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>DUSP5&#45;&gt;MAPK3</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M184.67,-294.97C166.95,-282.57 136.76,-261.43 117.36,-247.85\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"111.58,-249.91 117.31,-241.72 118.95,-242.86 113.22,-251.05 111.58,-249.91\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"113.63,-245.24 117.72,-248.11\"/>\n",
       "</g>\n",
       "<!-- MAPK1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>MAPK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"199\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"199\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK1</text>\n",
       "</g>\n",
       "<!-- DUSP5&#45;&gt;MAPK1 -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>DUSP5&#45;&gt;MAPK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M199,-287.7C199,-278.37 199,-266.77 199,-256.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"194,-253.1 204,-253.1 204,-255.1 194,-255.1 194,-253.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"199,-252.1 199,-257.1\"/>\n",
       "</g>\n",
       "<!-- RUNX2 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>RUNX2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RUNX2</text>\n",
       "</g>\n",
       "<!-- MAPK3&#45;&gt;RUNX2 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>MAPK3&#45;&gt;RUNX2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M92.74,-216.76C89.64,-208.72 85.81,-198.81 82.3,-189.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"85.64,-188.63 78.77,-180.56 79.11,-191.15 85.64,-188.63\"/>\n",
       "</g>\n",
       "<!-- CDK1 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>CDK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"288\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CDK1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;TP53 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;TP53</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M286.86,-180.4C285.07,-209.93 282.03,-271.75 284,-324 284.3,-331.96 284.85,-340.58 285.45,-348.51\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"281.95,-348.64 286.25,-358.32 288.93,-348.07 281.95,-348.64\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>CSNK2A1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"261\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"261\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CSNK2A1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;CSNK2A1 -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;CSNK2A1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M281.74,-144.76C278.64,-136.72 274.81,-126.81 271.3,-117.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"274.64,-116.63 267.77,-108.56 268.11,-119.15 274.64,-116.63\"/>\n",
       "</g>\n",
       "<!-- SIRT1 -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>SIRT1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"315\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"315\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">SIRT1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;SIRT1 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;SIRT1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M294.26,-144.76C297.36,-136.72 301.19,-126.81 304.7,-117.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"307.89,-119.15 308.23,-108.56 301.36,-116.63 307.89,-119.15\"/>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;CDK1 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;CDK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M212.91,-222.06C228.45,-209.84 253.65,-190.02 270.52,-176.75\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"270.31,-170.55 276.5,-178.41 274.92,-179.65 268.74,-171.79 270.31,-170.55\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"274.19,-173.86 270.26,-176.95\"/>\n",
       "</g>\n",
       "<!-- AEBP1 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>AEBP1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"126\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"126\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">AEBP1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;AEBP1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;AEBP1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M186.28,-220.81C175.4,-210.37 159.51,-195.13 146.78,-182.93\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"149.3,-180.5 139.66,-176.1 144.46,-185.55 149.3,-180.5\"/>\n",
       "</g>\n",
       "<!-- ELK1 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>ELK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"180\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ELK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;ELK1 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;ELK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M194.5,-216.41C192.39,-208.65 189.83,-199.21 187.44,-190.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"190.86,-189.66 184.87,-180.93 184.11,-191.5 190.86,-189.66\"/>\n",
       "</g>\n",
       "<!-- NFATC4 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>NFATC4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"234\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFATC4</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;NFATC4 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;NFATC4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M206.77,-217.46C210.98,-209.04 216.3,-198.4 221.12,-188.77\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"224.24,-190.36 225.58,-179.85 217.97,-187.22 224.24,-190.36\"/>\n",
       "</g>\n",
       "<!-- e_6_source -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_6_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"419\" cy=\"-378\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- EGFR -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>EGFR</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"419\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"419\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EGFR</text>\n",
       "</g>\n",
       "<!-- e_6_source&#45;&gt;EGFR -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>e_6_source&#45;&gt;EGFR</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M419,-375.79C419,-370.89 419,-352.06 419,-335.34\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"422.5,-335.81 419,-325.81 415.5,-335.81 422.5,-335.81\"/>\n",
       "</g>\n",
       "<!-- HIPK2 -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>HIPK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"365\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"365\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HIPK2</text>\n",
       "</g>\n",
       "<!-- CASP6&#45;&gt;HIPK2 -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>CASP6&#45;&gt;HIPK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M365,-287.7C365,-280.41 365,-271.73 365,-263.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"368.5,-263.62 365,-253.62 361.5,-263.62 368.5,-263.62\"/>\n",
       "</g>\n",
       "<!-- HOXB7 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>HOXB7</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"261\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"261\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HOXB7</text>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;HOXB7 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;HOXB7</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M261,-71.7C261,-62.37 261,-50.77 261,-40.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"256,-37.1 266,-37.1 266,-39.1 256,-39.1 256,-37.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"261,-36.1 261,-41.1\"/>\n",
       "</g>\n",
       "<!-- ZBTB4 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>ZBTB4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"365\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"365\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ZBTB4</text>\n",
       "</g>\n",
       "<!-- HIPK2&#45;&gt;ZBTB4 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>HIPK2&#45;&gt;ZBTB4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M365,-215.7C365,-206.37 365,-194.77 365,-184.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"360,-181.1 370,-181.1 370,-183.1 360,-183.1 360,-181.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"365,-180.1 365,-185.1\"/>\n",
       "</g>\n",
       "<!-- NEUROD1 -->\n",
       "<g id=\"node22\" class=\"node\">\n",
       "<title>NEUROD1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NEUROD1</text>\n",
       "</g>\n",
       "<!-- MAP3K10&#45;&gt;NEUROD1 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>MAP3K10&#45;&gt;NEUROD1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-215.7C18,-208.41 18,-199.73 18,-191.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-191.62 18,-181.62 14.5,-191.62 21.5,-191.62\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9e4bd340>"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G2.edge_subgraph(np.flatnonzero(np.abs(P_cross.expr.edge_value.value[:, 1]) > 0)).plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "53b92d4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# G2.edge_subgraph(np.flatnonzero(np.abs(P_cross.expr.flow.value) >= 1e-6)).plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "df84f79b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "===============================================================================\n",
      "                                     CVXPY                                     \n",
      "                                     v1.5.3                                    \n",
      "===============================================================================\n",
      "(CVXPY) Aug 26 09:51:40 PM: Your problem has 44146 variables, 98726 constraints, and 0 parameters.\n",
      "(CVXPY) Aug 26 09:51:40 PM: It is compliant with the following grammars: DCP, DQCP\n",
      "(CVXPY) Aug 26 09:51:40 PM: (If you need to solve this problem multiple times, but with different data, consider using parameters.)\n",
      "(CVXPY) Aug 26 09:51:40 PM: CVXPY will first compile your problem; then, it will invoke a numerical solver to obtain a solution.\n",
      "(CVXPY) Aug 26 09:51:40 PM: Your problem is compiled with the CPP canonicalization backend.\n",
      "-------------------------------------------------------------------------------\n",
      "                                  Compilation                                  \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:51:40 PM: Compiling problem (target solver=GUROBI).\n",
      "(CVXPY) Aug 26 09:51:40 PM: Reduction chain: CvxAttr2Constr -> Qp2SymbolicQp -> QpMatrixStuffing -> GUROBI\n",
      "(CVXPY) Aug 26 09:51:40 PM: Applying reduction CvxAttr2Constr\n",
      "(CVXPY) Aug 26 09:51:40 PM: Applying reduction Qp2SymbolicQp\n",
      "(CVXPY) Aug 26 09:51:41 PM: Applying reduction QpMatrixStuffing\n",
      "(CVXPY) Aug 26 09:52:01 PM: Applying reduction GUROBI\n",
      "(CVXPY) Aug 26 09:52:01 PM: Finished problem compilation (took 2.129e+01 seconds).\n",
      "-------------------------------------------------------------------------------\n",
      "                                Numerical solver                               \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:52:01 PM: Invoking solver GUROBI  to obtain a solution.\n",
      "Set parameter QCPDual to value 1\n",
      "Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (win64 - Windows 11.0 (22631.2))\n",
      "\n",
      "CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "\n",
      "Optimize a model with 98726 rows, 44146 columns and 441710 nonzeros\n",
      "Model fingerprint: 0x724789c8\n",
      "Variable types: 9346 continuous, 34800 integer (34800 binary)\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e-04, 1e+03]\n",
      "  Objective range  [1e-02, 1e+00]\n",
      "  Bounds range     [1e+00, 1e+00]\n",
      "  RHS range        [1e+00, 1e+03]\n",
      "Presolve removed 46687 rows and 9337 columns\n",
      "Presolve time: 1.22s\n",
      "Presolved: 52039 rows, 34809 columns, 310941 nonzeros\n",
      "Variable types: 6591 continuous, 28218 integer (28198 binary)\n",
      "Deterministic concurrent LP optimizer: primal and dual simplex\n",
      "Showing primal log only...\n",
      "\n",
      "Concurrent spin time: 0.00s\n",
      "\n",
      "Solved with dual simplex\n",
      "Extra simplex iterations after uncrush: 4\n",
      "\n",
      "Root relaxation: objective 4.040000e-01, 5095 iterations, 2.32 seconds (1.06 work units)\n",
      "Total elapsed time = 5.64s (DegenMoves)\n",
      "\n",
      "    Nodes    |    Current Node    |     Objective Bounds      |     Work\n",
      " Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time\n",
      "\n",
      "     0     0    0.40400    0   78          -    0.40400      -     -    6s\n",
      "H    0     0                      94.0400000    0.40400   100%     -    8s\n",
      "     0     0    0.42000    0   98   94.04000    0.42000   100%     -    9s\n",
      "H    0     0                      20.0200000    0.42000  97.9%     -   10s\n",
      "H    0     0                       0.4400000    0.42000  4.55%     -   12s\n",
      "     0     0    0.42000    0   95    0.44000    0.42000  4.55%     -   12s\n",
      "     0     0    0.42000    0   56    0.44000    0.42000  4.55%     -   12s\n",
      "     0     0    0.42000    0   53    0.44000    0.42000  4.55%     -   16s\n",
      "     0     0    0.42000    0   33    0.44000    0.42000  4.55%     -   16s\n",
      "     0     0    0.42000    0   36    0.44000    0.42000  4.55%     -   16s\n",
      "     0     0    0.42000    0   35    0.44000    0.42000  4.55%     -   17s\n",
      "     0     0    0.42000    0   34    0.44000    0.42000  4.55%     -   17s\n",
      "     0     0    0.42000    0   22    0.44000    0.42000  4.55%     -   19s\n",
      "     0     0    0.42000    0    4    0.44000    0.42000  4.55%     -   20s\n",
      "H    0     0                       0.4200000    0.42000  0.00%     -   20s\n",
      "     0     0    0.42000    0    4    0.42000    0.42000  0.00%     -   20s\n",
      "\n",
      "Cutting planes:\n",
      "  Learned: 1\n",
      "  Gomory: 4\n",
      "  Cover: 2\n",
      "  Implied bound: 7\n",
      "  MIR: 4\n",
      "  Flow cover: 10\n",
      "  Zero half: 2\n",
      "  RLT: 5\n",
      "  PSD: 2\n",
      "\n",
      "Explored 1 nodes (51188 simplex iterations) in 21.04 seconds (10.44 work units)\n",
      "Thread count was 8 (of 8 available processors)\n",
      "\n",
      "Solution count 4: 0.42 0.44 20.02 94.04 \n",
      "\n",
      "Optimal solution found (tolerance 1.00e-04)\n",
      "Best objective 4.200000000000e-01, best bound 4.200000000000e-01, gap 0.0000%\n",
      "-------------------------------------------------------------------------------\n",
      "                                    Summary                                    \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:52:24 PM: Problem status: optimal\n",
      "(CVXPY) Aug 26 09:52:24 PM: Optimal value: 4.200e-01\n",
      "(CVXPY) Aug 26 09:52:24 PM: Compilation took 2.129e+01 seconds\n",
      "(CVXPY) Aug 26 09:52:24 PM: Solver (including time spent in interface) took 2.194e+01 seconds\n"
     ]
    }
   ],
   "source": [
    "# AcyclicFlow\n",
    "\n",
    "Gp, cp_inputs, cp_outputs = preprocess_graph(G, c_inputs, c_outputs)\n",
    "exp_list = {\"c0\": {\"input\": cp_inputs, \"output\": cp_outputs}}\n",
    "exp_list[\"c1\"] = exp_list[\"c0\"]\n",
    "G2 = expand_graph_for_flows(Gp, exp_list)\n",
    "P_cross = runCARNIVAL_AcyclicFlow(\n",
    "    G2, exp_list, solver=\"GUROBI\", verbosity=True, betaWeight=0.01\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "d19a076c",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'EP300', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'CASP6', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n",
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'EP300', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'CASP6', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"314pt\" height=\"660pt\"\n",
       " viewBox=\"0.00 0.00 314.00 659.60\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 655.6)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-655.6 310,-655.6 310,4 -4,4\"/>\n",
       "<!-- MAP2K1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>MAP2K1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"180\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP2K1</text>\n",
       "</g>\n",
       "<!-- MAPK1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>MAPK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"180\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK1</text>\n",
       "</g>\n",
       "<!-- MAP2K1&#45;&gt;MAPK1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>MAP2K1&#45;&gt;MAPK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M180,-503.7C180,-496.41 180,-487.73 180,-479.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"183.5,-479.62 180,-469.62 176.5,-479.62 183.5,-479.62\"/>\n",
       "</g>\n",
       "<!-- AEBP1 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>AEBP1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">AEBP1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;AEBP1 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;AEBP1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M164.98,-439.27C147.25,-427.77 117.51,-408.5 96.44,-394.84\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"98.45,-391.98 88.16,-389.47 94.65,-397.85 98.45,-391.98\"/>\n",
       "</g>\n",
       "<!-- CDK1 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>CDK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"126\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"126\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CDK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;CDK1 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;CDK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M169.33,-435.17C160.83,-424.14 148.86,-408.63 139.65,-396.7\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"133.3,-396.65 141.22,-390.54 142.44,-392.12 134.52,-398.23 133.3,-396.65\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"136.65,-392.8 139.7,-396.76\"/>\n",
       "</g>\n",
       "<!-- ELK1 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>ELK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"180\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ELK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;ELK1 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;ELK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M180,-431.7C180,-424.41 180,-415.73 180,-407.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"183.5,-407.62 180,-397.62 176.5,-407.62 183.5,-407.62\"/>\n",
       "</g>\n",
       "<!-- NFATC4 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>NFATC4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"234\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFATC4</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;NFATC4 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;NFATC4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M190.67,-435.17C197.99,-425.68 207.88,-412.86 216.36,-401.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"219.09,-404.06 222.43,-394 213.55,-399.78 219.09,-404.06\"/>\n",
       "</g>\n",
       "<!-- EP300 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>EP300</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"153\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"153\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EP300</text>\n",
       "</g>\n",
       "<!-- RUNX2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>RUNX2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"153\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"153\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RUNX2</text>\n",
       "</g>\n",
       "<!-- EP300&#45;&gt;RUNX2 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>EP300&#45;&gt;RUNX2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M153,-215.7C153,-208.41 153,-199.73 153,-191.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"156.5,-191.62 153,-181.62 149.5,-191.62 156.5,-191.62\"/>\n",
       "</g>\n",
       "<!-- e_3_source -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>e_3_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"207\" cy=\"-649.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- EGFR -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>EGFR</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"207\" cy=\"-594\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"207\" y=\"-588.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EGFR</text>\n",
       "</g>\n",
       "<!-- e_3_source&#45;&gt;EGFR -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>e_3_source&#45;&gt;EGFR</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M207,-647.87C207,-644.77 207,-634.44 207,-623.72\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"210.5,-623.77 207,-613.77 203.5,-623.77 210.5,-623.77\"/>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;MAP2K1 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;MAP2K1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M200.74,-576.76C197.64,-568.72 193.81,-558.81 190.3,-549.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"193.64,-548.63 186.77,-540.56 187.11,-551.15 193.64,-548.63\"/>\n",
       "</g>\n",
       "<!-- PTK2 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>PTK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"248\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"248\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">PTK2</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;PTK2 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;PTK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M215.9,-577.81C221,-569.1 227.54,-557.94 233.38,-547.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"236.32,-549.86 238.36,-539.47 230.28,-546.33 236.32,-549.86\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>CSNK2A1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"99\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"99\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CSNK2A1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;CSNK2A1 -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;CSNK2A1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M119.74,-360.76C116.64,-352.72 112.81,-342.81 109.3,-333.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"112.64,-332.63 105.77,-324.56 106.11,-335.15 112.64,-332.63\"/>\n",
       "</g>\n",
       "<!-- SIRT1 -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>SIRT1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"153\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"153\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">SIRT1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;SIRT1 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;SIRT1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M132.26,-360.76C135.36,-352.72 139.19,-342.81 142.7,-333.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"145.89,-335.15 146.23,-324.56 139.36,-332.63 145.89,-335.15\"/>\n",
       "</g>\n",
       "<!-- RAC1 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>RAC1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"261\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"261\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RAC1</text>\n",
       "</g>\n",
       "<!-- PTK2&#45;&gt;RAC1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>PTK2&#45;&gt;RAC1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M251.15,-504.05C252.55,-496.49 254.25,-487.37 255.83,-478.85\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"259.22,-479.75 257.61,-469.28 252.34,-478.47 259.22,-479.75\"/>\n",
       "</g>\n",
       "<!-- MAP3K10 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>MAP3K10</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"288\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP3K10</text>\n",
       "</g>\n",
       "<!-- RAC1&#45;&gt;MAP3K10 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>RAC1&#45;&gt;MAP3K10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M267.26,-432.76C270.36,-424.72 274.19,-414.81 277.7,-405.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"280.89,-407.15 281.23,-396.56 274.36,-404.63 280.89,-407.15\"/>\n",
       "</g>\n",
       "<!-- TP53 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>TP53</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"45\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"45\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">TP53</text>\n",
       "</g>\n",
       "<!-- CASP6 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>CASP6</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CASP6</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;CASP6 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;CASP6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M38.74,-216.76C35.64,-208.72 31.81,-198.81 28.3,-189.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"31.64,-188.63 24.77,-180.56 25.11,-191.15 31.64,-188.63\"/>\n",
       "</g>\n",
       "<!-- NFYB -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>NFYB</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFYB</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;NFYB -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;NFYB</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M51.26,-216.76C55.08,-206.87 59.99,-194.13 64.08,-183.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"60.75,-178.28 70.08,-181.88 69.36,-183.75 60.03,-180.15 60.75,-178.28\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"65.77,-179.15 63.97,-183.81\"/>\n",
       "</g>\n",
       "<!-- HIPK2 -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>HIPK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HIPK2</text>\n",
       "</g>\n",
       "<!-- CASP6&#45;&gt;HIPK2 -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>CASP6&#45;&gt;HIPK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-143.7C18,-136.41 18,-127.73 18,-119.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-119.62 18,-109.62 14.5,-119.62 21.5,-119.62\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;TP53 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;TP53</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M88.33,-291.17C81.01,-281.68 71.12,-268.86 62.64,-257.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"65.45,-255.78 56.57,-250 59.91,-260.06 65.45,-255.78\"/>\n",
       "</g>\n",
       "<!-- HOXB7 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>HOXB7</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"99\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"99\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HOXB7</text>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;HOXB7 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;HOXB7</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M99,-287.7C99,-278.37 99,-266.77 99,-256.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"94,-253.1 104,-253.1 104,-255.1 94,-255.1 94,-253.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"99,-252.1 99,-257.1\"/>\n",
       "</g>\n",
       "<!-- ZBTB4 -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>ZBTB4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ZBTB4</text>\n",
       "</g>\n",
       "<!-- HIPK2&#45;&gt;ZBTB4 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>HIPK2&#45;&gt;ZBTB4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-71.7C18,-62.37 18,-50.77 18,-40.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"13,-37.1 23,-37.1 23,-39.1 13,-39.1 13,-37.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"18,-36.1 18,-41.1\"/>\n",
       "</g>\n",
       "<!-- SIRT1&#45;&gt;EP300 -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>SIRT1&#45;&gt;EP300</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M153,-287.7C153,-278.37 153,-266.77 153,-256.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"148,-253.1 158,-253.1 158,-255.1 148,-255.1 148,-253.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"153,-252.1 153,-257.1\"/>\n",
       "</g>\n",
       "<!-- NEUROD1 -->\n",
       "<g id=\"node22\" class=\"node\">\n",
       "<title>NEUROD1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"288\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NEUROD1</text>\n",
       "</g>\n",
       "<!-- MAP3K10&#45;&gt;NEUROD1 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>MAP3K10&#45;&gt;NEUROD1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M288,-359.7C288,-352.41 288,-343.73 288,-335.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"291.5,-335.62 288,-325.62 284.5,-335.62 291.5,-335.62\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25cd28b3a00>"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G2.edge_subgraph(np.flatnonzero(np.abs(P_cross.expr.edge_value.value[:, 0]) > 0)).plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "33a461ce",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'EP300', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'CASP6', graph '%3' size too small for label\n",
      "Warning: node 'CDC42', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'EP300', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'CASP6', graph '%3' size too small for label\n",
      "Warning: node 'CDC42', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"362pt\" height=\"699pt\"\n",
       " viewBox=\"0.00 0.00 362.00 699.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 695.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-695.2 358,-695.2 358,4 -4,4\"/>\n",
       "<!-- MAP2K1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>MAP2K1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"179\" cy=\"-561.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"179\" y=\"-556.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP2K1</text>\n",
       "</g>\n",
       "<!-- MAPK1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>MAPK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"163\" cy=\"-489.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"163\" y=\"-484.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK1</text>\n",
       "</g>\n",
       "<!-- MAP2K1&#45;&gt;MAPK1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>MAP2K1&#45;&gt;MAPK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M175.13,-543.65C173.4,-536.09 171.31,-526.97 169.36,-518.45\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"172.82,-517.83 167.17,-508.86 165.99,-519.39 172.82,-517.83\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>CSNK2A1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"176\" cy=\"-345.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"176\" y=\"-340.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CSNK2A1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;CSNK2A1 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;CSNK2A1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M164.59,-471.19C166.79,-447.21 170.77,-403.74 173.4,-375.02\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"176.87,-375.5 174.3,-365.22 169.9,-374.86 176.87,-375.5\"/>\n",
       "</g>\n",
       "<!-- ELK1 -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>ELK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"218\" cy=\"-417.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"218\" y=\"-412.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ELK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;ELK1 -->\n",
       "<g id=\"edge24\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;ELK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M173.87,-474.77C181.4,-465.18 191.6,-452.2 200.3,-441.13\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"202.8,-443.62 206.22,-433.59 197.29,-439.29 202.8,-443.62\"/>\n",
       "</g>\n",
       "<!-- NFATC4 -->\n",
       "<g id=\"node22\" class=\"node\">\n",
       "<title>NFATC4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-417.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-412.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFATC4</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;NFATC4 -->\n",
       "<g id=\"edge25\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;NFATC4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M146.23,-481.94C123.03,-472.53 80.03,-454.38 45,-435.6 44.25,-435.2 43.49,-434.78 42.73,-434.36\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"44.6,-431.4 34.22,-429.29 41.02,-437.41 44.6,-431.4\"/>\n",
       "</g>\n",
       "<!-- AEBP1 -->\n",
       "<g id=\"node24\" class=\"node\">\n",
       "<title>AEBP1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-417.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-412.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">AEBP1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;AEBP1 -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;AEBP1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M149.18,-477.97C134.75,-466.87 111.88,-449.27 94.77,-436.12\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"97.21,-433.58 87.15,-430.25 92.94,-439.13 97.21,-433.58\"/>\n",
       "</g>\n",
       "<!-- CDK1 -->\n",
       "<g id=\"node26\" class=\"node\">\n",
       "<title>CDK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"126\" cy=\"-417.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"126\" y=\"-412.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CDK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;CDK1 -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;CDK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M154.79,-473.06C149.38,-462.82 142.24,-449.32 136.43,-438.33\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"130.24,-437.31 139.08,-432.64 140.01,-434.41 131.17,-439.08 130.24,-437.31\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"134.19,-434.09 136.53,-438.51\"/>\n",
       "</g>\n",
       "<!-- EP300 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>EP300</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"122\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"122\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EP300</text>\n",
       "</g>\n",
       "<!-- RUNX2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>RUNX2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"122\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"122\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RUNX2</text>\n",
       "</g>\n",
       "<!-- EP300&#45;&gt;RUNX2 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>EP300&#45;&gt;RUNX2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M122,-255.3C122,-248.01 122,-239.33 122,-231.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"125.5,-231.22 122,-221.22 118.5,-231.22 125.5,-231.22\"/>\n",
       "</g>\n",
       "<!-- e_6_target -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>e_6_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"122\" cy=\"-129.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- RUNX2&#45;&gt;e_6_target -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>RUNX2&#45;&gt;e_6_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M122,-183.3C122,-170.68 122,-153.89 122,-142.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"125.5,-142.92 122,-132.92 118.5,-142.92 125.5,-142.92\"/>\n",
       "</g>\n",
       "<!-- E2F1 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>E2F1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"228\" cy=\"-489.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"228\" y=\"-484.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">E2F1</text>\n",
       "</g>\n",
       "<!-- TP53 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>TP53</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"247\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"247\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">TP53</text>\n",
       "</g>\n",
       "<!-- E2F1&#45;&gt;TP53 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>E2F1&#45;&gt;TP53</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M234.48,-472.67C238.36,-462.3 242.92,-448.38 245,-435.6 252.49,-389.61 251.07,-335.24 249.17,-302.91\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"252.68,-302.93 248.54,-293.18 245.7,-303.38 252.68,-302.93\"/>\n",
       "</g>\n",
       "<!-- NFYB -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>NFYB</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"230\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"230\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFYB</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;NFYB -->\n",
       "<g id=\"edge29\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;NFYB</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M242.88,-255.65C240.59,-246.2 237.7,-234.32 235.24,-224.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"229.45,-221.54 239.17,-219.18 239.64,-221.12 229.93,-223.48 229.45,-221.54\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"234.08,-219.39 235.26,-224.25\"/>\n",
       "</g>\n",
       "<!-- CASP6 -->\n",
       "<g id=\"node29\" class=\"node\">\n",
       "<title>CASP6</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"284\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"284\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CASP6</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;CASP6 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;CASP6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M255.21,-257.06C259.71,-248.55 265.41,-237.77 270.54,-228.06\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"273.53,-229.91 275.1,-219.43 267.34,-226.64 273.53,-229.91\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;TP53 -->\n",
       "<g id=\"edge23\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;TP53</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M188.37,-332.41C198.96,-321.97 214.41,-306.73 226.79,-294.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"229.03,-297.23 233.7,-287.72 224.12,-292.24 229.03,-297.23\"/>\n",
       "</g>\n",
       "<!-- HOXB7 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>HOXB7</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"176\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"176\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HOXB7</text>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;HOXB7 -->\n",
       "<g id=\"edge22\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;HOXB7</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M176,-327.3C176,-317.97 176,-306.37 176,-296.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"171,-292.7 181,-292.7 181,-294.7 171,-294.7 171,-292.7\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"176,-291.7 176,-296.7\"/>\n",
       "</g>\n",
       "<!-- e_4_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_4_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"176\" cy=\"-201.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- HOXB7&#45;&gt;e_4_target -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>HOXB7&#45;&gt;e_4_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M176,-255.3C176,-242.68 176,-225.89 176,-214.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"179.5,-214.92 176,-204.92 172.5,-214.92 179.5,-214.92\"/>\n",
       "</g>\n",
       "<!-- e_5_target -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_5_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"327\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- NEUROD1 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>NEUROD1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"327\" cy=\"-345.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"327\" y=\"-340.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NEUROD1</text>\n",
       "</g>\n",
       "<!-- NEUROD1&#45;&gt;e_5_target -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>NEUROD1&#45;&gt;e_5_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M327,-327.3C327,-314.68 327,-297.89 327,-286.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"330.5,-286.92 327,-276.92 323.5,-286.92 330.5,-286.92\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"284\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- ZBTB4 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>ZBTB4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"284\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"284\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ZBTB4</text>\n",
       "</g>\n",
       "<!-- ZBTB4&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>ZBTB4&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M284,-39.28C284,-31.47 284,-22.41 284,-15.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"287.5,-15.47 284,-5.47 280.5,-15.47 287.5,-15.47\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"230\" cy=\"-129.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- NFYB&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>NFYB&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M230,-183.3C230,-170.68 230,-153.89 230,-142.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"233.5,-142.92 230,-132.92 226.5,-142.92 233.5,-142.92\"/>\n",
       "</g>\n",
       "<!-- e_9_target -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>e_9_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"218\" cy=\"-345.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- ELK1&#45;&gt;e_9_target -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>ELK1&#45;&gt;e_9_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M218,-399.3C218,-386.68 218,-369.89 218,-358.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"221.5,-358.92 218,-348.92 214.5,-358.92 221.5,-358.92\"/>\n",
       "</g>\n",
       "<!-- EGFR -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>EGFR</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"252\" cy=\"-633.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"252\" y=\"-628.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EGFR</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;MAP2K1 -->\n",
       "<g id=\"edge26\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;MAP2K1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M239.28,-620.41C228.4,-609.97 212.51,-594.73 199.78,-582.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"202.3,-580.1 192.66,-575.7 197.46,-585.15 202.3,-580.1\"/>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;E2F1 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;E2F1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M249.11,-615.47C245.05,-591.48 237.63,-547.59 232.76,-518.76\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"236.28,-518.56 231.16,-509.28 229.37,-519.73 236.28,-518.56\"/>\n",
       "</g>\n",
       "<!-- VAV2 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>VAV2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"279\" cy=\"-561.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"279\" y=\"-556.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">VAV2</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;VAV2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;VAV2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M258.26,-616.36C261.36,-608.32 265.19,-598.41 268.7,-589.29\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"271.89,-590.75 272.23,-580.16 265.36,-588.23 271.89,-590.75\"/>\n",
       "</g>\n",
       "<!-- PTK2 -->\n",
       "<g id=\"node27\" class=\"node\">\n",
       "<title>PTK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"335\" cy=\"-561.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"335\" y=\"-556.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">PTK2</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;PTK2 -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;PTK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M265.34,-621.35C278.09,-610.6 297.55,-594.18 312.67,-581.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"314.88,-584.15 320.26,-575.03 310.36,-578.8 314.88,-584.15\"/>\n",
       "</g>\n",
       "<!-- CDC42 -->\n",
       "<g id=\"node30\" class=\"node\">\n",
       "<title>CDC42</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"282\" cy=\"-489.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"282\" y=\"-484.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CDC42</text>\n",
       "</g>\n",
       "<!-- VAV2&#45;&gt;CDC42 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>VAV2&#45;&gt;CDC42</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M279.74,-543.3C280.05,-536.01 280.43,-527.33 280.78,-519.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"284.27,-519.36 281.2,-509.22 277.28,-519.06 284.27,-519.36\"/>\n",
       "</g>\n",
       "<!-- e_11_target -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>e_11_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-345.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- NFATC4&#45;&gt;e_11_target -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>NFATC4&#45;&gt;e_11_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-399.3C18,-386.68 18,-369.89 18,-358.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-358.92 18,-348.92 14.5,-358.92 21.5,-358.92\"/>\n",
       "</g>\n",
       "<!-- e_12_target -->\n",
       "<g id=\"node23\" class=\"node\">\n",
       "<title>e_12_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-345.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- AEBP1&#45;&gt;e_12_target -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>AEBP1&#45;&gt;e_12_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-399.3C72,-386.68 72,-369.89 72,-358.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"75.5,-358.92 72,-348.92 68.5,-358.92 75.5,-358.92\"/>\n",
       "</g>\n",
       "<!-- e_14_source -->\n",
       "<g id=\"node25\" class=\"node\">\n",
       "<title>e_14_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"252\" cy=\"-689.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_14_source&#45;&gt;EGFR -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>e_14_source&#45;&gt;EGFR</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M252,-687.47C252,-684.37 252,-674.04 252,-663.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"255.5,-663.37 252,-653.37 248.5,-663.37 255.5,-663.37\"/>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;CSNK2A1 -->\n",
       "<g id=\"edge35\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;CSNK2A1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M136.12,-402.43C142.76,-393.14 151.6,-380.75 159.28,-370.01\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"162.05,-372.15 165.02,-361.98 156.36,-368.08 162.05,-372.15\"/>\n",
       "</g>\n",
       "<!-- SIRT1 -->\n",
       "<g id=\"node32\" class=\"node\">\n",
       "<title>SIRT1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"122\" cy=\"-345.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"122\" y=\"-340.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">SIRT1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;SIRT1 -->\n",
       "<g id=\"edge33\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;SIRT1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M125.01,-399.3C124.59,-392.01 124.1,-383.33 123.63,-375.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"127.13,-375 123.06,-365.22 120.14,-375.4 127.13,-375\"/>\n",
       "</g>\n",
       "<!-- RAC1 -->\n",
       "<g id=\"node28\" class=\"node\">\n",
       "<title>RAC1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"336\" cy=\"-489.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"336\" y=\"-484.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RAC1</text>\n",
       "</g>\n",
       "<!-- PTK2&#45;&gt;RAC1 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>PTK2&#45;&gt;RAC1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M335.25,-543.3C335.35,-536.01 335.48,-527.33 335.59,-519.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"339.09,-519.27 335.73,-509.22 332.09,-519.17 339.09,-519.27\"/>\n",
       "</g>\n",
       "<!-- MAP3K10 -->\n",
       "<g id=\"node33\" class=\"node\">\n",
       "<title>MAP3K10</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"327\" cy=\"-417.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"327\" y=\"-412.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP3K10</text>\n",
       "</g>\n",
       "<!-- RAC1&#45;&gt;MAP3K10 -->\n",
       "<g id=\"edge31\" class=\"edge\">\n",
       "<title>RAC1&#45;&gt;MAP3K10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M333.78,-471.3C332.83,-463.92 331.7,-455.12 330.63,-446.85\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"334.14,-446.68 329.39,-437.21 327.2,-447.57 334.14,-446.68\"/>\n",
       "</g>\n",
       "<!-- HIPK2 -->\n",
       "<g id=\"node31\" class=\"node\">\n",
       "<title>HIPK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"284\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"284\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HIPK2</text>\n",
       "</g>\n",
       "<!-- CASP6&#45;&gt;HIPK2 -->\n",
       "<g id=\"edge27\" class=\"edge\">\n",
       "<title>CASP6&#45;&gt;HIPK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M284,-183.3C284,-176.01 284,-167.33 284,-159.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"287.5,-159.22 284,-149.22 280.5,-159.22 287.5,-159.22\"/>\n",
       "</g>\n",
       "<!-- CDC42&#45;&gt;MAP3K10 -->\n",
       "<g id=\"edge30\" class=\"edge\">\n",
       "<title>CDC42&#45;&gt;MAP3K10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M291.54,-473.75C297.27,-464.85 304.7,-453.29 311.27,-443.06\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"314.19,-445 316.65,-434.7 308.3,-441.22 314.19,-445\"/>\n",
       "</g>\n",
       "<!-- HIPK2&#45;&gt;ZBTB4 -->\n",
       "<g id=\"edge32\" class=\"edge\">\n",
       "<title>HIPK2&#45;&gt;ZBTB4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M284,-111.3C284,-101.97 284,-90.37 284,-80.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"279,-76.7 289,-76.7 289,-78.7 279,-78.7 279,-76.7\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"284,-75.7 284,-80.7\"/>\n",
       "</g>\n",
       "<!-- SIRT1&#45;&gt;EP300 -->\n",
       "<g id=\"edge28\" class=\"edge\">\n",
       "<title>SIRT1&#45;&gt;EP300</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M122,-327.3C122,-317.97 122,-306.37 122,-296.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"117,-292.7 127,-292.7 127,-294.7 117,-294.7 117,-292.7\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"122,-291.7 122,-296.7\"/>\n",
       "</g>\n",
       "<!-- MAP3K10&#45;&gt;NEUROD1 -->\n",
       "<g id=\"edge34\" class=\"edge\">\n",
       "<title>MAP3K10&#45;&gt;NEUROD1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M327,-399.3C327,-392.01 327,-383.33 327,-375.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"330.5,-375.22 327,-365.22 323.5,-375.22 330.5,-375.22\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25cd28b3c70>"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G2.edge_subgraph(np.flatnonzero(np.abs(P_cross.expr.flow.value) >= 1e-6)).plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "0f13abf2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "===============================================================================\n",
      "                                     CVXPY                                     \n",
      "                                     v1.5.3                                    \n",
      "===============================================================================\n",
      "(CVXPY) Aug 26 09:52:28 PM: Your problem has 44146 variables, 98726 constraints, and 0 parameters.\n",
      "(CVXPY) Aug 26 09:52:28 PM: It is compliant with the following grammars: DCP, DQCP\n",
      "(CVXPY) Aug 26 09:52:28 PM: (If you need to solve this problem multiple times, but with different data, consider using parameters.)\n",
      "(CVXPY) Aug 26 09:52:28 PM: CVXPY will first compile your problem; then, it will invoke a numerical solver to obtain a solution.\n",
      "(CVXPY) Aug 26 09:52:28 PM: Your problem is compiled with the CPP canonicalization backend.\n",
      "-------------------------------------------------------------------------------\n",
      "                                  Compilation                                  \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:52:28 PM: Compiling problem (target solver=GUROBI).\n",
      "(CVXPY) Aug 26 09:52:28 PM: Reduction chain: CvxAttr2Constr -> Qp2SymbolicQp -> QpMatrixStuffing -> GUROBI\n",
      "(CVXPY) Aug 26 09:52:28 PM: Applying reduction CvxAttr2Constr\n",
      "(CVXPY) Aug 26 09:52:28 PM: Applying reduction Qp2SymbolicQp\n",
      "(CVXPY) Aug 26 09:52:29 PM: Applying reduction QpMatrixStuffing\n",
      "(CVXPY) Aug 26 09:52:49 PM: Applying reduction GUROBI\n",
      "(CVXPY) Aug 26 09:52:49 PM: Finished problem compilation (took 2.125e+01 seconds).\n",
      "-------------------------------------------------------------------------------\n",
      "                                Numerical solver                               \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:52:49 PM: Invoking solver GUROBI  to obtain a solution.\n",
      "Set parameter QCPDual to value 1\n",
      "Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (win64 - Windows 11.0 (22631.2))\n",
      "\n",
      "CPU model: 11th Gen Intel(R) Core(TM) i7-1185G7 @ 3.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "\n",
      "Optimize a model with 98726 rows, 44146 columns and 441710 nonzeros\n",
      "Model fingerprint: 0x724789c8\n",
      "Variable types: 9346 continuous, 34800 integer (34800 binary)\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e-04, 1e+03]\n",
      "  Objective range  [1e-02, 1e+00]\n",
      "  Bounds range     [1e+00, 1e+00]\n",
      "  RHS range        [1e+00, 1e+03]\n",
      "Presolve removed 46687 rows and 9337 columns\n",
      "Presolve time: 1.24s\n",
      "Presolved: 52039 rows, 34809 columns, 310941 nonzeros\n",
      "Variable types: 6591 continuous, 28218 integer (28198 binary)\n",
      "Deterministic concurrent LP optimizer: primal and dual simplex\n",
      "Showing primal log only...\n",
      "\n",
      "Concurrent spin time: 0.00s\n",
      "\n",
      "Solved with dual simplex\n",
      "Extra simplex iterations after uncrush: 4\n",
      "\n",
      "Root relaxation: objective 4.040000e-01, 5095 iterations, 2.02 seconds (1.06 work units)\n",
      "Total elapsed time = 5.37s (DegenMoves)\n",
      "\n",
      "    Nodes    |    Current Node    |     Objective Bounds      |     Work\n",
      " Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time\n",
      "\n",
      "     0     0    0.40400    0   78          -    0.40400      -     -    6s\n",
      "H    0     0                      94.0400000    0.40400   100%     -    7s\n",
      "     0     0    0.42000    0   98   94.04000    0.42000   100%     -    8s\n",
      "H    0     0                      20.0200000    0.42000  97.9%     -    9s\n",
      "H    0     0                       0.4400000    0.42000  4.55%     -   10s\n",
      "     0     0    0.42000    0   95    0.44000    0.42000  4.55%     -   11s\n",
      "     0     0    0.42000    0   56    0.44000    0.42000  4.55%     -   11s\n",
      "     0     0    0.42000    0   53    0.44000    0.42000  4.55%     -   14s\n",
      "     0     0    0.42000    0   33    0.44000    0.42000  4.55%     -   15s\n",
      "     0     0    0.42000    0   36    0.44000    0.42000  4.55%     -   15s\n",
      "     0     0    0.42000    0   35    0.44000    0.42000  4.55%     -   16s\n",
      "     0     0    0.42000    0   34    0.44000    0.42000  4.55%     -   16s\n",
      "     0     0    0.42000    0   22    0.44000    0.42000  4.55%     -   18s\n",
      "     0     0    0.42000    0    4    0.44000    0.42000  4.55%     -   20s\n",
      "H    0     0                       0.4200000    0.42000  0.00%     -   20s\n",
      "     0     0    0.42000    0    4    0.42000    0.42000  0.00%     -   20s\n",
      "\n",
      "Cutting planes:\n",
      "  Learned: 1\n",
      "  Gomory: 4\n",
      "  Cover: 2\n",
      "  Implied bound: 7\n",
      "  MIR: 4\n",
      "  Flow cover: 10\n",
      "  Zero half: 2\n",
      "  RLT: 5\n",
      "  PSD: 2\n",
      "\n",
      "Explored 1 nodes (51188 simplex iterations) in 20.26 seconds (10.44 work units)\n",
      "Thread count was 8 (of 8 available processors)\n",
      "\n",
      "Solution count 4: 0.42 0.44 20.02 94.04 \n",
      "\n",
      "Optimal solution found (tolerance 1.00e-04)\n",
      "Best objective 4.200000000000e-01, best bound 4.200000000000e-01, gap 0.0000%\n",
      "-------------------------------------------------------------------------------\n",
      "                                    Summary                                    \n",
      "-------------------------------------------------------------------------------\n",
      "(CVXPY) Aug 26 09:53:12 PM: Problem status: optimal\n",
      "(CVXPY) Aug 26 09:53:12 PM: Optimal value: 4.200e-01\n",
      "(CVXPY) Aug 26 09:53:12 PM: Compilation took 2.125e+01 seconds\n",
      "(CVXPY) Aug 26 09:53:12 PM: Solver (including time spent in interface) took 2.121e+01 seconds\n"
     ]
    }
   ],
   "source": [
    "# Flow + Acyclic.\n",
    "Gp, cp_inputs, cp_outputs = preprocess_graph(G, c_inputs, c_outputs)\n",
    "exp_list = {\"c0\": {\"input\": cp_inputs, \"output\": cp_outputs}}\n",
    "exp_list[\"c1\"] = exp_list[\"c0\"]\n",
    "G2 = expand_graph_for_flows(Gp, exp_list)\n",
    "P_cross = runCARNIVAL_Flow_Acyclic(\n",
    "    G2, exp_list, solver=\"GUROBI\", verbosity=True, betaWeight=0.01\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "f405d356",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'EP300', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'CASP6', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n",
      "Warning: node 'MAP2K1', graph '%3' size too small for label\n",
      "Warning: node 'MAPK1', graph '%3' size too small for label\n",
      "Warning: node 'EP300', graph '%3' size too small for label\n",
      "Warning: node 'RUNX2', graph '%3' size too small for label\n",
      "Warning: node 'AEBP1', graph '%3' size too small for label\n",
      "Warning: node 'EGFR', graph '%3' size too small for label\n",
      "Warning: node 'CASP6', graph '%3' size too small for label\n",
      "Warning: node 'CSNK2A1', graph '%3' size too small for label\n",
      "Warning: node 'HOXB7', graph '%3' size too small for label\n",
      "Warning: node 'NFATC4', graph '%3' size too small for label\n",
      "Warning: node 'HIPK2', graph '%3' size too small for label\n",
      "Warning: node 'SIRT1', graph '%3' size too small for label\n",
      "Warning: node 'NFYB', graph '%3' size too small for label\n",
      "Warning: node 'MAP3K10', graph '%3' size too small for label\n",
      "Warning: node 'ZBTB4', graph '%3' size too small for label\n",
      "Warning: node 'NEUROD1', graph '%3' size too small for label\n"
     ]
    },
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"314pt\" height=\"660pt\"\n",
       " viewBox=\"0.00 0.00 314.00 659.60\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 655.6)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-655.6 310,-655.6 310,4 -4,4\"/>\n",
       "<!-- MAP2K1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>MAP2K1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"180\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP2K1</text>\n",
       "</g>\n",
       "<!-- MAPK1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>MAPK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"180\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAPK1</text>\n",
       "</g>\n",
       "<!-- MAP2K1&#45;&gt;MAPK1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>MAP2K1&#45;&gt;MAPK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M180,-503.7C180,-496.41 180,-487.73 180,-479.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"183.5,-479.62 180,-469.62 176.5,-479.62 183.5,-479.62\"/>\n",
       "</g>\n",
       "<!-- AEBP1 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>AEBP1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">AEBP1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;AEBP1 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;AEBP1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M164.98,-439.27C147.25,-427.77 117.51,-408.5 96.44,-394.84\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"98.45,-391.98 88.16,-389.47 94.65,-397.85 98.45,-391.98\"/>\n",
       "</g>\n",
       "<!-- CDK1 -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>CDK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"126\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"126\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CDK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;CDK1 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;CDK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M169.33,-435.17C160.83,-424.14 148.86,-408.63 139.65,-396.7\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"133.3,-396.65 141.22,-390.54 142.44,-392.12 134.52,-398.23 133.3,-396.65\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"136.65,-392.8 139.7,-396.76\"/>\n",
       "</g>\n",
       "<!-- ELK1 -->\n",
       "<g id=\"node15\" class=\"node\">\n",
       "<title>ELK1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"180\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"180\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ELK1</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;ELK1 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;ELK1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M180,-431.7C180,-424.41 180,-415.73 180,-407.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"183.5,-407.62 180,-397.62 176.5,-407.62 183.5,-407.62\"/>\n",
       "</g>\n",
       "<!-- NFATC4 -->\n",
       "<g id=\"node16\" class=\"node\">\n",
       "<title>NFATC4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"234\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"234\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFATC4</text>\n",
       "</g>\n",
       "<!-- MAPK1&#45;&gt;NFATC4 -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>MAPK1&#45;&gt;NFATC4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M190.67,-435.17C197.99,-425.68 207.88,-412.86 216.36,-401.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"219.09,-404.06 222.43,-394 213.55,-399.78 219.09,-404.06\"/>\n",
       "</g>\n",
       "<!-- EP300 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>EP300</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"153\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"153\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EP300</text>\n",
       "</g>\n",
       "<!-- RUNX2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>RUNX2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"153\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"153\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RUNX2</text>\n",
       "</g>\n",
       "<!-- EP300&#45;&gt;RUNX2 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>EP300&#45;&gt;RUNX2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M153,-215.7C153,-208.41 153,-199.73 153,-191.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"156.5,-191.62 153,-181.62 149.5,-191.62 156.5,-191.62\"/>\n",
       "</g>\n",
       "<!-- e_3_source -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>e_3_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"207\" cy=\"-649.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- EGFR -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>EGFR</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"207\" cy=\"-594\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"207\" y=\"-588.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">EGFR</text>\n",
       "</g>\n",
       "<!-- e_3_source&#45;&gt;EGFR -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>e_3_source&#45;&gt;EGFR</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M207,-647.87C207,-644.77 207,-634.44 207,-623.72\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"210.5,-623.77 207,-613.77 203.5,-623.77 210.5,-623.77\"/>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;MAP2K1 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;MAP2K1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M200.74,-576.76C197.64,-568.72 193.81,-558.81 190.3,-549.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"193.64,-548.63 186.77,-540.56 187.11,-551.15 193.64,-548.63\"/>\n",
       "</g>\n",
       "<!-- PTK2 -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>PTK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"248\" cy=\"-522\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"248\" y=\"-516.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">PTK2</text>\n",
       "</g>\n",
       "<!-- EGFR&#45;&gt;PTK2 -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>EGFR&#45;&gt;PTK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M215.9,-577.81C221,-569.1 227.54,-557.94 233.38,-547.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"236.32,-549.86 238.36,-539.47 230.28,-546.33 236.32,-549.86\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1 -->\n",
       "<g id=\"node13\" class=\"node\">\n",
       "<title>CSNK2A1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"99\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"99\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CSNK2A1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;CSNK2A1 -->\n",
       "<g id=\"edge21\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;CSNK2A1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M119.74,-360.76C116.64,-352.72 112.81,-342.81 109.3,-333.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"112.64,-332.63 105.77,-324.56 106.11,-335.15 112.64,-332.63\"/>\n",
       "</g>\n",
       "<!-- SIRT1 -->\n",
       "<g id=\"node18\" class=\"node\">\n",
       "<title>SIRT1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"153\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"153\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">SIRT1</text>\n",
       "</g>\n",
       "<!-- CDK1&#45;&gt;SIRT1 -->\n",
       "<g id=\"edge19\" class=\"edge\">\n",
       "<title>CDK1&#45;&gt;SIRT1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M132.26,-360.76C135.36,-352.72 139.19,-342.81 142.7,-333.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"145.89,-335.15 146.23,-324.56 139.36,-332.63 145.89,-335.15\"/>\n",
       "</g>\n",
       "<!-- RAC1 -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>RAC1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"261\" cy=\"-450\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"261\" y=\"-444.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">RAC1</text>\n",
       "</g>\n",
       "<!-- PTK2&#45;&gt;RAC1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>PTK2&#45;&gt;RAC1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M251.15,-504.05C252.55,-496.49 254.25,-487.37 255.83,-478.85\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"259.22,-479.75 257.61,-469.28 252.34,-478.47 259.22,-479.75\"/>\n",
       "</g>\n",
       "<!-- MAP3K10 -->\n",
       "<g id=\"node20\" class=\"node\">\n",
       "<title>MAP3K10</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"288\" cy=\"-378\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-372.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">MAP3K10</text>\n",
       "</g>\n",
       "<!-- RAC1&#45;&gt;MAP3K10 -->\n",
       "<g id=\"edge17\" class=\"edge\">\n",
       "<title>RAC1&#45;&gt;MAP3K10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M267.26,-432.76C270.36,-424.72 274.19,-414.81 277.7,-405.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"280.89,-407.15 281.23,-396.56 274.36,-404.63 280.89,-407.15\"/>\n",
       "</g>\n",
       "<!-- TP53 -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>TP53</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"45\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"45\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">TP53</text>\n",
       "</g>\n",
       "<!-- CASP6 -->\n",
       "<g id=\"node12\" class=\"node\">\n",
       "<title>CASP6</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">CASP6</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;CASP6 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;CASP6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M38.74,-216.76C35.64,-208.72 31.81,-198.81 28.3,-189.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"31.64,-188.63 24.77,-180.56 25.11,-191.15 31.64,-188.63\"/>\n",
       "</g>\n",
       "<!-- NFYB -->\n",
       "<g id=\"node19\" class=\"node\">\n",
       "<title>NFYB</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NFYB</text>\n",
       "</g>\n",
       "<!-- TP53&#45;&gt;NFYB -->\n",
       "<g id=\"edge16\" class=\"edge\">\n",
       "<title>TP53&#45;&gt;NFYB</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M51.26,-216.76C55.08,-206.87 59.99,-194.13 64.08,-183.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"60.75,-178.28 70.08,-181.88 69.36,-183.75 60.03,-180.15 60.75,-178.28\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"65.77,-179.15 63.97,-183.81\"/>\n",
       "</g>\n",
       "<!-- HIPK2 -->\n",
       "<g id=\"node17\" class=\"node\">\n",
       "<title>HIPK2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HIPK2</text>\n",
       "</g>\n",
       "<!-- CASP6&#45;&gt;HIPK2 -->\n",
       "<g id=\"edge14\" class=\"edge\">\n",
       "<title>CASP6&#45;&gt;HIPK2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-143.7C18,-136.41 18,-127.73 18,-119.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-119.62 18,-109.62 14.5,-119.62 21.5,-119.62\"/>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;TP53 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;TP53</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M88.33,-291.17C81.01,-281.68 71.12,-268.86 62.64,-257.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"65.45,-255.78 56.57,-250 59.91,-260.06 65.45,-255.78\"/>\n",
       "</g>\n",
       "<!-- HOXB7 -->\n",
       "<g id=\"node14\" class=\"node\">\n",
       "<title>HOXB7</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"99\" cy=\"-234\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"99\" y=\"-228.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">HOXB7</text>\n",
       "</g>\n",
       "<!-- CSNK2A1&#45;&gt;HOXB7 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>CSNK2A1&#45;&gt;HOXB7</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M99,-287.7C99,-278.37 99,-266.77 99,-256.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"94,-253.1 104,-253.1 104,-255.1 94,-255.1 94,-253.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"99,-252.1 99,-257.1\"/>\n",
       "</g>\n",
       "<!-- ZBTB4 -->\n",
       "<g id=\"node21\" class=\"node\">\n",
       "<title>ZBTB4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">ZBTB4</text>\n",
       "</g>\n",
       "<!-- HIPK2&#45;&gt;ZBTB4 -->\n",
       "<g id=\"edge18\" class=\"edge\">\n",
       "<title>HIPK2&#45;&gt;ZBTB4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-71.7C18,-62.37 18,-50.77 18,-40.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"13,-37.1 23,-37.1 23,-39.1 13,-39.1 13,-37.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"18,-36.1 18,-41.1\"/>\n",
       "</g>\n",
       "<!-- SIRT1&#45;&gt;EP300 -->\n",
       "<g id=\"edge15\" class=\"edge\">\n",
       "<title>SIRT1&#45;&gt;EP300</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M153,-287.7C153,-278.37 153,-266.77 153,-256.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"148,-253.1 158,-253.1 158,-255.1 148,-255.1 148,-253.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"153,-252.1 153,-257.1\"/>\n",
       "</g>\n",
       "<!-- NEUROD1 -->\n",
       "<g id=\"node22\" class=\"node\">\n",
       "<title>NEUROD1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"288\" cy=\"-306\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"288\" y=\"-300.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">NEUROD1</text>\n",
       "</g>\n",
       "<!-- MAP3K10&#45;&gt;NEUROD1 -->\n",
       "<g id=\"edge20\" class=\"edge\">\n",
       "<title>MAP3K10&#45;&gt;NEUROD1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M288,-359.7C288,-352.41 288,-343.73 288,-335.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"291.5,-335.62 288,-325.62 284.5,-335.62 291.5,-335.62\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ca1c5cbb0>"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G2.edge_subgraph(np.flatnonzero(np.abs(P_cross.expr.edge_value.value[:, 0]) > 0)).plot()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "369f80d6",
   "metadata": {},
   "source": [
    "## CARNIVAL with acyclic flow - single condition"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "848d458e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"98pt\" height=\"188pt\"\n",
       " viewBox=\"0.00 0.00 98.00 188.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 184)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-184 94,-184 94,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- N1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>N1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N1</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;N1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;N1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-143.7C18,-136.41 18,-127.73 18,-119.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-119.62 18,-109.62 14.5,-119.62 21.5,-119.62\"/>\n",
       "</g>\n",
       "<!-- M1 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>M1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M1</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-71.7C18,-64.41 18,-55.73 18,-47.54\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-47.62 18,-37.62 14.5,-47.62 21.5,-47.62\"/>\n",
       "</g>\n",
       "<!-- M2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>M2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-18\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-12.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M2</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M28.67,-75.17C35.99,-65.68 45.88,-52.86 54.36,-41.86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"57.09,-44.06 60.43,-34 51.55,-39.78 57.09,-44.06\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-162\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-156.57\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- N2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>N2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-90\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-84.58\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;N2 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>I2&#45;&gt;N2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-143.7C72,-134.37 72,-122.77 72,-112.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67,-109.1 77,-109.1 77,-111.1 67,-111.1 67,-109.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"72,-108.1 72,-113.1\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M61.33,-75.17C52.83,-64.14 40.86,-48.63 31.65,-36.7\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"25.3,-36.65 33.22,-30.54 34.44,-32.12 26.52,-38.23 25.3,-36.65\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"28.65,-32.8 31.7,-36.76\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M2 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-71.7C72,-62.37 72,-50.77 72,-40.83\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67,-37.1 77,-37.1 77,-39.1 67,-39.1 67,-37.1\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"72,-36.1 72,-41.1\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ca1c5c9a0>"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G = cn.Graph.from_sif_tuples(\n",
    "    [\n",
    "        (\"I1\", 1, \"N1\"),  # I1 activates N1\n",
    "        (\"N1\", 1, \"M1\"),  # N1 activates M1\n",
    "        (\"N1\", 1, \"M2\"),  # N1 activaes M2\n",
    "        (\"I2\", -1, \"N2\"),  # I2 inhibits N2\n",
    "        (\"N2\", -1, \"M2\"),  # N2 inhibits M2\n",
    "        (\"N2\", -1, \"M1\"),  # N2 inhibits M1\n",
    "    ]\n",
    ")\n",
    "G.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "cc9f20c5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'exp0': {'input': {'I1': 1, 'I2': 1}, 'output': {'M1': 1, 'M2': 1}}}"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "exp_list = {\"exp0\": {\"input\": perturbations, \"output\": measurements}}\n",
    "exp_list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "77d1fb8f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"98pt\" height=\"267pt\"\n",
       " viewBox=\"0.00 0.00 98.00 267.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 263.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-263.2 94,-263.2 94,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- N1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>N1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N1</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;N1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;N1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-183.3C18,-176.01 18,-167.33 18,-159.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-159.22 18,-149.22 14.5,-159.22 21.5,-159.22\"/>\n",
       "</g>\n",
       "<!-- M1 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>M1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M1</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-111.3C18,-104.01 18,-95.33 18,-87.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-87.22 18,-77.22 14.5,-87.22 21.5,-87.22\"/>\n",
       "</g>\n",
       "<!-- M2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>M2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M2</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M28.67,-114.77C35.99,-105.28 45.88,-92.46 54.36,-81.46\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"57.09,-83.66 60.43,-73.6 51.55,-79.38 57.09,-83.66\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- M1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>M1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-39.28C18,-31.47 18,-22.41 18,-15.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-15.47 18,-5.47 14.5,-15.47 21.5,-15.47\"/>\n",
       "</g>\n",
       "<!-- e_6_target -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>e_6_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- M2&#45;&gt;e_6_target -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>M2&#45;&gt;e_6_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-39.28C72,-31.47 72,-22.41 72,-15.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"75.5,-15.47 72,-5.47 68.5,-15.47 75.5,-15.47\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- N2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>N2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;N2 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>I2&#45;&gt;N2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-183.3C72,-173.97 72,-162.37 72,-152.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67,-148.7 77,-148.7 77,-150.7 67,-150.7 67,-148.7\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"72,-147.7 72,-152.7\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M61.33,-114.77C52.83,-103.74 40.86,-88.23 31.65,-76.3\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"25.3,-76.25 33.22,-70.14 34.44,-71.72 26.52,-77.83 25.3,-76.25\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"28.65,-72.4 31.7,-76.36\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M2 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-111.3C72,-101.97 72,-90.37 72,-80.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"67,-76.7 77,-76.7 77,-78.7 67,-78.7 67,-76.7\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" points=\"72,-75.7 72,-80.7\"/>\n",
       "</g>\n",
       "<!-- e_8_source -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-257.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_8_source&#45;&gt;I1 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>e_8_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-255.47C18,-252.37 18,-242.04 18,-231.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-231.37 18,-221.37 14.5,-231.37 21.5,-231.37\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-257.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I2 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-255.47C72,-252.37 72,-242.04 72,-231.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"75.5,-231.37 72,-221.37 68.5,-231.37 75.5,-231.37\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ca1c5cf10>"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from corneto.methods import expand_graph_for_flows\n",
    "\n",
    "G2 = G.copy()\n",
    "G2 = expand_graph_for_flows(G2, exp_list)\n",
    "G2.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "fc36dbdc",
   "metadata": {},
   "outputs": [],
   "source": [
    "from corneto.methods import runCARNIVAL_AcyclicFlow\n",
    "\n",
    "# We run the `standard` carnival problem. This interface is similar\n",
    "# to the old R function https://saezlab.github.io/CARNIVAL/reference/runVanillaCarnival.html\n",
    "P = runCARNIVAL_AcyclicFlow(G2, exp_list, solver=\"GUROBI\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "4ecd4050",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"98pt\" height=\"267pt\"\n",
       " viewBox=\"0.00 0.00 98.00 267.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 263.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-263.2 94,-263.2 94,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- N1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>N1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N1</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;N1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;N1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M18,-182.94C18,-177.34 18,-170.96 18,-164.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"22.38,-164.74 18,-154.74 13.63,-164.74 22.38,-164.74\"/>\n",
       "</g>\n",
       "<!-- M1 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>M1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M1</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M18,-110.94C18,-105.34 18,-98.96 18,-92.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"22.38,-92.74 18,-82.74 13.63,-92.74 22.38,-92.74\"/>\n",
       "</g>\n",
       "<!-- M2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>M2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M2</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M28.93,-114.43C35.37,-106.08 43.73,-95.25 51.37,-85.35\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"54.63,-88.27 57.28,-77.68 47.71,-82.93 54.63,-88.27\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- M1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>M1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-38.69C18,-30.59 18,-21.28 18,-14.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.31 18,-4.31 14.5,-14.31 21.5,-14.31\"/>\n",
       "</g>\n",
       "<!-- e_6_target -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>e_6_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- M2&#45;&gt;e_6_target -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>M2&#45;&gt;e_6_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-38.69C72,-30.59 72,-21.28 72,-14.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.5,-14.31 72,-4.31 68.5,-14.31 75.5,-14.31\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- N2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>N2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;N2 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>I2&#45;&gt;N2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-182.94C72,-173.83 72,-162.63 72,-152.93\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"67,-149.02 77,-149.02 77,-151.02 67,-151.02 67,-149.02\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" points=\"72,-148.02 72,-153.02\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M61.33,-114.77C52.94,-103.89 41.17,-88.63 32.01,-76.76\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"25.67,-76.73 33.59,-70.62 34.81,-72.2 26.89,-78.31 25.67,-76.73\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" points=\"29.02,-72.88 32.07,-76.84\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M2 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-111.3C72,-102.19 72,-90.93 72,-81.15\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"67,-77.19 77,-77.19 77,-79.19 67,-79.19 67,-77.19\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" points=\"72,-76.19 72,-81.19\"/>\n",
       "</g>\n",
       "<!-- e_8_source -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-257.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_8_source&#45;&gt;I1 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>e_8_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M18,-255.47C18,-252.87 18,-245.16 18,-236.41\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"22.38,-236.64 18,-226.64 13.63,-236.64 22.38,-236.64\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-257.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I2 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M72,-255.47C72,-252.87 72,-245.16 72,-236.41\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"76.38,-236.64 72,-226.64 67.63,-236.64 76.38,-236.64\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ccf67ea00>"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G2.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P, edge_var=\"edge_value\"),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(P, vertex_var=\"vertex_value\"),\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "03205ada",
   "metadata": {},
   "source": [
    "# CARNIVAL with acyclic flow - two conditions"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e81ef40a",
   "metadata": {},
   "source": [
    "Let's see how this works in case there are two conditions. \n",
    "Notice that the list of experiments contains two conditions. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "41606dad",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'exp0': {'input': {'I1': 1}, 'output': {'M1': 1}},\n",
       " 'exp1': {'input': {'I2': 1}, 'output': {'M1': 1, 'M2': 1}}}"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "exp_list_multi = {\n",
    "    \"exp0\": {\"input\": {\"I1\": 1}, \"output\": {\"M1\": 1}},\n",
    "    \"exp1\": {\"input\": {\"I2\": 1}, \"output\": {\"M1\": 1, \"M2\": 1}},\n",
    "}\n",
    "exp_list_multi"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "e1cf7c96",
   "metadata": {},
   "outputs": [],
   "source": [
    "P_multi = runCARNIVAL_AcyclicFlow(G2, exp_list_multi, solver=\"GUROBI\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aa41d9ad",
   "metadata": {},
   "source": [
    "Now plot the solution graph for the first conditions (default)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "3127c6b4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"98pt\" height=\"267pt\"\n",
       " viewBox=\"0.00 0.00 98.00 267.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 263.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-263.2 94,-263.2 94,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- N1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>N1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N1</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;N1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;N1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M18,-182.94C18,-177.34 18,-170.96 18,-164.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"22.38,-164.74 18,-154.74 13.63,-164.74 22.38,-164.74\"/>\n",
       "</g>\n",
       "<!-- M1 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>M1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M1</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M18,-110.94C18,-105.34 18,-98.96 18,-92.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"22.38,-92.74 18,-82.74 13.63,-92.74 22.38,-92.74\"/>\n",
       "</g>\n",
       "<!-- M2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>M2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M2</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M28.93,-114.43C36.49,-104.63 46.7,-91.39 55.28,-80.27\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"57.89,-82.62 61.22,-72.57 52.35,-78.35 57.89,-82.62\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- M1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>M1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-38.69C18,-30.59 18,-21.28 18,-14.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.31 18,-4.31 14.5,-14.31 21.5,-14.31\"/>\n",
       "</g>\n",
       "<!-- e_6_target -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>e_6_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- M2&#45;&gt;e_6_target -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>M2&#45;&gt;e_6_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-39.28C72,-31.05 72,-21.43 72,-14.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.5,-14.34 72,-4.34 68.5,-14.34 75.5,-14.34\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- N2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>N2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;N2 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>I2&#45;&gt;N2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-183.3C72,-173.97 72,-162.37 72,-152.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"67,-148.7 77,-148.7 77,-150.7 67,-150.7 67,-148.7\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" points=\"72,-147.7 72,-152.7\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M61.33,-114.77C52.94,-103.89 41.17,-88.63 32.01,-76.76\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"25.67,-76.73 33.59,-70.62 34.81,-72.2 26.89,-78.31 25.67,-76.73\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" points=\"29.02,-72.88 32.07,-76.84\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M2 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-111.3C72,-101.97 72,-90.37 72,-80.43\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"67,-76.7 77,-76.7 77,-78.7 67,-78.7 67,-76.7\"/>\n",
       "<polyline fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" points=\"72,-75.7 72,-80.7\"/>\n",
       "</g>\n",
       "<!-- e_8_source -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-257.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_8_source&#45;&gt;I1 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>e_8_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M18,-255.47C18,-252.87 18,-245.16 18,-236.41\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"22.38,-236.64 18,-226.64 13.63,-236.64 22.38,-236.64\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-257.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I2 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-255.47C72,-252.24 72,-241.15 72,-229.95\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.5,-230.24 72,-220.24 68.5,-230.24 75.5,-230.24\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ccf73a1c0>"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G2.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_multi, edge_var=\"edge_value\", sample=0),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(P_multi, vertex_var=\"vertex_value\", sample=0),\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "033a9873",
   "metadata": {},
   "source": [
    "We can request to plot another conditions:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "93b08fda",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"98pt\" height=\"267pt\"\n",
       " viewBox=\"0.00 0.00 98.00 267.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 263.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-263.2 94,-263.2 94,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- N1 -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>N1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N1</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;N1 -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;N1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-183.3C18,-175.67 18,-166.52 18,-158\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-158.08 18,-148.08 14.5,-158.08 21.5,-158.08\"/>\n",
       "</g>\n",
       "<!-- M1 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>M1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M1</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M1 -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-111.3C18,-103.78 18,-94.79 18,-86.38\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-86.57 18,-76.57 14.5,-86.57 21.5,-86.57\"/>\n",
       "</g>\n",
       "<!-- M2 -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>M2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">M2</text>\n",
       "</g>\n",
       "<!-- N1&#45;&gt;M2 -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>N1&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M28.67,-114.77C36.11,-105.12 46.21,-92.03 54.79,-80.91\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"57.41,-83.24 60.75,-73.18 51.87,-78.96 57.41,-83.24\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- M1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>M1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-38.69C18,-30.59 18,-21.28 18,-14.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.31 18,-4.31 14.5,-14.31 21.5,-14.31\"/>\n",
       "</g>\n",
       "<!-- e_6_target -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>e_6_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- M2&#45;&gt;e_6_target -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>M2&#45;&gt;e_6_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-38.69C72,-30.59 72,-21.28 72,-14.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.5,-14.31 72,-4.31 68.5,-14.31 75.5,-14.31\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- N2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>N2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#104e8b\" stroke-width=\"2\" cx=\"72\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">N2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;N2 -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>I2&#45;&gt;N2</title>\n",
       "<path fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" d=\"M72,-182.94C72,-174.54 72,-164.37 72,-155.24\"/>\n",
       "<polygon fill=\"#104e8b\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"67,-151 77,-151 77,-153 67,-153 67,-151\"/>\n",
       "<polyline fill=\"none\" stroke=\"#104e8b\" stroke-width=\"5\" points=\"72,-150 72,-155\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M1 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M61.07,-114.43C53.02,-104 41.97,-89.67 33.08,-78.15\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"26.48,-77.78 34.4,-71.67 35.62,-73.25 27.7,-79.36 26.48,-77.78\"/>\n",
       "<polyline fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"29.83,-73.93 32.88,-77.89\"/>\n",
       "</g>\n",
       "<!-- N2&#45;&gt;M2 -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>N2&#45;&gt;M2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M72,-110.94C72,-102.54 72,-92.37 72,-83.24\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"67,-79 77,-79 77,-81 67,-81 67,-79\"/>\n",
       "<polyline fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"72,-78 72,-83\"/>\n",
       "</g>\n",
       "<!-- e_8_source -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-257.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_8_source&#45;&gt;I1 -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>e_8_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-255.47C18,-252.24 18,-241.15 18,-229.95\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-230.24 18,-220.24 14.5,-230.24 21.5,-230.24\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-257.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I2 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M72,-255.47C72,-252.87 72,-245.16 72,-236.41\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"76.38,-236.64 72,-226.64 67.63,-236.64 76.38,-236.64\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ccf73a8b0>"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G2.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_multi, edge_var=\"edge_value\", sample=1),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(\n",
    "        P_multi, G2, vertex_var=\"vertex_value\", sample=1\n",
    "    ),\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0716a529",
   "metadata": {},
   "source": [
    "## Limitation of single flow CARNIVAL"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "3b326d4a",
   "metadata": {},
   "outputs": [],
   "source": [
    "G_cross = cn.Graph.from_sif_tuples(\n",
    "    [\n",
    "        (\"I1\", 1, \"A\"),\n",
    "        (\"I2\", 1, \"B\"),\n",
    "        (\"A\", 1, \"B\"),\n",
    "        (\"B\", 1, \"C\"),\n",
    "        (\"C\", 1, \"A\"),\n",
    "        (\"A\", 1, \"O2\"),\n",
    "        (\"B\", 1, \"O1\"),\n",
    "    ]\n",
    ")\n",
    "exp_list_cross = {\n",
    "    \"exp0\": {\"input\": {\"I1\": 1, \"I2\": 0}, \"output\": {\"O1\": 1, \"O2\": 0}},\n",
    "    \"exp1\": {\"input\": {\"I1\": 0, \"I2\": 1}, \"output\": {\"O1\": 0, \"O2\": 1}},\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "fbdf53ab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"74\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"74\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M74,-255.3C74,-248.01 74,-239.33 74,-231.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"77.5,-231.22 74,-221.22 70.5,-231.22 77.5,-231.22\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"24\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"24\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M63.88,-186.43C57.24,-177.14 48.4,-164.75 40.72,-154.01\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"43.64,-152.08 34.98,-145.98 37.95,-156.15 43.64,-152.08\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M83.33,-185.75C88.93,-176.85 96.19,-165.29 102.62,-155.06\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"105.52,-157.03 107.88,-146.71 99.59,-153.31 105.52,-157.03\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"20\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"20\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M20.99,-183.3C21.41,-176.01 21.9,-167.33 22.37,-159.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"25.86,-159.4 22.94,-149.22 18.87,-159 25.86,-159.4\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M33.95,-114.1C40.19,-104.99 48.39,-93.03 55.58,-82.55\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"58.44,-84.56 61.21,-74.33 52.67,-80.6 58.44,-84.56\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M22.52,-111.3C21.89,-104.01 21.15,-95.33 20.45,-87.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"23.94,-86.88 19.6,-77.21 16.96,-87.47 23.94,-86.88\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72.24,-75.71C72.58,-99.52 73.19,-142.97 73.59,-171.82\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"70.09,-171.72 73.73,-181.67 77.09,-171.63 70.09,-171.72\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M118,-111.3C118,-98.68 118,-81.89 118,-70.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"121.5,-70.92 118,-60.92 114.5,-70.92 121.5,-70.92\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-39.28C18,-31.47 18,-22.41 18,-15.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-15.47 18,-5.47 14.5,-15.47 21.5,-15.47\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"74\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M74,-327.47C74,-324.37 74,-314.04 74,-303.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"77.5,-303.37 74,-293.37 70.5,-303.37 77.5,-303.37\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"20\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M20,-271.39C20,-266.49 20,-247.66 20,-230.94\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"23.5,-231.41 20,-221.41 16.5,-231.41 23.5,-231.41\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ccf72e100>"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_cross = expand_graph_for_flows(G_cross, exp_list_cross)\n",
    "G_cross.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "f3cff9d3",
   "metadata": {},
   "outputs": [],
   "source": [
    "P_cross = runCARNIVAL_AcyclicFlow(G_cross, exp_list_cross, solver=\"GUROBI\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "55c1cbb4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"74\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"74\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M74,-254.94C74,-249.34 74,-242.96 74,-236.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"78.38,-236.74 74,-226.74 69.63,-236.74 78.38,-236.74\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"24\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"24\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M63.64,-186.1C57.87,-178.02 50.5,-167.71 43.69,-158.16\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"47.34,-155.76 37.97,-150.16 40.22,-160.84 47.34,-155.76\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M83.55,-185.41C89.33,-176.21 96.83,-164.27 103.36,-153.89\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"106.21,-155.93 108.57,-145.6 100.29,-152.2 106.21,-155.93\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"20\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"20\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M20.99,-183.3C21.42,-175.78 21.93,-166.79 22.41,-158.38\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"25.9,-158.75 22.97,-148.57 18.91,-158.35 25.9,-158.75\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M34.18,-113.75C40.63,-104.35 49.1,-92 56.39,-81.37\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"59.18,-83.48 61.95,-73.26 53.41,-79.53 59.18,-83.48\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M22.49,-110.94C22.01,-105.34 21.46,-98.96 20.92,-92.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"25.28,-92.31 20.07,-82.72 16.56,-93.05 25.28,-92.31\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72.24,-75.99C72.58,-100.03 73.2,-143.68 73.6,-172.41\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"70.1,-172.29 73.74,-182.24 77.1,-172.19 70.1,-172.29\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M118,-111.3C118,-98.23 118,-80.71 118,-69.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"121.5,-69.79 118,-59.79 114.5,-69.79 121.5,-69.79\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-38.69C18,-30.59 18,-21.28 18,-14.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.31 18,-4.31 14.5,-14.31 21.5,-14.31\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"74\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M74,-327.47C74,-324.87 74,-317.16 74,-308.41\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"78.38,-308.64 74,-298.64 69.63,-308.64 78.38,-308.64\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"20\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M20,-271.39C20,-266.39 20,-246.93 20,-229.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"23.5,-230.27 20,-220.27 16.5,-230.27 23.5,-230.27\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9d9f9250>"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_cross.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_cross, edge_var=\"edge_value\", sample=0),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(\n",
    "        P_cross, G_cross, vertex_var=\"vertex_value\", sample=0\n",
    "    ),\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "473f92e0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"74\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"74\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M74,-255.3C74,-247.67 74,-238.52 74,-230\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"77.5,-230.08 74,-220.08 70.5,-230.08 77.5,-230.08\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"24\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"24\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M63.88,-186.43C57.04,-176.85 47.85,-163.99 40.02,-153.03\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"42.98,-151.16 34.32,-145.05 37.29,-155.22 42.98,-151.16\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M83.33,-185.75C89.11,-176.57 96.65,-164.57 103.22,-154.11\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"106.12,-156.07 108.48,-145.74 100.2,-152.35 106.12,-156.07\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"20\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"20\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M21.01,-182.94C21.44,-175.42 21.95,-166.47 22.43,-158.12\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"25.91,-158.58 22.98,-148.39 18.92,-158.18 25.91,-158.58\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M33.95,-114.1C40.38,-104.71 48.9,-92.29 56.24,-81.58\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"59.08,-83.62 61.85,-73.4 53.31,-79.67 59.08,-83.62\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M22.52,-111.3C21.86,-103.67 21.08,-94.52 20.35,-86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"23.84,-85.75 19.5,-76.08 16.87,-86.34 23.84,-85.75\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72.24,-75.71C72.58,-99.84 73.2,-144.14 73.61,-172.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"70.11,-172.86 73.75,-182.81 77.11,-172.76 70.11,-172.86\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M118,-111.3C118,-98.23 118,-80.71 118,-69.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"121.5,-69.79 118,-59.79 114.5,-69.79 121.5,-69.79\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-39.28C18,-31.05 18,-21.43 18,-14.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.34 18,-4.34 14.5,-14.34 21.5,-14.34\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"74\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M74,-327.47C74,-324.24 74,-313.15 74,-301.95\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"77.5,-302.24 74,-292.24 70.5,-302.24 77.5,-302.24\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"20\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M20,-271.39C20,-267.01 20,-251.53 20,-236.36\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"24.38,-236.8 20,-226.8 15.63,-236.8 24.38,-236.8\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9da01370>"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_cross.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_cross, edge_var=\"edge_value\", sample=1),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(\n",
    "        P_cross, G_cross, vertex_var=\"vertex_value\", sample=1\n",
    "    ),\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "16cca951",
   "metadata": {},
   "source": [
    "## Let's check the Acyclic on flow"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "c95f7d5c",
   "metadata": {},
   "outputs": [],
   "source": [
    "from corneto.methods import runCARNIVAL_Flow_Acyclic"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "f36c9ad0",
   "metadata": {},
   "outputs": [],
   "source": [
    "P_cross = runCARNIVAL_Flow_Acyclic(G_cross, exp_list_cross, solver=\"GUROBI\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "d60b506e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"74\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"74\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M74,-254.94C74,-249.34 74,-242.96 74,-236.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"78.38,-236.74 74,-226.74 69.63,-236.74 78.38,-236.74\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"24\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"24\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M63.64,-186.1C57.87,-178.02 50.5,-167.71 43.69,-158.16\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"47.34,-155.76 37.97,-150.16 40.22,-160.84 47.34,-155.76\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M83.55,-185.41C89.33,-176.21 96.83,-164.27 103.36,-153.89\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"106.21,-155.93 108.57,-145.6 100.29,-152.2 106.21,-155.93\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"20\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"20\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M20.99,-183.3C21.42,-175.78 21.93,-166.79 22.41,-158.38\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"25.9,-158.75 22.97,-148.57 18.91,-158.35 25.9,-158.75\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M34.18,-113.75C40.63,-104.35 49.1,-92 56.39,-81.37\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"59.18,-83.48 61.95,-73.26 53.41,-79.53 59.18,-83.48\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M22.49,-110.94C22.01,-105.34 21.46,-98.96 20.92,-92.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"25.28,-92.31 20.07,-82.72 16.56,-93.05 25.28,-92.31\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72.24,-75.99C72.58,-100.03 73.2,-143.68 73.6,-172.41\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"70.1,-172.29 73.74,-182.24 77.1,-172.19 70.1,-172.29\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M118,-111.3C118,-98.23 118,-80.71 118,-69.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"121.5,-69.79 118,-59.79 114.5,-69.79 121.5,-69.79\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-38.69C18,-30.59 18,-21.28 18,-14.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.31 18,-4.31 14.5,-14.31 21.5,-14.31\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"74\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M74,-327.47C74,-324.87 74,-317.16 74,-308.41\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"78.38,-308.64 74,-298.64 69.63,-308.64 78.38,-308.64\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"20\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M20,-271.39C20,-266.39 20,-246.93 20,-229.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"23.5,-230.27 20,-220.27 16.5,-230.27 23.5,-230.27\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ccf7314f0>"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_cross.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_cross, edge_var=\"edge_value\", sample=0),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(\n",
    "        P_cross, G_cross, vertex_var=\"vertex_value\", sample=0\n",
    "    ),\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "cdad9033",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"74\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"74\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M74,-255.3C74,-247.67 74,-238.52 74,-230\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"77.5,-230.08 74,-220.08 70.5,-230.08 77.5,-230.08\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"24\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"24\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M63.88,-186.43C57.04,-176.85 47.85,-163.99 40.02,-153.03\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"42.98,-151.16 34.32,-145.05 37.29,-155.22 42.98,-151.16\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M83.33,-185.75C89.11,-176.57 96.65,-164.57 103.22,-154.11\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"106.12,-156.07 108.48,-145.74 100.2,-152.35 106.12,-156.07\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"20\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"20\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M21.01,-182.94C21.44,-175.42 21.95,-166.47 22.43,-158.12\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"25.91,-158.58 22.98,-148.39 18.92,-158.18 25.91,-158.58\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M33.95,-114.1C40.38,-104.71 48.9,-92.29 56.24,-81.58\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"59.08,-83.62 61.85,-73.4 53.31,-79.67 59.08,-83.62\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M22.52,-111.3C21.86,-103.67 21.08,-94.52 20.35,-86\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"23.84,-85.75 19.5,-76.08 16.87,-86.34 23.84,-85.75\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72.24,-75.71C72.58,-99.84 73.2,-144.14 73.61,-172.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"70.11,-172.86 73.75,-182.81 77.11,-172.76 70.11,-172.86\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M118,-111.3C118,-98.23 118,-80.71 118,-69.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"121.5,-69.79 118,-59.79 114.5,-69.79 121.5,-69.79\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-39.28C18,-31.05 18,-21.43 18,-14.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.34 18,-4.34 14.5,-14.34 21.5,-14.34\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"74\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M74,-327.47C74,-324.24 74,-313.15 74,-301.95\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"77.5,-302.24 74,-292.24 70.5,-302.24 77.5,-302.24\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"20\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M20,-271.39C20,-267.01 20,-251.53 20,-236.36\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"24.38,-236.8 20,-226.8 15.63,-236.8 24.38,-236.8\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ccf731610>"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_cross.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_cross, edge_var=\"edge_value\", sample=1),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(\n",
    "        P_cross, G_cross, vertex_var=\"vertex_value\", sample=1\n",
    "    ),\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9b6efa3a",
   "metadata": {},
   "source": [
    "## CARNIVAL with Acyclic signaling"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "91f5442d",
   "metadata": {},
   "source": [
    "`runCARNIVAL_Flow_Acyclic_Signal` applies the acyclic constraints on the signaling rather than on the flow. Thus, we can find a solution where the flow is not DAG, but the signaling is. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "c0e801a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "from corneto.methods import runCARNIVAL_Flow_Acyclic_Signal\n",
    "\n",
    "P_cross = runCARNIVAL_Flow_Acyclic_Signal(G_cross, exp_list_cross, solver=\"GUROBI\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "8cbecf44",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"74\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"74\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M74,-254.94C74,-249.34 74,-242.96 74,-236.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"78.38,-236.74 74,-226.74 69.63,-236.74 78.38,-236.74\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"24\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"24\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M63.64,-186.1C57.87,-178.02 50.5,-167.71 43.69,-158.16\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"47.34,-155.76 37.97,-150.16 40.22,-160.84 47.34,-155.76\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M83.55,-185.41C89.33,-176.21 96.83,-164.27 103.36,-153.89\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"106.21,-155.93 108.57,-145.6 100.29,-152.2 106.21,-155.93\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"20\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"20\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M20.99,-183.3C21.42,-175.78 21.93,-166.79 22.41,-158.38\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"25.9,-158.75 22.97,-148.57 18.91,-158.35 25.9,-158.75\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M34.18,-113.75C40.63,-104.35 49.1,-92 56.39,-81.37\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"59.18,-83.48 61.95,-73.26 53.41,-79.53 59.18,-83.48\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M22.49,-110.94C22.01,-105.34 21.46,-98.96 20.92,-92.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"25.28,-92.31 20.07,-82.72 16.56,-93.05 25.28,-92.31\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72.24,-75.99C72.58,-100.03 73.2,-143.68 73.6,-172.41\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"70.1,-172.29 73.74,-182.24 77.1,-172.19 70.1,-172.29\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M118,-111.3C118,-98.23 118,-80.71 118,-69.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"121.5,-69.79 118,-59.79 114.5,-69.79 121.5,-69.79\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-38.69C18,-30.59 18,-21.28 18,-14.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.31 18,-4.31 14.5,-14.31 21.5,-14.31\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"74\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M74,-327.47C74,-324.87 74,-317.16 74,-308.41\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"78.38,-308.64 74,-298.64 69.63,-308.64 78.38,-308.64\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"20\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M20,-271.39C20,-266.39 20,-246.93 20,-229.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"23.5,-230.27 20,-220.27 16.5,-230.27 23.5,-230.27\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9da0f490>"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_cross.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_cross, edge_var=\"edge_value\", sample=0),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(\n",
    "        P_cross, G_cross, vertex_var=\"vertex_value\", sample=0\n",
    "    ),\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "4f220079",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"74\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"74\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"74\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M74,-255.3C74,-247.78 74,-238.79 74,-230.38\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"77.5,-230.57 74,-220.57 70.5,-230.57 77.5,-230.57\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"24\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"24\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M63.64,-186.1C56.87,-176.62 47.89,-164.04 40.18,-153.26\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"43.23,-151.5 34.57,-145.39 37.53,-155.57 43.23,-151.5\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M83.55,-185.41C88.33,-177.8 94.29,-168.32 99.9,-159.4\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"103.53,-161.83 105.15,-151.04 96.13,-157.18 103.53,-161.83\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"20\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"20\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M21.01,-182.94C21.33,-177.34 21.69,-170.96 22.06,-164.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"26.42,-164.96 22.62,-154.73 17.68,-164.46 26.42,-164.96\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M34.18,-113.75C39.59,-105.87 46.42,-95.91 52.78,-86.63\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"56.26,-89.29 58.31,-78.57 49.04,-84.34 56.26,-89.29\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M22.49,-110.94C21.84,-103.42 21.07,-94.47 20.36,-86.12\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"23.87,-86.06 19.53,-76.39 16.89,-86.66 23.87,-86.06\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M72.25,-76.44C72.57,-98.99 73.12,-138.27 73.52,-166.62\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"69.14,-166.44 73.66,-176.38 77.89,-166.32 69.14,-166.44\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M118,-110.94C118,-97.87 118,-80.49 118,-69.42\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"121.5,-69.78 118,-59.78 114.5,-69.78 121.5,-69.78\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-39.28C18,-31.05 18,-21.43 18,-14.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.34 18,-4.34 14.5,-14.34 21.5,-14.34\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"74\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M74,-327.47C74,-324.24 74,-313.15 74,-301.95\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"77.5,-302.24 74,-292.24 70.5,-302.24 77.5,-302.24\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"20\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M20,-271.39C20,-267.01 20,-251.53 20,-236.36\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"24.38,-236.8 20,-226.8 15.63,-236.8 24.38,-236.8\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ccf681760>"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_cross.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_cross, edge_var=\"edge_value\", sample=1),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(\n",
    "        P_cross, G_cross, vertex_var=\"vertex_value\", sample=1\n",
    "    ),\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "46384728",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M66.2,-256.36C65.33,-248.59 65.06,-239.06 65.39,-230.2\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"68.87,-230.48 66.1,-220.26 61.89,-229.98 68.87,-230.48\"/>\n",
       "</g>\n",
       "<!-- A&#45;&gt;I1 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>A&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M77.79,-218.75C78.67,-226.51 78.94,-236.03 78.62,-244.9\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"75.13,-244.63 77.91,-254.85 82.11,-245.13 75.13,-244.63\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"26\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"26\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M58.98,-188.73C51.94,-180.09 43.58,-168.07 36.9,-157.19\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"39.93,-155.44 31.87,-148.57 33.89,-158.97 39.93,-155.44\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M81.53,-186.1C87.51,-176.99 95.37,-165.03 102.26,-154.55\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"105.08,-156.63 107.65,-146.35 99.23,-152.79 105.08,-156.63\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M19.98,-183.3C20.81,-176.01 21.8,-167.33 22.74,-159.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"26.22,-159.54 23.87,-149.21 19.26,-158.75 26.22,-159.54\"/>\n",
       "</g>\n",
       "<!-- B&#45;&gt;A -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>B&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M39.02,-142.47C46.07,-151.12 54.45,-163.18 61.14,-174.07\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"58.11,-175.83 66.18,-182.7 64.16,-172.3 58.11,-175.83\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M35.53,-114.1C41.51,-104.99 49.37,-93.03 56.26,-82.55\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"59.08,-84.63 61.65,-74.35 53.23,-80.79 59.08,-84.63\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M24.02,-111.3C23.19,-104.01 22.2,-95.33 21.26,-87.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"24.74,-86.75 20.13,-77.21 17.78,-87.54 24.74,-86.75\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-75.71C72,-99.52 72,-142.97 72,-171.82\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"68.5,-171.67 72,-181.67 75.5,-171.67 68.5,-171.67\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M118,-111.3C118,-98.68 118,-81.89 118,-70.69\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"121.5,-70.92 118,-60.92 114.5,-70.92 121.5,-70.92\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-39.28C18,-31.47 18,-22.41 18,-15.28\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-15.47 18,-5.47 14.5,-15.47 21.5,-15.47\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M72,-327.47C72,-324.37 72,-314.04 72,-303.32\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"75.5,-303.37 72,-293.37 68.5,-303.37 75.5,-303.37\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M18,-271.39C18,-266.49 18,-247.66 18,-230.94\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"21.5,-231.41 18,-221.41 14.5,-231.41 21.5,-231.41\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25ccf681610>"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_cross2 = G_cross.copy()\n",
    "G_cross2.add_edge(\"B\", \"A\", interaction=1)\n",
    "G_cross2.add_edge(\"A\", \"I1\", interaction=1)\n",
    "\n",
    "G_cross2.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "920555f5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M66.12,-255.65C65.47,-249.55 65.19,-242.44 65.26,-235.44\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"69.62,-235.84 65.8,-225.62 60.88,-235.36 69.62,-235.84\"/>\n",
       "</g>\n",
       "<!-- A&#45;&gt;I1 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>A&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M77.86,-219.39C78.7,-227.19 78.94,-236.67 78.6,-245.45\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.12,-245.06 77.9,-255.28 82.1,-245.55 75.12,-245.06\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"26\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"26\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M58.72,-188.41C52.64,-180.92 45.61,-170.95 39.54,-161.42\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"43.39,-159.33 34.51,-152.99 35.88,-163.82 43.39,-159.33\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M81.76,-185.75C87.94,-176.35 96.05,-164 103.04,-153.37\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"105.8,-155.54 108.37,-145.26 99.95,-151.7 105.8,-155.54\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M19.98,-183.3C20.84,-175.78 21.86,-166.79 22.83,-158.38\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"26.29,-158.9 23.95,-148.57 19.33,-158.1 26.29,-158.9\"/>\n",
       "</g>\n",
       "<!-- B&#45;&gt;A -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>B&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M39.27,-142.78C46.44,-151.62 54.93,-163.89 61.62,-174.85\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"58.5,-176.45 66.55,-183.33 64.54,-172.93 58.5,-176.45\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M35.76,-113.75C41.94,-104.35 50.05,-92 57.04,-81.37\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"59.8,-83.54 62.37,-73.26 53.95,-79.7 59.8,-83.54\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M23.98,-110.94C23.32,-105.17 22.57,-98.57 21.82,-92.04\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"26.18,-91.65 20.7,-82.21 17.49,-92.64 26.18,-91.65\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-75.99C72,-100.03 72,-143.68 72,-172.41\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"68.5,-172.24 72,-182.24 75.5,-172.24 68.5,-172.24\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M118,-111.3C118,-98.23 118,-80.71 118,-69.53\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"121.5,-69.79 118,-59.79 114.5,-69.79 121.5,-69.79\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-38.69C18,-30.59 18,-21.28 18,-14.17\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.31 18,-4.31 14.5,-14.31 21.5,-14.31\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M72,-327.47C72,-324.87 72,-317.16 72,-308.41\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"76.38,-308.64 72,-298.64 67.63,-308.64 76.38,-308.64\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-271.39C18,-266.39 18,-246.93 18,-229.97\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-230.27 18,-220.27 14.5,-230.27 21.5,-230.27\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25cadb03880>"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "P_cross = runCARNIVAL_Flow_Acyclic_Signal(G_cross2, exp_list_cross, solver=\"GUROBI\")\n",
    "\n",
    "G_cross2.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_cross, edge_var=\"edge_value\", sample=0),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(\n",
    "        P_cross, G_cross, vertex_var=\"vertex_value\", sample=0\n",
    "    ),\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "a3a73196",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 10.0.1 (20240210.2158)\n",
       " -->\n",
       "<!-- Pages: 1 -->\n",
       "<svg width=\"144pt\" height=\"339pt\"\n",
       " viewBox=\"0.00 0.00 144.00 339.20\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 335.2)\">\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-335.2 140,-335.2 140,4 -4,4\"/>\n",
       "<!-- I1 -->\n",
       "<g id=\"node1\" class=\"node\">\n",
       "<title>I1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-273.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-268.18\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I1</text>\n",
       "</g>\n",
       "<!-- A -->\n",
       "<g id=\"node2\" class=\"node\">\n",
       "<title>A</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"72\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">A</text>\n",
       "</g>\n",
       "<!-- I1&#45;&gt;A -->\n",
       "<g id=\"edge1\" class=\"edge\">\n",
       "<title>I1&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M66.2,-256.36C65.3,-248.35 65.04,-238.48 65.42,-229.39\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"68.89,-229.84 66.13,-219.61 61.91,-229.33 68.89,-229.84\"/>\n",
       "</g>\n",
       "<!-- A&#45;&gt;I1 -->\n",
       "<g id=\"edge13\" class=\"edge\">\n",
       "<title>A&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M77.84,-219.23C78.72,-227.31 78.96,-237.2 78.56,-246.26\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.09,-245.75 77.83,-255.99 82.07,-246.28 75.09,-245.75\"/>\n",
       "</g>\n",
       "<!-- B -->\n",
       "<g id=\"node4\" class=\"node\">\n",
       "<title>B</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"26\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"26\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">B</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;B -->\n",
       "<g id=\"edge3\" class=\"edge\">\n",
       "<title>A&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M58.72,-188.41C51.57,-179.59 43.11,-167.36 36.43,-156.42\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"39.56,-154.84 31.5,-147.96 33.51,-158.36 39.56,-154.84\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\">\n",
       "<title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"118\" cy=\"-129.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"118\" y=\"-124.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- A&#45;&gt;O2 -->\n",
       "<g id=\"edge6\" class=\"edge\">\n",
       "<title>A&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M81.76,-185.75C86.88,-177.96 93.33,-168.14 99.37,-158.95\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"103,-161.4 104.83,-150.64 95.69,-156.59 103,-161.4\"/>\n",
       "</g>\n",
       "<!-- I2 -->\n",
       "<g id=\"node3\" class=\"node\">\n",
       "<title>I2</title>\n",
       "<ellipse fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"2\" cx=\"18\" cy=\"-201.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-196.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">I2</text>\n",
       "</g>\n",
       "<!-- I2&#45;&gt;B -->\n",
       "<g id=\"edge2\" class=\"edge\">\n",
       "<title>I2&#45;&gt;B</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M20.02,-182.94C20.68,-177.17 21.43,-170.57 22.18,-164.04\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"26.51,-164.64 23.3,-154.21 17.82,-163.65 26.51,-164.64\"/>\n",
       "</g>\n",
       "<!-- B&#45;&gt;A -->\n",
       "<g id=\"edge12\" class=\"edge\">\n",
       "<title>B&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M39.27,-142.78C45.37,-150.29 52.41,-160.28 58.5,-169.85\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"54.66,-171.96 63.54,-178.3 62.17,-167.47 54.66,-171.96\"/>\n",
       "</g>\n",
       "<!-- C -->\n",
       "<g id=\"node5\" class=\"node\">\n",
       "<title>C</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"72\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"72\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">C</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;C -->\n",
       "<g id=\"edge4\" class=\"edge\">\n",
       "<title>B&#45;&gt;C</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M35.76,-113.75C41.94,-104.35 50.05,-92 57.04,-81.37\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"59.8,-83.54 62.37,-73.26 53.95,-79.7 59.8,-83.54\"/>\n",
       "</g>\n",
       "<!-- O1 -->\n",
       "<g id=\"node7\" class=\"node\">\n",
       "<title>O1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"18\" cy=\"-57.6\" rx=\"18\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"18\" y=\"-52.17\" font-family=\"Times New Roman,serif\" font-size=\"14.00\">O1</text>\n",
       "</g>\n",
       "<!-- B&#45;&gt;O1 -->\n",
       "<g id=\"edge7\" class=\"edge\">\n",
       "<title>B&#45;&gt;O1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M23.98,-110.94C23.11,-103.3 22.07,-94.2 21.1,-85.74\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"24.59,-85.45 19.98,-75.91 17.64,-86.24 24.59,-85.45\"/>\n",
       "</g>\n",
       "<!-- C&#45;&gt;A -->\n",
       "<g id=\"edge5\" class=\"edge\">\n",
       "<title>C&#45;&gt;A</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-75.99C72,-100.03 72,-143.68 72,-172.41\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"68.5,-172.24 72,-182.24 75.5,-172.24 68.5,-172.24\"/>\n",
       "</g>\n",
       "<!-- e_8_target -->\n",
       "<g id=\"node9\" class=\"node\">\n",
       "<title>e_8_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"118\" cy=\"-57.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;e_8_target -->\n",
       "<g id=\"edge9\" class=\"edge\">\n",
       "<title>O2&#45;&gt;e_8_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M118,-110.94C118,-97.87 118,-80.49 118,-69.42\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"121.5,-69.78 118,-59.78 114.5,-69.78 121.5,-69.78\"/>\n",
       "</g>\n",
       "<!-- e_7_target -->\n",
       "<g id=\"node8\" class=\"node\">\n",
       "<title>e_7_target</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-1.8\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- O1&#45;&gt;e_7_target -->\n",
       "<g id=\"edge8\" class=\"edge\">\n",
       "<title>O1&#45;&gt;e_7_target</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M18,-39.28C18,-31.05 18,-21.43 18,-14.14\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"21.5,-14.34 18,-4.34 14.5,-14.34 21.5,-14.34\"/>\n",
       "</g>\n",
       "<!-- e_9_source -->\n",
       "<g id=\"node10\" class=\"node\">\n",
       "<title>e_9_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"72\" cy=\"-329.4\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_9_source&#45;&gt;I1 -->\n",
       "<g id=\"edge10\" class=\"edge\">\n",
       "<title>e_9_source&#45;&gt;I1</title>\n",
       "<path fill=\"none\" stroke=\"black\" stroke-width=\"0.25\" d=\"M72,-327.47C72,-324.24 72,-313.15 72,-301.95\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" stroke-width=\"0.25\" points=\"75.5,-302.24 72,-292.24 68.5,-302.24 75.5,-302.24\"/>\n",
       "</g>\n",
       "<!-- e_10_source -->\n",
       "<g id=\"node11\" class=\"node\">\n",
       "<title>e_10_source</title>\n",
       "<ellipse fill=\"black\" stroke=\"black\" cx=\"18\" cy=\"-273.6\" rx=\"1.8\" ry=\"1.8\"/>\n",
       "</g>\n",
       "<!-- e_10_source&#45;&gt;I2 -->\n",
       "<g id=\"edge11\" class=\"edge\">\n",
       "<title>e_10_source&#45;&gt;I2</title>\n",
       "<path fill=\"none\" stroke=\"#8b1a1a\" stroke-width=\"5\" d=\"M18,-271.39C18,-267.01 18,-251.53 18,-236.36\"/>\n",
       "<polygon fill=\"#8b1a1a\" stroke=\"#8b1a1a\" stroke-width=\"5\" points=\"22.38,-236.8 18,-226.8 13.63,-236.8 22.38,-236.8\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.graphs.Digraph at 0x25c9da01730>"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "G_cross2.plot(\n",
    "    custom_edge_attr=cn.pl.edge_style(P_cross, edge_var=\"edge_value\", sample=1),\n",
    "    custom_vertex_attr=cn.pl.vertex_style(\n",
    "        P_cross, G_cross, vertex_var=\"vertex_value\", sample=1\n",
    "    ),\n",
    ")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
